[
    {
        "type": "text",
        "text": "基于BIM的家装设计软件的算法设计及功能实现",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "舒志强 刘辰董建峰（建研科技股份有限公司，北京100013）",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "【摘要】家装设计行业是我国建筑领域的重要组成部分。本文的研究工作是基于家装设计行业,建立了一套基于BIM的家装设计软件系统。文章对软件系统的主要功能实现进行了介绍,之后针对几项主要功能实现的算法设计思路进行了详尽的分析。文章还给出了软件的操作界面截图,对软件的功能实现效果进行了说明。该软件的创新性应用能够为家装设计师和客户双方带来家装设计的新体验，并将推动整个家装产业新模式的发展。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "【关键词】BIM；家装设计；算法；功能实现【中图分类号】TU17；TU238；TU204.2 【文献标识码】A【DOI】10.16670/j.cnki.cn11-5823/tu.2017.04.09",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "【文章编号】1674-7461(2017)04-0046-06",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "引言",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "家装设计行业位于建筑业整体链条的末端，起到进一步完善、美化建筑物,并提高建筑质量和功能的作用。近年来，随着房地产行业的快速发展，以及居民住房水平的不断提升，家装行业也已经进入到一个高速发展的阶段。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "一如今,在改善家居生活环境的同时，人们对家居的装饰装修提出了更高的要求，追求彰显个性、简洁大方、节能环保等不同的装修风格，这对传统的家装模式提出了挑战。传统模式下，家装设计工具并未实现平、立、剖面图和三维模型之间的联动，加之家装行业全链条工作量大，预算不透明、工期拖延、报价不明确。这些问题阻止了家装行业进一步向高效、透明、优质的服务发展。在\"互联网 $^ +$ ；的大背景下，模式决定未来；家装行业需要做出相应地改变，向着一体化、系统化、规模化、信息化的方向发展，来满足市场的需要。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "在本文的研究中，我们将BIM技术引入到家装设计服务中，建立了基于BIM的家装设计软件，利用建筑信息模型的优势，解决上述提到的传统家装设计模式中存在的问题和痛点，建立家装设计服务的新模式。通过所见即所得、标准化设计、一键获取算量清单等方式，改变设计师的设计模式,使客户获得更好的设计体验，为设计公司带来更大的利益。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "2主要功能实现",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "本论文的研究工作，旨在将BIM技术引入到家装设计服务中来：将BIM作为设计服务的数据载体，实现基于BIM技术的三维装饰设计软件系统，从而为家装行业提供的服务模式。本三维家装设计软件实现的主要功能包括：软装设计和硬装设计。其中，硬装设计功能主要包含了：墙体及房间户型绘制、水电设计、踢脚线设计、吊顶设计、壁纸或墙面漆设计、橱柜设计、衣柜设计、磁砖设计、地板设计等内容；而软装设计功能主要包括：沙发、窗帘、餐(书)桌、电视柜、床、灯饰、淋浴、卫生洁具产品部署设计等。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "为了实现以上这些功能，软件工具应能够实现建模画图、产品组合及二维-三维视图切换三大类别的功能。其中，建模画图主要是通过可视化的方式实现任意图形图案的拼接裁剪，如户型设计、水电设计、踢脚线设计、吊顶设计、磁砖(地板)铺贴、乳胶漆材质铺贴等；产品组合主要是指将产品库的基础模型导入设计平台，坐标系统中完成模型的拖、放、组合，在三维空间内自由布置产品模型，包括家电、沙发、餐桌、床、书柜、橱柜、衣柜、灯饰等;二维-三维视图切换则主要是要通过所见即所得方式，实现二维、三维两种视窗之间的实时切换和互动。",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "以上所谈论到的，主要是BIM家装软件在家装三维设计中能够实现的功能需求。基于上述设计内容，该软件还能够完成设计方案的精准算量。要实现这项功能，在解决方案上需要在软件设计上引入两点架构上的要求：一，提供标准化的企业清单定额、材料库、产品库、工料机库等基础信息库，将信息库数据与设计软件进行数据集成,实现设计过程中的产品基础量的信息与基础库的相关联；二，对设计方案中所有产品清单及定制用量进行精确统计",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "3软件算法设计",
        "text_level": 1,
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "2本节内容，我们将针对上文中所提到的三大类别的功能：建模画图、产品组合、二维－三维视图切换，分别展开阐释功能实现的编程思路。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "3.1 建模画图",
        "text_level": 1,
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "建模画图主要通过可视化的方式实现任意图形图案的拼接裁剪，如户型设计、水电设计、踢脚线设计、吊顶设计、磁砖(地板)铺贴、乳胶漆等。此功能进一步可以支持剖切，实现对设计出施工图及样图提供技术基础。此功能为家装设计软件的核心部分，其核心算法主要包括：墙体绘制组合并生成相应的户型功能区域；水电设计中自动管道编排、踢脚线生成等。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "(1)墙体绘制组合并生成相应的户型功能区域",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "墙体的创建/绘制/修改等操作属于PlanCon-troller(面板逻辑控制)类别。要完成这些操作，需要调用Wall. java中的 getPoints,通过 getShapePoints方法计算获取墙四个顶点的坐标；在获得墙体的四个矩形定点的坐标后，再确定其厚度。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "如果墙体之间相交，则需要获取其他墙的方形顶点，通过使用computeIntersection的方法，来修改目前墙体的顶点坐标。而当相交墙体的pointsCache存在时，如果当前墙经过计算后的某点和相交墙体pointsCache的某点误差极小，那他们共用这个点以避免计算错误。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "最后，通过PlanController中的绘制墙的方法形成墙的轮廓，即可产生斜面。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "(2)水电设计中自动管道编排",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "从算法实现角度，水电设计中自动管道编排主要包含两个部分的内容：一个是基于参数化建模的管道自动生成；二是管道基于路由规则的路由寻径。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "基于参数化建模的管道生成，即是指给定管道的起点和终点，在二维平面图中用线段画出两点之间联通的管道路径，在三维空间中用圆柱表示。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "二维线段可以使用Polyline 画出。Polyline 在给定位置坐标的情况下，就能够完成折线和弧线的绘制。而三维圆柱型的绘制和修改则是通过Polyline3D.java画出来的；Polyline3D.java下面的代码控制圆柱的位置和方向，vector是圆柱的开始位置，vector2是圆柱的方向。另外，在Object3DBranchFactory中增加类别判定。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "而管道基于路由规则的路由寻径功能，也包含了两个算法：一是主路由生成，二是自动生成指定两点的地面自动布线。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "主路由生成算法主要分为四个步骤。首先，要找到管道主路由与房间边缘仅有的两个交点。然后，找出从电位到主路由(两点都要考虑)的最短路径，生成沿房间边缘的内部轮廓线。之后，删除最后的第N个点（N从1开始取值)，并增加一个点，该点由主路由的方向和第 $\\mathrm { \\Delta N } + 1$ 个点(从后往前)的位置确定；判断这条轮廓线是否完全在房间内，如果是，记录这条轮廓线。循环这一步，直至最后一个点。最后，计算所有轮廓线的长度，取最短的作为路径。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "指定两点的地面自动布线的算法思路为：首先清空已经绘制的auto3D为真的所有Polyline，针对房间边缘上的两个点，首先找到垂直于房间边缘的内部点，并连接成Polyline（createStartLine/crea-teEndLine）；然后根据两个边缘上的点，沿外部轮廓寻找最短路径，并记录经过的点（createShortest-Path)；根据最短路径和行业规则，计算中间点并连接（createMiddleLine）。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "(3)踢脚线生成",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "自动生成踢脚线的算法思路为：针对指定的房间，在给定踢脚线的截面顶点坐标之后，沿房间边缘生成踢脚线。门的位置不绘制踢脚线。",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "对于没有门的房间，可以从房间的任意顶点开始，根据房间的边缘顶点之间的角度，旋转踢脚线的点到交点的角度，并将其移动到相邻的房间顶点上；循环该过程，直到房间所有的顶点都被遍历完成。这时，连接这些点，形成的回路即为踢脚线对应的形状，可添加至三维面板。而如果房间有门，那么则需要从前一个门与房间的后交点开始，直到后一个门与房间的前交点结束，生成一个非闭合的路径。起点处的踢脚线起点应旋转到与该条房间的边垂直，终点同理。中间的点与上面一种情况类似。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "3.2产品组合",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": ">产品组合功能,主要是将基础模型导入至设计平台中,该功能本身的算法比较简单,在此不再展开赘述。本节内容,我们将主要讨论，在产品导入写 ，如何利用清单计价方法进行产品的算量统巴计。对于家装业，主要需要关注的产品主要分为：门窗和其他家具。在对每个房间的产品进行统计之后，给出每种产品的数量和总价。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "其中,其他家具产品只会与一个房间产生交集，属于该房间。而窗户可能会与相邻的两个房间均产生交集,需要随机指定所属的某一个房间。同样，门也可能会与相邻的两个房间均产生交集，这里我们在统计时，认为门所属的房间是门进入的房间；换句话说,如果房间只有一个门,则它就是进入该房间的门，而对于与该门产生交集的其他房间，该门不是进入该房间的门,依此类推。这样,门-房间的关系则会形成一个列表，如表1所示。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "这样，利用遍历算法，首先将初始状态下外部的门（仅对应一个房间的门）单独加入Product",
        "page_idx": 2
    },
    {
        "type": "table",
        "img_path": "images/d0f7247f62ad449e1cf5ee53a20dc92a02c5a51c2ca3c3accad2c84bbc4c5f7e.jpg",
        "table_caption": [
            "表1门-房间关系列表(DoorRoomList)"
        ],
        "table_footnote": [],
        "table_body": "<html><body><table><tr><td>Doorl</td><td>Room1</td><td></td></tr><tr><td>Door2</td><td>Room1</td><td>Room2</td></tr><tr><td>Door3</td><td>Room1</td><td>Room3</td></tr><tr><td>Door4</td><td>Room2</td><td>Room4</td></tr><tr><td></td><td></td><td></td></tr></table></body></html>",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "HomeList；然后删除该对应房间，再次利用遍历算法找出外部的门加入ProductHomeList，直到表格中所有门只对应一个房间，结束循环。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "3.3二维-三维视图切换",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "二维－三维视图切换则主要是要通过所见即所得方式，实现二维、三维两种视窗之间的实时切换和互动。其主要实现思路可以参考绘制墙体时，通过在二维面板修改对应的材质，实现对应的三维视窗中材质的联动变化。其实现算法思路如下：",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "HomgComponent3D. java 的 createHomeTree 方法中加入了楼层(level）、墙（wall）家具（furniture）、房间（room）、环境（environment）监听器，当二维平面的对应元素变化时，通过监听使得3D中的元素也变化。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "4功能实现效果",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "按照以上的编程设计思路，我们建立了一套基于BIM技术的三维装饰设计软件系统，成功地实现了最初预计的软件系统功能。本节内容将对该软件的功能实现效果进行展示。",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "软件可以对房屋的内部结构进行二维和三维的展示。最开始进入时,软件所显示的界面即为平面图展示界面（图1），可以在此界面查看和绘制平面图。在平面图界面上，点击[三维界面]选项，即可将平面展示转为3D模型展示（图2）。在三维展示界面下，我们还可以选择[鸟瞰]或[漫游]等等不同模式，从不同的角度对三维模型进行查看。",
        "page_idx": 2
    },
    {
        "type": "image",
        "img_path": "images/b257355f73a4a3d544ce2a9e4e22a70774b7df1e12a010eb2f0dbecf305b1f24.jpg",
        "img_caption": [
            "图1平面图展示界面"
        ],
        "img_footnote": [],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "如图3所示为绘制墙体的界面，点击[绘制户型]中的[墙体」选项，即可绘制墙体，墙体位置也可以通过“上下左右\"方向键或者通过鼠标拖拽进行移动。",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "在水电设计界面中（见图4），点击[显示」或[隐藏」，就可以把所有的开关面板显示出来或隐藏起来。在确定相应的点位后，点击「初始化」，即可在界面右上角3D视图上看到相应的初始线路（见图5）。需要指出的是，所有线路均是由地面通过;根据需要，也可将线路设为走房屋顶部。只要点选某个节点，选择顶部，即可将对应的线路改为走房屋顶部。",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 3
    },
    {
        "type": "image",
        "img_path": "images/9f44bf2fe213698c89611c30e4ae842a216b6eb912556901bf3f1cefc0adbb13.jpg",
        "img_caption": [
            "图2三维展示界面"
        ],
        "img_footnote": [],
        "page_idx": 3
    },
    {
        "type": "image",
        "img_path": "images/8e59ace3406efafad6af052cdf9cd499b5b9ce72f53f7753fbb4617c425fbde2.jpg",
        "img_caption": [
            "图3墙体绘制界面"
        ],
        "img_footnote": [],
        "page_idx": 3
    },
    {
        "type": "image",
        "img_path": "images/541bf0929bf5f2feaf1ca722941b74cae9ebf150d694f2e1cfb5f855286357ad.jpg",
        "img_caption": [
            "图4水电设计点位界面"
        ],
        "img_footnote": [],
        "page_idx": 3
    },
    {
        "type": "image",
        "img_path": "images/83ab13f11ffb4ba61078adb7e530f55a2c3690eb87fd93f2f87994922fab3ea2.jpg",
        "img_caption": [
            "图5水电设计线路界面"
        ],
        "img_footnote": [],
        "page_idx": 4
    },
    {
        "type": "image",
        "img_path": "images/147938f5214bd38491f76d8cd55063e50e6336dcb36e3380a3db8f62c4124128.jpg",
        "img_caption": [
            "图6踢脚线设计界面"
        ],
        "img_footnote": [],
        "page_idx": 4
    },
    {
        "type": "image",
        "img_path": "images/e98684dd03eec50c9f01844eeeb1049de74e99019851eb47fd549edcecf3d18e.jpg",
        "img_caption": [
            "图7装修清单界面"
        ],
        "img_footnote": [],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "图6所示为踢脚线设计的界面。选择踢脚线的样式以及材质，之后按住左键将其拖拽至某个房间的地板处，即自动完成踢脚线的初步布置。",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "当所有家具都添加完成后，即可点击[装修清单」选项，自动生成装修清单（图7）。在生成清单之后，点击[提交]按钮，即可将清单数据提交至后台服务器当中，加以保存。",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "5总结与展望 ",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "本文主要介绍了基于BIM技术的三维装饰设计软件系统，对系统的主要功能实现和算法设计思路进行了阐述，同时对部分软件的功能效果进行了展示。目前，该款软件已经完成了研发阶段，与家装行业内的几家公司已经建立了合作关系，在实际应用中接受市场的检验；通过此过程,我们也在对该软件进行不断地升级和完善。",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "该软件将 BIM技术应用于家装设计之中，探索出一条基于BIM技术的家装设计信息化新道路。软件实现了设计标准化、平台化、所见即所得的家装设计模式，为设计师的设计模式、家装客户的体验模式、设计企业的管理模式均带来了巨大的变化。该软件的应用，将极大地推动家装市场的O20线上线下设计服务新模式的发展，一方面通过设计可视化拉动产品的销售，另一方面有利于再造构成家装一体化的专业产业链，为家装企业的纵向多元化提供良好支撑。",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "参考文献",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "[1] $2 0 1 5 \\sim 2 0 2 0$ 年中国建筑装饰行业市场分析与发展趋势研究报告［EB/OL]：中国产业研究报告网.http：//www.chinairn.com/report/20160614/150322240.html,2015(9).  \n[2］傅萱，周建亮，冯娴凯,等.BIM技术在家装工程中的应用与管理模式［J].工程管理学报，2016（1）：131-135.  \n［3］王淑鹏，董建峰，李昊翔，等.基于BIM的家装设计发展研究［J].土木建筑工程信息技术，2016，8（6）：64-67.  \n［4］张建奇，舒志强，李智.基于BIM技术的家装设计系统设计与实施[J].土木建筑工程信息技术，2016，8(6):73-78.",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Algorithm Design and Function Realization of BIM-based Home Improvement Design Software ",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Shu Zhiqiang，Liu Chen，Dong Jianfeng (CABR Technology Co.，Ltd.，Beijing 100013，China) ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Abstract：Home improvement design industry is an important piece in domestic construction field in China. Through the research work of this paper，we have established a BIM-based home improvement design software for the home decoration design industry.The paper briefly introduces the main functions of the software system，and then describes in details the algorithm design ideas of several main functions.Some screenshots of thesoftware operation interfacearealso shown in the paper to ilustratethe functionand efectoffunction realizationinsoftware implementation.The innovativeapplicationof the software willprovide both the home improvement designers and the customers with brand new experience in home improvement，and promote the development of new patern on the home decoration industry. ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Key Words:BIM；Home Decoration Design；Algorithm；Function Realization ",
        "page_idx": 5
    }
]