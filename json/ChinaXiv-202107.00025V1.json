[
    {
        "type": "text",
        "text": "Adaptability of machine learning methodsand hydrological models to discharge simulations in datasparse glaciated watersheds ",
        "text_level": 1,
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "JI Huiping1,2, CHEN Yaning1,2\\*, FANG Gonghuan1,2, LI Zhi1,2, DUAN Weili1,2, ZHANG Qifei1,2 ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "1StateKeyLaboratoryofDesertandOasisEcologyXinjiang InstituteofEcologyandGeography,ChineseAcademyofSciences, Urumqi 830011, China;   \n2 University of Chinese Academy of Sciences,Beijing 100049,China ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Abstract: The accurate simulation and prediction of runofin alpine glaciated watersheds is of increasing importance for the comprehensive management and utilization of water resources.In this study, long shortterm memory (LSTM),a state-of-the-art artificial neural network algorithm,is applied to simulate the daily discharge of two data-sparse glaciated watersheds in the Tianshan Mountains in Central Asia. Two other classic machine learning methods,namely extreme gradient boosting (XGBoost) and support vector regression (SVR),along with a distributed hydrological model (Soil and Water Assessment Tool (SWAT) and an extended SWAT model (SWAT_Glacier) are also employed for comparison. This paper aims to provide an eficient and reliable method for simulating discharge in glaciated alpine regions that have insufficient observed meteorological data.The two typical basins in this study are the main tributaries (the Kumaric and Toxkan rivers) of the Aksu River in the south Tianshan Mountains, which are dominated by snow and glacier meltwater and precipitation. Our comparative analysis indicates that simulations from the LSTM shows the best agreement with the observations.The performance metrics Nash-Sutclife efficiency coeficient (NS)and correlation coeficient (R2) of LSTMare higher than 0.90 in both the training and testing periods in the Kumaric River Basin,and NS and R² are also higher than O.7O in the Toxkan River Basin. Compared to clasic machine learning algorithms, LSTM shows significant advantages over most evaluating indices. XGBoost also has high NS value in the training period,but is prone to overfiting the discharge. Compared with the widely used hydrological models,LSTM has advantages in predicting accuracy, despite having fewer data inputs. Moreover,LSTM only requires meteorological data rather than physical characteristics of underlying data. As an extension of SWAT,the SWAT_Glacier model shows good adaptability in discharge simulation,outperforming the original SWAT model, but at the cost of increasing the complexity of the model. Compared with the oftentimes complex semi-distributed physical hydrological models,the LSTM method not only eliminates the tedious calibration process of hydrological parameters, but also significantly reduces the calculation time and costs. Overall,LSTM shows immense promise in dealing with scarce meteorological data in glaciated catchments. ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Keywords: hydrological simulation; long short-term memory; extreme gradient boosting; support vector regression; SWAT_Glacier model; Tianshan Mountains ",
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "1Introduction ",
        "text_level": 1,
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "The Tianshan Mountains are considered as the \"water tower of Central Asia\". The mountains serve as the source for numerous rivers in the five Central Asian countries and Northwest China, providing freshwater for hundreds of millions of people in the lower reaches of the rivers. In so doing, the Tianshan Mountains ensure food security, economic development, water consumption, and ecological water utilization for the entire region, while simultaneously playing an important role as an ecological barrier (Chen et al.,2016; Immerzeel et al.,202O; Viviroli et al., 2020). However, with the hard-to-reach terrain and harsh weather conditions,the availability of observed data is scarce in the Central Asian alpine areas. Hydrological simulation is thus immensely challenging but critically important under increasingly worsening global warming conditions (Immerzeel et al., 2010; Duethmann et al., 2016; Viviroli et al., 2020). ",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Hydrologists have commited to developing various hydrological simulation approaches, including applying traditional statistical methods based on mathematics or a variety of hydrological models for dynamic simulation (Chen et al.,2006; Finger et al.,2015; Shen et al.,2018a; Greve et al.,2020). Statistical methods are widely used to describe the static state of a natural system, while hydrological modeling is a dynamic description of complex hydrological processes (Chen et al., 2017; Shen et al., 2O18b). Over the past several decades,hydrological modeling has experienced a long development process and is now broadly applied-used to explain various hydrological processes,along with future flood and runoff predictions (Tarasova et al.,2O16; Jodar et al., 2018). Duethmann et al. (2O15) investigated variations in runoff at the Sari-Djaz watershed by applying the Water Availability in Semi-Arid Environments (WASA） model; they attributed most of the increase in runoffto a surge in glacier melt. Chen et al. (2Ol7) reviewed the status of hydrological modeling in glaciated catchments and discussed the limitations of the available models. Previous studies found that the performance of hydrological models is closely related to the spatial and temporal resolution of model-driven data.The quality of the meteorological inputs plays a leading role, such that even minor data errors or noise interference may lead to large deviations (Michaud and Sorooshian, 1994; Ajami et al., 2004). In this regard, the scarce and unevenly-distributed meteorological stations in the Tianshan Mountains makes it challenging to simulate runoff in the alpine watershed dominated by glacier and snow meltwater and precipitation (Qin et al., 2009; Chen et al., 20l7). Therefore,it is difficult to improve the precision of discharge simulations solely through the use of hydrological models. ",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "With the rapid development of artificial intelligence, researchers are exploring machine learning methods for discharge simulation (Maier et al.,2010; Fang et al.,2017; Shen et al.,2018; Fang and Shen,2019; Yang et al.,2019). Compared with physical hydrological modeling, data-driven models ignore the physical logic relationship between variables and pay more attention to the potential relationship of the extremely large data sample for training in order to improve the prediction accuracy (Reichstein et al., 2019; Rudin, 2019). Artificial neural networks (ANNs), which were first developed by Hsu et al. (1995), provide significant advantages in hydrological simulations. Long short-term memory (LSTM), which is a machine learning algorithm for time series modeling, has also recently emerged as a powerful tool for capturing variations in discharge (Shen, 2018; Feng et al.,2020; Fu et al.,2020; Hu et al.,2020; Li et al.,2021). Hu et al. (2018) discovered that the performance of LSTM is significantly beter than that of the artificial neural network (ANN) model for flood predictions in the Fenhe River Basin, China. Gao et al. (202O) used LSTM to perform flood predictions for the Shaxi River Basin in China, finding that LSTM has a high prediction accuracy at different time steps. Xiang et al. (2020) developed a LSTM sequence-tosequence model to estimate hourly rainfall-runoff in two midwestern watersheds in Iowa,USA. Meanwhile, Kratzert et al. (2O20) used different precipitation products as inputs to the LSTM model to improve discharge simulations,revealing that the model is able to extract information from the characteristics of watersheds so as to distinguish rainfall-runoff in different watersheds; they further applied this concept to runoff predictions in unmeasured watersheds. These results showed that LSTM has unprecedented accuracy in discharge simulations and predictions in ungauged basins (Kratzert et al., 2018,2019a, b). ",
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "In this paper, we explore the capability of LSTM in simulating discharge in the data-scarce Kumaric and Toxkan rivers of the Aksu River Basin in the Tianshan Mountains,and compare it with the distributed hydrological models and machine learning methods,i.e., extreme gradient boosting (XGBoost) and support vector regression (SVR). The aim is to compare the results of the three machine learning methods (LSTM, XGBoost, and SVR) with the classical semi-distributed hydrological models (Soil and Water Assessment Tool (SWAT) and SWAT_Glacier (an extended SWAT model with glacier melting mechanism)） to determine an efficient method for discharge forecasting in glaciated alpine catchments with complex hydrological mechanisms. ",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "2Study area and data sources ",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "2.1 Study area ",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "The Aksu River originates in the south Tianshan Mountains and provides more than $70 \\%$ of the water for the mainstream of the Tarim River (Fan et al.,2O14).The Aksu River Basin is not only responsible for providing living and irrigation water, but also for the maintenance of the \"green corridor\" in the lower reaches of the Tarim River. The total area of the Aksu River Basin is $6 . 3 \\bar { 0 } \\times 1 0 ^ { 4 }$ $\\mathrm { k m } ^ { 2 }$ , and the plain area covers $2 . 9 0 \\times 1 0 ^ { 4 } ~ \\mathrm { k m } ^ { 2 }$ . Recent data indicate that there are 2740 glaciers of various sizes in the alpine regions, covering an area of $0 . 4 9 \\times 1 0 ^ { 4 } ~ \\mathrm { k m } ^ { 2 }$ . The Kumaric and Toxkan rivers converge in Wensu County to form the Aksu River, giving the river a total length of $2 2 4 \\mathrm { k m }$ The Kumaric River Basin with the outlet hydrological station of Xiehela, has an area of $1 . 2 9 \\times 1 0 ^ { 4 }$ $\\mathrm { k m } ^ { 2 }$ and ranges in altitude from 1435 to $7 1 2 6 \\mathrm { ~ m ~ }$ . There are three meteorological stations in the watershed, namely Aksu,Koilu,and Tianshan.The hydrological station for the Toxkan River Basin is called Shaliguilanke,and the two meteorological stations near the river are Akqi and Tuergate, as shown in Figure 1. ",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "75°30'E76°00E76°30E77°00E77°30'E78°00E78°30'E79°00'E79°30'E80°00'E 80°30'E   \n44000 KumaricRiverBasin 421043000 TianshanMountains   \n2001001000004000440000040000 Koilu Hantengri ToxkanRiverBasin TomurP Tianshan Kumaric River Xiehela 3414441014040100 Akqi Shaliguilanke Aksu 占 Toxkan River Tuergate LGndcier Meteorological station Elevation (m) 0 500 1000km Rtudy catchment Modrologicalstation Liwh: 7126 100.00 75°30'E7600'E 76°30'E7700'E 7730'E78°00'E7830E 79°00E 7930E80°00E 80°30'E ",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "2.2 Datasets ",
        "text_level": 1,
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "Daily meteorological data include maximum temperature $( ^ { \\circ } \\mathrm { C } )$ ，minimum temperature $( ^ { \\circ } \\mathrm { C } )$ precipitation $( \\mathrm { m m } )$ ，solar radiation $( \\mathrm { K J } / ( \\mathrm { m } ^ { 2 } { \\cdot } \\mathrm { d } )$ ，average wind speed $\\mathrm { ( m / s ) }$ ，and relative humidity $( \\% )$ . The data of meteorological stations which located in China are from the National Meteorological Information Center (http://data.cma.cn/), while the data of the Koilu and Tianshan stations are interpolated on the basis of two datasets: APHRODITE (Asian Precipitation Highly Resolved Observational Data Integration Towards the Evaluation of Water Resources)and CRU (Climatic Research Unit).Allthe meteorological data are from 2002 to 2011. Compared to various meteorological datasets with different time scales synthesized by a variety of spatial interpolation or assimilation methods,the measured data from meteorological observation stations are considered the most reliable, especially in the complex terrain of the Tianshan Mountains.For this reason, the data obtained from observation stations in the basins under study are selected as driving data for the machine learning methods and hydrological models. ",
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "The observed discharge data from 2002 to 2011 at two of the hydrological stations were obtained from the Tarim River Basin Management Bureau of Xinjiang Uygur Autonomous Region, China. Along with meteorological data, the spatial data, including digital elevation model (DEM) data, land use,soil data,and glacier and snow distribution data as described in Ji et al. (2O19),are used as inputs in the two hydrological models. ",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "3 Methodology ",
        "text_level": 1,
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "3.1Long short-term memory (LSTM) ",
        "text_level": 1,
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "The LSTM model is an optimization improvement developed by Hochreiter and Schmidhuber (1997),based on a traditional recurrent neural network (RNN). The application of RNN was previously limited in long-time series data by its finite memory ability. When the error \"backward propagates\" from the last timestamp to the beginning timestamp,the gradient decays or grows exponentially. Moreover, if the time series of the training data is too long, the propagated errors from the last timestamp either reduce to O or expand to NaN when they arrive at the beginning timestamp. Also, the model cannot converge, which leads to training failure (Greff et al., 2017). The discharge under study shows seasonal variations within a year and also has a lag effect of several days in response to precipitation. This represents a significant challenge or even an impossibility for RNN,which has only ten days of very short memory ability to simulate discharge (Bengio et al.， 1994). LSTM, as a representative deep learning model, effectively solves the problem of RNN being unable to remember long-time series. ",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Compared with standard RNN,a self-evaluation mechanism is a unique feature of LSTM. By weighing and comparing its own value and the importance of the information in memory,it chooses to discard unimportant information, which is controlled by the added gates in each cell.The internal structure of each cellis relatively complex and includes the input gate, forget gate,cell state, and output gate,as shown in Figure 2. ",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "3.1.1Forget gate layer ",
        "text_level": 1,
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "The forget gate plays a very important role in LSTM model training.In fact, it is the essence of LSTM design.LSTM can selectively memorize important information, which is mainly realized by the forget gate. The hidden layer output result $H _ { t - 1 }$ of the previous time $_ { t - 1 }$ is transferred to the cell at time $t$ ,and the input value $X _ { t }$ at time $t$ enters the forget gate along with it. The responsibility of the forget gate is to control the extent to which $H _ { t - 1 }$ and $X _ { t }$ are forgotten; the calculation method is as follows: ",
        "page_idx": 3
    },
    {
        "type": "equation",
        "text": "$$\nF _ { t } = \\sigma \\big ( W _ { f } \\times \\left[ H _ { t - 1 } , X _ { t } + b _ { f } \\right] \\big ) ,\n$$",
        "text_format": "latex",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "where $F _ { t }$ is the value of forget gate at time step $t$ ，and the range of $F _ { t }$ is $0 { - } 1 ; \\sigma$ is the sigmoid activation function; $W _ { f }$ and $b _ { f }$ represent the weight and deviation of the forget gate,respectively; $H _ { t - 1 }$ is the hidden layer output result of the previous time $_ { t - 1 }$ ; and $X _ { t }$ is the input value at time $t$ ： ",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Furthermore, the forget gate measures its value by each input. If the input is not beneficial to the whole sequence information, it will be discarded as unimportant. If the value of $F _ { t }$ is close to 1, the input value $X _ { t }$ at time $t$ will be forgotten,and vice versa, in which case $F _ { t }$ will be calculated and passed to the cell state.LSTM uses selective forgetting to store effective information to ensure long-term memory, rather than the total absorption nature of the RNN method. ",
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "3.1.2 Input gate layer ",
        "text_level": 1,
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "The input gate controls which important information willbe updated and stored in the memory unit.   \nThe calculation formulas are shown in Equations 2 and 3. ",
        "page_idx": 3
    },
    {
        "type": "image",
        "img_path": "images/4441deadce20efedaf7a8f8ae0d185532f2b2a9214e352a4f54bcacfc28b66ad.jpg",
        "img_caption": [
            "Fig.2Basic structure of long short-term memory (LSTM) and detailed calculation process at time step $t$ (a), structural diagram of extreme gradient boosting (XGBoost; b),and diagram of support vector regression (SVR; c). The yellow highlighted area indicates the interval band of 2ε, where E means the absolute deviation value. $C _ { t }$ ,value of cell state at time step $t$ $C _ { t - 1 }$ , value of cell state at time step $t { - } 1 ; X _ { t } ,$ current input; $H _ { t } ,$ output result of hidden layer at time step t; $H _ { t - 1 }$ ,hidden layer output result of the previous time $_ { t - 1 }$ ; tanh,hyperbolic tangent function; $\\sigma$ ,sigmoid activation function; $T _ { 1 }$ ,the $1 ^ { \\mathrm { s t } }$ tree; $T _ { n }$ ,the $n ^ { \\mathrm { t h } }$ tree; $f ( x )$ ,the function of the model. "
        ],
        "img_footnote": [],
        "page_idx": 4
    },
    {
        "type": "equation",
        "text": "$$\nI _ { t } = \\sigma \\big ( W _ { i } \\times \\big [ H _ { t - 1 } , X _ { t } + b _ { i } \\big ] \\big ) ,\n$$",
        "text_format": "latex",
        "page_idx": 4
    },
    {
        "type": "equation",
        "text": "$$\n\\widetilde { C } _ { t } = \\operatorname { t a n h } \\left( W _ { c } \\times \\left[ H _ { t - 1 } , X _ { t } \\right] + b _ { c } \\right) ,\n$$",
        "text_format": "latex",
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "where $I _ { t }$ is the value of input gate at time step $t$ ,and it is also calculated by the activation function sigmoid, with a value range of 0-1; $W _ { i }$ and $b _ { i }$ represent the weight and deviation of the input gate, respectively; $\\widetilde { C } _ { t }$ is the cell update candidate; tanh means the hyperbolic tangent function; and ${ { \\cal { W } } _ { c } }$ （204号 and $b _ { c }$ represent the weight and deviations of the cell respectively. The purpose of introducing the cell update candidate $\\widetilde { C } _ { t }$ is to multiply its calculation results by $I _ { t }$ and pass to the cell state as the output of the input gate. ",
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "3.1.3 Cell state ",
        "text_level": 1,
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "The cell state is used in combination with the forget gate layer to store information. By comparing the value of the input result at time $t$ and the output result of the forget gate, it can be determined whether to pass more previous output results to the output gate or add more current input information to the sequence.This step is to ensure that important information is saved and redundant or unimportant information is discarded.Updating calculation of $C _ { t }$ is shown in Equation 4: ",
        "page_idx": 4
    },
    {
        "type": "equation",
        "text": "$$\nC _ { t } = F _ { t } \\times C _ { t - 1 } + I _ { t } \\times \\widetilde { C } _ { t } \\ ,\n$$",
        "text_format": "latex",
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "where $C _ { t }$ is the value of cell state at time step t; $C _ { t - 1 }$ is the value of cell state of the previous time $_ { t - 1 }$ ; and the updated $C _ { t }$ at time $_ { t + 1 }$ will be passed to the next cell as the input. ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "3.1.4 Output gate layer ",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "The output gate controls how the information flow of the cell state at time $t$ enters the hidden layer at time $_ { t + 1 }$ . The output gate also uses its defined weight ${ \\cal { W } } _ { o }$ and deviation $b _ { o }$ to calculate $O _ { t }$ . The calculation formulas are as follows: ",
        "page_idx": 5
    },
    {
        "type": "equation",
        "text": "$$\nO _ { t } = \\sigma \\big ( W _ { o } \\times \\big [ H _ { t - 1 } , X _ { t } + b _ { o } \\big ] \\big ) ,\n$$",
        "text_format": "latex",
        "page_idx": 5
    },
    {
        "type": "equation",
        "text": "$$\nH _ { t } = O _ { t } \\times \\operatorname { t a n h } \\left( C _ { t } \\right) ,\n$$",
        "text_format": "latex",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "where $O _ { t }$ is the value of output gate at time step $t$ $W _ { o }$ and $b _ { o }$ represent the weight and deviation of the output gate, respectively; and $H _ { t }$ is the output result of the hidden layer at time $t$ ： ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Each gate of LSTM has its own unique parameter group weight term $W$ and bias term $b$ Additionally,there is a weighted sum of the new input and the output of the previous hidden layer in each cell, which shows significant long-term memory characteristics and is easier to train. The most important facet is to make up for the shortcomings of the traditional RNN model. The activation function endows neural networks with nonlinear characteristics.Therefore,the correct selection of activation function can improve the data processing ability of these networks and make the simulation results closer to the observation values.It can also improve the computational efficiency of the networks. The initialization of weights is affected by random starting values, which leads to the uncertainty ofLSTM in training. In this study, we selected Adam as the stochastic optimization method (Kingma and Ba, 2015). ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "3.2 Extreme gradient boosting (XGBoost) ",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "XGBoost is a new scalable machine learning algorithm developed by Chen and Guestrin (2016). Gradient Boosting Decision Tree(GBDT) is an iterative decision tree algorithm that uses the gradient descent method to minimize the loss function in the parameter space to solve the optimization problem,and XGBoost is a modified form of it. XGBoost is widely used mainly because of its regularized boosting technology. The regularization term is a significant characteristic of XGBoost, which is superior to traditional GBDT and can be considered a penalty for the complexity level of the model. By evaluating the complexity feature of each regression tree, the complexity of the model can be effectively controlled to prevent overfitting. The objective function Obj is composed of error function and penalty, as shown in the following formulas: ",
        "page_idx": 5
    },
    {
        "type": "equation",
        "text": "$$\n\\begin{array} { c } { { O b j = \\sum _ { i = 1 } ^ { n } l \\left( y _ { i } - \\widehat { y } _ { i } \\right) + \\sum _ { t = 1 } ^ { t } \\Omega \\left( f _ { t } \\right) , } } \\\\ { { \\Omega \\left( f _ { t } \\right) = \\displaystyle \\gamma T + \\frac { 1 } { 2 } \\lambda \\| \\omega \\| ^ { 2 } , } } \\end{array}\n$$",
        "text_format": "latex",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "where $O b j$ is the objective function; $l$ is the loss function between the observed value $y _ { i }$ and the predicted value $\\widehat { \\boldsymbol { y } _ { i } }$ of the model; $\\Omega$ is the penalty; $\\gamma$ and $\\lambda$ are two adjustable parameters; $T$ represents the number of leaf nodes; and $\\omega$ is the leaf node fraction. ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "XGBoost chooses Newton's method to solve the optimization problem in the function space and can customize the objective function according to the user's needs. Calculating the error function requires second-order Taylor expansion (Zheng et al.，2019；Ni et al.，202O). Therefore,the selection of the objective function needs to meet the second-order differentiable condition. XGBoost is essentially an additive training model, and each regression tree learns the results and errors of all previous tree iterations. It is also a training process based on residuals.Because of its good performance in computing speed and simulation precision, XGBoost is widely used in hydrology research and is one of the most popular machine learning models. In this study, we applied XGBoost to simulate daily discharge in glaciated alpine watersheds in order to test its performance. ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "3.3 Support vector regression (SVR) ",
        "text_level": 1,
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "SVR is the regresson branch of support vector machine (Yang et al.， 2O17).As a classical regression model, SVR is a kernel-based algorithm. It can be employed to realize the nonlinearity of decision function and effectively fits the nonlinear relationship of samples (Aggarwal et al., 2012; Cheng et al.，2015; Luo et al., 2019). The difference between SVR and general linear regression is that it designs a spacer band on both sides of the linear function to allow some deviation between the model output value and the observed value. If the absolute deviation value is less than e (absolute deviation value),the data located in the spacer band and deviation will be ignored,whereas if the absolute value of the deviation is greater than E,the loss needs to be calculated.Therefore,the spacer band of $2 \\epsilon$ is considered a loss-free area,as shown in Figure 2c. ",
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "In addition, while traditional linear regression algorithms optimize a model by calculating the mean value after gradient descent, SVR obtains the optimized model by maximizing the width of the spacer band and minimizing the total loss.The penalty factor $C$ is an important parameter for the SVR algorithm to control overfitting. The value of $C$ represents the importance of outliers and can also be interpreted as the tolerance of errors.An increase in the $C$ value represents a smaller range of allowable error and a greater possibility of overfitting. Conversely, if the $C$ value is close to O,it is prone to underfitting. The $C$ value essentially controls the generalization ability of the model. If the $C$ value is too small or too large, the generalization ability of the model worsens. ",
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Within the setting of the SVR algorithm, the coefficient gamma is an important parameter of the Radial Basis Function Kernel, which determines the distribution of model input data mapped to a new high-dimensional feature space. The gamma value affects the running speed of the model and must be greater than O. The larger the gamma value, the fewer the number of support vectors. However, if the gamma value is too large,it is easy to generalize errors,leading to the phenomenon of overfitting. ",
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "3.4Hydrological models ",
        "text_level": 1,
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "The SWAT is a classc semi-distributed hydrological model(Arnold et al.,1998) that is well-suited for accurately describing the hydrological process in catchments by transferring information between hydrological response units (Li et al., 2010). The SWAT model with a snow-melting module has a good applicability in snow-covered areas (Chen et al., 2017), but the model's suitability is limited in high-altitude catchments where glaciers are widely distributed.In these cases, the degree-day method is employed to construct a glacier-melting module and integrate it into the SWAT model. The hydrological model with a melting mechanism is called the SWAT_Glacier model. It has been applied in recent studies to simulate the glacier melting processes in glaciated watersheds in Central Asia. Details on the SWAT and SWAT_Glacier models can be found in Ji et al. (2019). ",
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "The three above-mentioned machine learning methods (LSTM, XGBoost, and SVR) and two hydrological models (SWAT and SWAT_Glacier) based on physical mechanisms are popular in hydrological research. In this study, we atempt to systematically apply them to simulate the daily discharge in data-sparse glaciated river basins. The input data of machine learning algorithms include daily maximum and minimum temperatures and precipitation. The observed discharge data are used to train and validate the models.To compare the performance of the five models, the timesetting of the training and testing periods for the data-driven models is consistent with the two hydrological models. The training period is from 1 January 2002 to 31 December 2007,and the testing period is from 1 January 2008 to 31 December 2011. ",
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "3.5 Performance metrics ",
        "text_level": 1,
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "We selected four measurement indices,i.e., Nash-Sutcliffe efficiency coefficient (NS), percentage bias (PBIAS),correlation coefficient $( R ^ { 2 } )$ ,and root mean square error (RMSE),to evaluate and compare the capability of machine learning algorithms and hydrological models in simulating hydrological processes. ",
        "page_idx": 6
    },
    {
        "type": "equation",
        "text": "$$\n\\mathrm { N S } = 1 - \\frac { \\sum _ { i = 1 } ^ { n } \\left( Q _ { \\mathrm { o b s } } ^ { i } - Q _ { \\mathrm { s i m } } ^ { i } \\right) ^ { 2 } } { \\sum _ { i = 1 } ^ { n } \\left( Q _ { \\mathrm { o b s } } ^ { i } - \\overline { { Q _ { \\mathrm { o b s } } } } \\right) ^ { 2 } } ,\n$$",
        "text_format": "latex",
        "page_idx": 6
    },
    {
        "type": "equation",
        "text": "$$\nR ^ { 2 } = \\left\\{ \\frac { \\sum _ { i = 1 } ^ { n } \\bigl ( Q _ { \\mathrm { o b s } } ^ { i } - \\overline { { Q _ { \\mathrm { o b s } } } } \\bigr ) \\times \\bigl ( Q _ { \\mathrm { s i m } } ^ { i } - \\overline { { Q _ { \\mathrm { s i m } } } } \\bigr ) } { \\sqrt { \\sum _ { i = 1 } ^ { n } \\bigl ( Q _ { \\mathrm { o b s } } ^ { i } - \\overline { { Q _ { \\mathrm { o b s } } } } \\bigr ) ^ { 2 } \\times \\biggl [ \\sum _ { i = 1 } ^ { n } \\bigl ( Q _ { \\mathrm { s i m } } ^ { i } - \\overline { { Q _ { \\mathrm { s i m } } } } \\bigr ) ^ { 2 } \\biggr ] } } \\right\\} ^ { 2 } ,\n$$",
        "text_format": "latex",
        "page_idx": 7
    },
    {
        "type": "equation",
        "text": "$$\n\\mathrm { P B I A S } = \\frac { \\sum _ { i = 1 } ^ { n } \\mathopen { } \\mathclose \\bgroup \\left( Q _ { \\mathrm { s i m } } ^ { i } - Q _ { \\mathrm { o b s } } ^ { i } \\aftergroup \\egroup \\right) } { \\sum _ { i = 1 } ^ { n } \\mathopen { } \\mathclose \\bgroup \\left( Q _ { \\mathrm { o b s } } ^ { i } \\aftergroup \\egroup \\right) } ,\n$$",
        "text_format": "latex",
        "page_idx": 7
    },
    {
        "type": "equation",
        "text": "$$\n\\mathrm { R M S E } = \\sqrt { \\frac { \\sum _ { i = 1 } ^ { n } \\mathopen { } \\mathclose \\bgroup \\left( \\mathcal Q _ { \\mathrm { o b s } } ^ { i } - \\mathcal Q _ { \\mathrm { s i m } } ^ { i } \\aftergroup \\egroup \\right) ^ { 2 } } { n } } ,\n$$",
        "text_format": "latex",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "where $n$ is the length of observation or simulation; $\\mathcal { Q } _ { \\mathrm { { o b s } } } ^ { i }$ and $\\mathcal { Q } _ { \\mathrm { s i m } } ^ { i }$ are the observed and simulated discharges at time step $i ( \\mathrm { m } ^ { 3 } / \\mathrm { s } )$ ; and $\\overline { { \\mathcal { Q } _ { \\mathrm { o b s } } } }$ and $\\overline { { \\mathcal { Q } _ { \\mathrm { s i m } } } }$ are the averages of the observed and simulated discharges $( \\mathrm { m } ^ { 3 } / \\mathrm { s } )$ ,respectively. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "For these four measures, NS ranges from negative infinitesimal to 1.00, with ${ \\mathrm { N S } } { = } 1 . 0 0$ meaning perfect simulation. NS is largely influenced by peak flows. $R ^ { 2 }$ represents the collinearity of observed and simulated data, and PBIAS appraises the average deviation of the simulation from the observation, with negative values indicating an underestimation and vice versa.A value of zero for PBIAS is ideal, because it means there is no deviation.A small RMSE value reveals the good fitting performance and precise predictability of the model. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "4 Results ",
        "text_level": 1,
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "In this study, we drew hydrographs of the observed and simulated discharges of the Kumaric and Toxkan river basins to compare the performances of the three machine learning methods (LSTM, XGBoost, and SVR) and two hydrological models (SWAT and SWAT_Glacier). Scaterplots further illstrate the correlations between the simulations and observations.Figures 3 and 4 showed the simulation results of daily discharge in the Kumaric and Toxkan river basins,respectively. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "As canbe seen in Figures 3 and 4,allof the models obtained satisfactory results in the simulations of baseflow. However, their performance in the simulations of peak flow was quite different. The LSTM model did an excellent job of reproducing the observations, and its performance was significantly beter than that of either XGBoost or SVR in terms of PBIAS (Table 1). In comparing the hydrographs of the two hydrological models,we can conclude that the SWAT_Glacier model had a better performance than the SWAT model, especially for the summer peak flow. Furthermore, the SWAT_Glacier model was able to effectively simulate daily discharge, while the hydrograph of the SWAT model was relatively flat.This indicated that it is dificult to capture changes in discharge caused by increases in glacier and snow meltwater over a short-time period due to temperature rises.This phenomenon was more pronounced in the validation period (Fig. 5).A comprehensive comparison showed that LSTM has significant advantages, demonstrating a good fit with the observations.In contrast, the SWAT_Glacier and SWAT models did not perform as well in the testing period as in the training period,and their fitting degree for the Toxkan River Basin significantly decreased with large deviations. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "The hydrographs showed the performance of each model intuitively. However, for enhanced specificity,the statistical indices of the above five methods for both the training and testing periods are summarized for further comparison,as shown in Table 1. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "For the Kumaric River Basin,a comparison of the evaluation indices of the five methods revealed that LSTM was significantly better than the others in terms of the correlation index and relative deviation index. Specifically, the performance of LSTM was satisfactory and had only a slightly underestimated peak discharge during the training period, with NS being 0.96 and PBIAS of - $0 . 7 8 \\%$ . The results of the hydrological models were not as good as LSTM in terms of evaluation indices.For the SWAT_Glacier model,the indices were slightly poorer than the LSTM model, with $\\mathrm { N S } { = } 0 . 8 2$ ， $R ^ { 2 } { = } 0 . 8 3$ ,PBIAS $: = 0 . 9 4 \\%$ , and RMSE showing a value of 85.07 during the training period. Figure 5 represented the predictions of the three machine learning algorithms and two hydrological models for discharge during the validation period.As can be seen from Figure 5a and b, LSTM performed excellently, with all performance indicators significantly better than those for the other models. For LSTM, NS and $R ^ { 2 }$ were greater than O.90,which is very high for the prediction of daily discharge in an alpine basin. Furthermore, PBIAS was only $- 2 . 6 0 \\%$ ,RMSE was 60.26,and a relatively minor deviation was obtained. In contrast, for the SWAT_Glacier model, the indices were lower than those for the LSTM model, with $\\mathrm { N S } { = } 0 . 7 9$ ， $R ^ { 2 } { = } 0 . 8 0$ ,PBIA $S { = } \\mathrm { - } 5 . 4 \\%$ ,and RMSE showing a large value of 83.06 during the testing period. ",
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 8
    },
    {
        "type": "image",
        "img_path": "images/94b067bb9eb577776ed1f338cb8cf26475c76d850370c3930badc4b9322922b1.jpg",
        "img_caption": [
            "Fig.3Observed and simulated discharges of the five models for the Kumaric River Basin during the training period.(a),daily observations and simulations of the machine learning methods (LSTM, XGBoost,and SVR); (b), simulation performance of the traditional hydrological models (Soil and Water Assessment Tool (SWAT） and SWAT_Glacier (an extended SWAT model with glacier melting mechanism)); (c)-(g),scattrplots of observed and simulated values for each model, with $R ^ { 2 }$ representing the correlation coefficient. "
        ],
        "img_footnote": [],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 9
    },
    {
        "type": "image",
        "img_path": "images/43fb69215cd465e41a7603559d5c9b9d43389f099d549886cbe0f2660fab684f.jpg",
        "img_caption": [
            "Fig. 4Observed and simulated discharges ofthe five models in the Toxkan River Basin during the training period. (a),daily observations and simulations of the machine learning methods (LSTM, XGBoost, and SVR); (b), simulation performance of traditional hydrological models (SWAT and SWAT_Glacier); (c)-(g),scaterplotsof observed and simulated values for each model,with $R ^ { 2 }$ representing the correlation coefficient. "
        ],
        "img_footnote": [],
        "page_idx": 9
    },
    {
        "type": "table",
        "img_path": "images/0d958ab336b467d7abaee6bace32534e8f13e8dd17805e13bcd057dfbb05a292.jpg",
        "table_caption": [
            "Table1Evaluationofthe LSTM,XGBoost,SVR,SWAT_Glacierand SWAT models in daily discharge simulation during the training period (2002-2007)and testing period (2008-2011) in the Kumaric and Toxkan river basins "
        ],
        "table_footnote": [
            "Note:LSTM,lngrry;Boostreadntoig;,prttorresso;Aldter Assessment Tol;SWAT_Glacier,anextendedSWATmodel withglacier meltingmechanism;NS,Nash-Sutcliffeeffciency coefficient;PBIAS,percentage bias; $R ^ { 2 }$ ,correlation coefficient;RMSE,root mean square error. "
        ],
        "table_body": "<html><body><table><tr><td rowspan=\"2\">Period</td><td rowspan=\"2\">Model</td><td colspan=\"4\">Kumaric River Basin</td><td colspan=\"4\">Toxkan River Basin</td></tr><tr><td>NS</td><td>PBIAS (%)</td><td>R²</td><td>RMSE</td><td>NS</td><td>PBIAS (%)</td><td>R²</td><td>RMSE</td></tr><tr><td>Training</td><td>LSTM</td><td>0.96</td><td>-0.78</td><td>0.97</td><td>43.45</td><td>0.95</td><td>1.57</td><td>0.96</td><td>23.50</td></tr><tr><td rowspan=\"8\">Testing</td><td>XGBoost</td><td>0.96</td><td>-11.02</td><td>0.98</td><td>41.64</td><td>0.94</td><td>-13.17</td><td>0.98</td><td>27.23</td></tr><tr><td>SVR</td><td>0.80</td><td>-5.53</td><td>0.82</td><td>89.97</td><td>0.69</td><td>-8.30</td><td>0.71</td><td>60.81</td></tr><tr><td>SWAT_Glacier</td><td>0.82</td><td>0.94</td><td>0.83</td><td>85.07</td><td>0.80</td><td>-0.02</td><td>0.80</td><td>49.06</td></tr><tr><td>SWAT</td><td>0.74</td><td>-10.64</td><td>0.75</td><td>103.09</td><td>0.76</td><td>-3.64</td><td>0.77</td><td>53.33</td></tr><tr><td>LSTM</td><td>0.90</td><td>-2.60</td><td>0.90</td><td>60.26</td><td>0.71</td><td>-0.96</td><td>0.73</td><td>51.80</td></tr><tr><td>XGBoost</td><td>0.77</td><td>-3.59</td><td>0.77</td><td>86.13</td><td>0.55</td><td>-2.36</td><td>0.56</td><td>64.66</td></tr><tr><td>SVR</td><td>0.79</td><td>2.41</td><td>0.79</td><td>81.80</td><td>0.55</td><td>1.53</td><td>0.56</td><td>64.62</td></tr><tr><td>SWAT_Glacier</td><td>0.79</td><td>-5.40</td><td>0.80</td><td>83.06</td><td>0.50</td><td>9.90</td><td>0.58</td><td>68.76</td></tr><tr><td></td><td>SWAT</td><td>0.67</td><td>-21.49</td><td>0.73</td><td>103.07</td><td>0.36</td><td>10.58</td><td>0.49</td><td>83.11</td></tr></table></body></html>",
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Compared with traditional hydrological models, the LSTM model not only performs calculations faster, but also is more accurate in simulation.Although SWAT_Glacier with the glacier dynamic module significantly improved in performance compared to the original SWAT model,its simulation of peak flow was still slightly lower than that of the LSTM model. Overall, these results indicated that LSTM shows major advantages compared to the other four methods and is highly applicable in simulating discharge in the Kumaric River Basin. ",
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "According to Figure 3c-e, although XGBoost was slightly inferior to LSTM, it was better than SVR. Moreover, according to the results of the evaluation indices shown in Table 1, the values of NS and $R ^ { 2 }$ of XGBoost were higher than 0.95,RMSE was 41.64,and the relative deviation of PBIAS was $1 1 . 0 2 \\%$ . During the testing period, the NS and $R ^ { 2 }$ of XGBoost were higher than 0.75, and the PBIAS was only $- 3 . 5 9 \\%$ , showing that all the evaluation indices were within the acceptable range. This performance was overall satisfactory, indicating that XGBoost was feasible for use in simulating discharge in the Kumaric River Basin. However, XGBoost's performance in the testing period was not as good as in the training period, demonstrating that XGBoost was prone to overfitting discharge. Still， it did show advantages in cross validation. Based on our experimentation, we found that when neglecting time series and randomly dividing the testing and training periods according to proportion, the NS value improved, remaining above O.90 during the training periods and above 0.85 during the testing period. It is worth noting that because the division of the factor dataset is inconsistent with the other methods,it is not presented here. ",
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Despite its earlier successes, SVR did not perform as well as LSTM or XGBoost during the training period, giving NS and $R ^ { 2 }$ of 0.80 and PBIAS of $- 5 . 5 3 \\%$ . On the other hand, during the testing period, SVR performed much better, showing NS and $R ^ { 2 }$ of 0.79 and PBIAS of only $2 . 4 1 \\%$ ： In general, the overall performance of the SVR model was similar to that of the SWAT_Glacier model for the Kumaric River Basin,both of which were significantly better than the original SWAT model.As can be seen from the evaluation indices,the traditional hydrological SWAT model actually gave the worst performance among the five methods,and its performance in the training and testing periods was far lower than that of the other four methods.This clearly demonstrated that the SWAT model had dramatic limitations when applied to alpine watersheds and is thus unable to accurately describe the glacio-hydrological process. ",
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "For the Toxkan River Basin,Figure 4 presented the performance of the three mentioned machine learning algorithms and two hydrological models during the training period. It is obvious that the simulation of baseflow by the five methods was relatively consistent and that the fit was good. However, the performances of the models in the simulation of summer peaks differed greatly from each other. The LSTM model simulation results were closest to the observed values, with $\\mathrm { N S } { = } 0 . 9 5$ ， $R ^ { 2 } { = } 0 . 9 6$ ,PBIAS $3 = 1 . 5 7 \\%$ ,andRMSE $\\scriptstyle : = 2 3 . 5 0$ . Further, LSTM had a high correlation coefficient and relatively small deviation that can accurately describe the daily variations of discharge. The simulation performance of XGBoost was slightly lower than that of LSTM, and the relative deviation was relatively large. On the other hand, SVR performed poorly and the NS and $R ^ { 2 }$ values were the lowest, so it was difficult to capture any peak value trends. Compared with the SWAT model,the accuracy of the SWAT_Glacier model was improved, with NS inching up from 0.76 to ",
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 11
    },
    {
        "type": "image",
        "img_path": "images/73304faa5f230a3d08015b7ad165cc81ccc8e740c03932f9c070c2db54163a80.jpg",
        "img_caption": [
            "Fig. 5Predictions of the three machine learning algorithms (LSTM, XGBoost, and SVR) and two hydrological models (SWAT_Glacier and SWAT) for discharge in the Kumaric River Basin (aandb)and Toxkan River Basin (c and d) during the testing period "
        ],
        "img_footnote": [],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "0.80,PBIAS changing from $- 3 . 6 4 \\%$ to $- 0 . 0 2 \\%$ ，and RMSE decreasing from 53.33 to 49.06. However, compared to LSTM, the performance of SWAT_Glacier was clearly inferior, which was more obvious in the testing period. ",
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "For the Toxkan River Basin, Figure 5c and d presented the forecast discharge of the five models. The LSTM model had the highest prediction accuracy, with $\\mathrm { N S } { = } 0 . 7 1$ ， $R ^ { 2 } { = } 0 . 7 3$ ，PBIAS $\\ S { = } \\mathrm { - } 0 . 9 6 \\%$ and $\\mathrm { R M S E } { = } 5 1 . 8 0$ . Both NS and ${ \\bf \\dot { \\boldsymbol { R } } } ^ { 2 }$ values were above 0.7O in the testing period,and their performance was significantly better than that of the other models. Compared with the SWAT_Glacier model, NS was increased by 0.21, the absolute value of PBIAS was decreased by $8 . 9 4 \\%$ $\\overline { { R ^ { 2 } } }$ was increased by 0.15,and RMSE was decreased by 16.96 for the performance of LSTM model.The prediction results of LSTM were considered to be satisfactory for the model. The prediction accuracy of XGBoost and SVR was similar, giving NS of 0.55 and a generally consistent relative deviation.A similar phenomenon also occurred in the Kumaric River Basin, where the performance of the two hydrological models was not as good as that of the three classcal algorithms. Once again, the SWAT model gave the worst performance, with NS and $R ^ { 2 }$ at the lowest and PBIAS and RMSE at the largest. ",
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "In order to test the robustness of various methods and analyze their performance in relation to discharge prediction on a monthly scale, we calculated the relative errors of the five models, as shown in Figure 6.The relative error was calculated by the ratio of the error of the simulation and the observation to the observed data. A positive value represents overestimation, while a negative value indicates underestimation. ",
        "page_idx": 12
    },
    {
        "type": "image",
        "img_path": "images/e37e8b801246116ebbc1b5245ec27d81b35ef621c289fb4c7e0f7b9c71958219.jpg",
        "img_caption": [
            "Fig.6Distribution of relative errors generated by machine learning algorithms (LSTM,XGBoost,and SVR)and hydrological models (SWAT_Glacier and SWAT)on a monthly scale in the Kumaric River Basin (aand b)and Toxkan River Basin (c and d).The box and whisker plots show the five-number summaryof a set of data: the minimum score,first (lower） quartile,median,third (upper) quartile,and the maximum score. The center represents the middle $50 \\%$ ,or $5 0 ^ { \\mathrm { t h } }$ percentile of the data set,and is derived using the lower and upper quartile values.The median value is displayed inside the \"box\".The maximum and minimum values are displayed with verticallines (\"whiskers\")connecting the points to thecenter box.The circles represent the outliers.The box and whisker plots have the same meaning as Figure 8. "
        ],
        "img_footnote": [],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Figure 6a and c indicated that the relative errors of the five models were mainly distributed in the range from $- 0 . 2 5$ to 0.25. Specifically, the LSTM error was quite small during the entire training and testing periods. XGBoost underestimated discharge, with a small error in the training period but a large error during the testing period. This reveals that XGBoost is prone to overfitting discharge, resulting in a poor fiting effect for the testing period. Unlike LSTM or XGBoost, SVR was more likely to overestimate and thus showed a larger error in monthly discharge simulation. ",
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Compared with the other three algorithms,the SWAT_Glacier and SWAT models had larger errors. Figure 6b and d showed that the analysis results of the Toxkan River Basin were similar to those of the Kumaric River Basin,and that the simulations between the two hydrological models were larger. Compared with the other models,LSTM showed a smaller error, which was more clearly demonstrated in the boxplot in Figure 6.It can be seen that although the median of the five models was near the baseline,the relative errors of the LSTM model for the two basins were mainly distributed in a fairly smal range, with 0.O as the center. Although the boxplot of XGBoost was a narrow box representing the middle $50 \\%$ of the data, the overall distribution was underestimated. For both SWAT_Glacier and SWAT, in addition to the large box width, the difference between the maximum value and the minimum value was large.This indicates that the relative error between the simulated and observed values was large. ",
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "In general, the discharge simulations of the five models for the Kumaric River Basin were beter than those for the Toxkan River Basin. The LSTM method in particular showed a great potential to simulate and forecast discharge in both basins. Although XGBoost had a good performance in the training period, its application was limited by the issue of overfitting,and the performance of SVR was not as good as that of LSTM. Compared with the SWAT model, the SWAT_Glacier model exhibited a better simulation ability, but the performance of the SWAT_Glacier model was still much lower than that of the LSTM model. Overall, te SWAT model gave the poorest performance among the five models,revealing its unsuitability for discharge simulations in glaciated alpine regions. ",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "5 Discussion ",
        "text_level": 1,
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "In comparing the evaluation indices, we found that the five models performed beter in the Kumaric River Basin than in the Toxkan River Basin. One of the key reasons for the differences in performance is the unevenness of the distribution of meteorological stations in the Toxkan River Basin. Because the basin is located in a remote mountain area characterized by undulating hills and valleys,it is challenging to installmeteorological stations,and the maintenance cost is prohibitive. Hence, there are only two meteorological stations in the basin, covering an area of $1 . { \\overset { \\underset { \\ r { 9 } } { } } { \\cdot { } } } { \\overset { \\underset { \\ r { 0 } } { } } { \\times } } 1 0 ^ { 4 } ~ \\mathrm { k m } ^ { 2 }$ ， and these stations are located on the border of the basin. ",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "The elevation range of the Toxkan River Basin is $1 8 8 4 - 5 9 3 4 \\mathrm { m }$ , with an average altitude of 3558 m (Fig.7). One of the meteorological stations, called Akqi, is located in the downstream plains near the outlet of the basin, at an altitude of $1 9 8 5 \\mathrm { ~ m ~ }$ . Its location allows it only a weak representation of the climate condition in the upstream area. Therefore,its contribution to the simulation is very minor. The other meteorological station, called Tuergate,is located outside the basin but at a relatively high altitude of $3 5 0 4 \\mathrm { m }$ . Due to the mentioned complex topographical features of the basin, the data from the Akqi and Tuergate stations cannot accurately reflect the basin's overall spatiotemporal variations of temperature and precipitation. This is a critical failure,as temperature and precipitation are considered the most crucial factors affecting the process of glacier and snow accumulation and melting (Chen et al.,2017). Previous studies have shown that temperature plays a dominant role in the discharge of the Kumaric River Basin (Ji et al.,2O19), whereas in the Toxkan River Basin, the discharge is affected by both temperature and precipitation (Duethmann et al., 2015). ",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "Figure 8 showed the distribution of precipitation， maximum temperature， and minimum temperature for meteorological observation stations in the two basins.The Aksu, Koilu, and Tianshan stations are located in the Kumaric River Basin, with elevations of 1103,2800,and 3614 m,respectively. Figure 8c and e presented temperature variations in the three meteorological observation stations across diferent altitude zones.As can be seen from the figure, the changes in the maximum and minimum temperatures at the three stations were relatively consistent, and the variation range was small. This indicated the high quality of the observed temperature data, and since temperature played a key role in the discharge of the Kumaric River Basin,all five models had good performances. ",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "The Akqi and Tuergate meteorological stations are located in the Toxkan River Basin.Figure 8d and f presented changes in the maximum and minimum temperatures, respectively, with overall temperature variations being relatively minor. However, as shown in Figure 8b, precipitation at the two stations varied greatly from June to October. The uncertainty in the precipitation data caused challenges in discharge simulations in the Toxkan River Basin,which is further impacted by the combined effects of temperature and precipitation. The observation data from the two stations reveal some defects in their reflection of the precipitation distribution for the basins. The imprecision of the temperature and precipitation data can lead to significant errors when altitude is changed,limiting the applicability and performance of the hydrological models.Therefore, neither the traditional hydrological models nor the deep learning methods are effective. ",
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "In addition, the variations in discharge in glaciated alpine watersheds are not only closely related to changes in temperature, precipitation, and other important climate factors, but also affected by changes in glacier and snow distribution, glacier dynamics, groundwater, and other external factors. Therefore, integrating physical models with deep learning methods for further exploration might be a promising future research direction. ",
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "The simulation of peak flow is an insurmountable problem in hydrological models,and it is almost impossible for such simulations to be as good as baseflow. However, LSTM has obtained highly satisfactory results for both baseflow and peak flow, potentially making this method ideal for the study of regional floods.Especially in glacier-dominated basins with floods caused by glacier lake outbursts,the LSTM approach is expected to deepen our understanding of floods in general, which is an important direction for future research. The accurate prediction of floods can provide important decision-making evidence for reducing flood-related losses. ",
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "As demonstrated in this study, the LSTM method provides a new perspective in regional hydrological research, especially in glaciated alpine regions where meteorological data are scarce. LSTM sheds new light on discharge simulations through the enhancement of result accuracy compared to traditional hydrological models that are dependent on a large number of physical parameters. Furthermore, data-driven methods do not necessarily require prior knowledge of the watershed hydrological system, as proposed by Razavi and Coulibaly (2013). ",
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "It should be admitted nonetheless that all these methods have their own advantages and disadvantages. The model-dependent methods can interpret the physical mechanisms of the hydrological process by calibrating hydrological parameters with physical significance in a specific hydrological model. However, the operation of these types of models relies not only on large amounts of spatial attribute data (such as land use and spatial distribution of soil), but also on highquality meteorological observation data， resulting in complicated time- and cost-consuming computational methods. ",
        "page_idx": 14
    },
    {
        "type": "image",
        "img_path": "images/86017822efc0def1ae3b16812a0199b8c5579fdf3b57b7f3db7d3b0208c0c1f8.jpg",
        "img_caption": [
            "Fig.7Relationship between basin area and altitude in the Toxkan River Basin "
        ],
        "img_footnote": [],
        "page_idx": 14
    },
    {
        "type": "image",
        "img_path": "images/253547835d1509c825cdcb12b58cdbcc184bee0bd58c1dd5a221ed030931d768.jpg",
        "img_caption": [
            "Fig.8Boxplot of precipitation, maximum temperature,and minimum temperature at meteorological observation stations in the Kumaric River Basin (a,c,and e)and Toxkan River Basin (b,d,and f) "
        ],
        "img_footnote": [],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "In this regard, the LSTM method has substantial advantages. For alpine watersheds where the discharge is mainly dominated by meteorological factors,only meteorological forcing data are needed as input factors in the neural network,and the underlying surface spatial attribute data with little contribution to discharge can be ignored. LSTM also does not introduce complex hydrological parameters,which avoids the issue of \"different parameters with the same efect\" that is usually encountered in hydrological models.Furthermore,the LSTM algorithm does not focus on the physical mechanisms of the hydrological cycle and thus ignores the causal relationship between the variables in the study area. Compared with the distributed hydrological models,the LSTM method, which only relies on observation variables with time series and learns the mapping relationship between discharge and input characteristics,uses less input variables to obtain better simulation results. This technique, with its unprecedented accurate prediction capabilities, provides a new strategy for hydrological simulations of data-sparse alpine river basins. ",
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "6 Conclusions ",
        "text_level": 1,
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "Three machine learning methods (LSTM, XGBoost, and SVR) and two physical hydrological models (SWAT_Glacier and SWAT) for simulating discharge in snow- and glacier melt-dominated basins in alpine regions (the Tianshan Mountains) were presented and tested in this study. Our comparison of the five approaches demonstrated that the artificial neural network algorithm LSTM has incomparable advantages over the others. The LSTM model has a strong adaptability for simulating discharge in data-sparse glaciated-dominated basins. The data-driven algorithm improves the accuracy of discharge simulation by learning the mapping relationship between discharge and meteorological data.The other two machine learning methods (XGBoost and SVR), however, show certain limitations, e.g., XGBoost tends to overfit and SVR has poor simulation abilities.The performance of the SWAT_Glacier model is inferior to that of the LSTM model, but it has significantly improved from the original SWAT model. In our study, simulations from the SWAT_Glacier model showed a high consistency with observations,while the SWAT model without the benefit of the glacier dynamic module had difficulty in accurately describing the glaciohydrological process in glaciated alpine basins. Compared with hydrological models, the LSTM algorithm has a higher simulation accuracy with simple input data and low calculation costs. Therefore, the application of LSTM to hydrological research in data-sparse alpine basins marks a major step forward. ",
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "In the future, we might be considering combining machine learning algorithms with hydrological models to establish the physics-aware machine learning methods, which can systematically analyze the physical mechanisms in glaciated alpine basins.This is an interesting and meaningful direction. ",
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Acknowledgements ",
        "text_level": 1,
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "This research was supported by the National Natural Science Foundation of China (U1903208,41630859, 42071046).The authors wish to express great thanks to Prof.YANG Jing from National Institute of Water and Atmospheric Research in New Zealand for his guidance on hydrological models.We are grateful to the anonymous reviewers and editors for their insightful and constructive comments that helped improve the manuscript. ",
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "References ",
        "text_level": 1,
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Aggarwal S K,Goel A,Singh VP.2012.Stage and discharge forecastingby SVMand ANN techniques.Water Resources Management,26:3705-3724.   \nAjamiN,GuptaH,WagenerT,etal.2Oo4.Calibrationofasemi-distributedhydrologic modelfortreamflowestimatioalonga river system. Journal of Hydrology,298:112-135.   \nAroldJG,SriivasanR,MutiahRS,etal.998.Largeareahydrologic modelingandassessment—Part1:Modeldevelopment. JAWRA Journal of the American Water Resources Association,34:73-89.   \nBengioY,SimardP,FrasconiP.1994.LearngLong-Termdependencies withgradientdescentisdificult.IEEETansactions on Neural Networks,5:157-166.   \nChen TQ, Guestrin C.2016.XGBoost: A scalable tree boosting system. In: Proceedings of the $2 2 ^ { \\mathrm { n d } }$ ACM SIGKDD International Conference on Knowledge Discovery and Data Mining.San Francisco: Special Interest Group on Management of Data, $7 8 5 -$ 794.   \nChen X,Long D,HongY,etal.0l7.Improved modelingofsnowandglacier melting byaprogressivetwo-stagecalibation strategywith GRACEand multisource data:How snowand glacier meltwater contributes totherunofof the Upper Brahmaputra River basin? Water Resources Research,53:2431-2466.   \nChen Y N,Takeuchi K, $\\mathtt { X u } \\mathrm { { C } \\mathrm { { C } } }$ ,et al.2Oo6.Regional climate change and its effects on river runoff in the Tarim Basin, China. Hydrological Processes,20: 2207-2216.   \nChenYN,LiWH,DengHJ,etal.2016.ChangesinCentral Asia's watertower:past,presentandfuture.ScientificReports,6: 35458,doi: 10.1038/srep35458.   \nChenYN,Li WH,Fang GH,etal.2017.Review article: Hydrological modeling in glacierizedcatchmentsof CentralAsiastatus and challenges.Hydrology and Earth System Sciences,21: 669-684.   \nChengCT,FengZK,NiuWJ,etal.2Ol5.Heuristic methods forreservoir monthlyinflow forecasting:Acasestudyof Xinfengjiang Reservoir in Pearl River, China.Water,7: 4477-4495.   \nDuethmannD,BolchT,FarinottiD,etal.2O15.Atributionofstreamflowtrends insnowand glaciermelt-dominatedcatchments of the Tarim River, Central Asia.Water Resources Research,51:4727-4750.   \nDuethmann D,Menz C,JiangT,etal.2016.Projections forheadwatercatchmentsoftheTarimRiverrevealglacierretreatand decreasing surface wateravailability butuncertaintiesare large.Environmental Research Leters，11:O54024，doi: 10.1088/1748-9326/11/5/054024.   \nFanYT,ChenYN,LiWH.014.IncreasingprecipitationandbaseflowinAksuRiversince the95Os.QuaternaryInteatioal, 336:26-34.   \nFang K,Shen CP,KiferD,etal.2017.Prolongationof SMAP to spatiotemporallyseamless coverageofcontinental US.using a deep learning neural network. Geophysical Research Letters,44,doi: 10.1002/2017gl075619.   \nFang K,ShenCP.2O19.Near-real-time forecastofsatelite-basedsoilmoistureusinglongshort-termmemorywithanadaptive data integration kernel.Journal of Hydrometeorology,21: 399-413. networkswith data integration at continental scales.Water Kesources Kesearch，S6:eZUlywRU26/93，do1: 10.1029/2019WR026793.   \nFinger D,Vis M,HussM,etal.2015.Thevalueof multipledata setcalibrationversus modelcomplexityfor improvingthe performance of hydrological models in mountain catchments.Water Resources Research,51: 1939-1958.   \nFu ML,FanTC,Ding ZA,etal.2020.Deeplearning data-intelligence modelbasedonadjusted forecasting window scale: Application in daily streamflow simulation. IEEE Access,8: 32632-32651.   \nGao S,Huang YF,Zhang S,etal.2020.Short-termrunof prediction with GRUandLSTMnetworks withoutrequiring timestep optimization during sample generation.Journal of Hydrology,589:125188,doi:10.1016/j.jhydrol.2020.125188.   \nGreffK,SrivastavaRK,KoutnikJ,etal.20l7.LSTM:AsearchspaceoysseyIEEETransactionsonNeuralNetworksand Learning Systems,28: 2222-2232.   \nGreve P,Burek P,Wada Y2020.Using the Budyko frameworkforcalibratinga global hydrological model. Water Resources Research,56: e2019WR026280,doi: 10.1029/2019WR026280.   \nHochreiter S,Schmidhuber J.1997.Long short-term memory.Neural Computation,9:1735-1780.   \nHsuK,Gupta HV,Sorooshia S.995.Artificial neural network modelingof therainfall-unoffprocess.Water Resources Research,31: 2517-2530.   \nHu C H,Wu Q,Li H,etal.2018.Deep learning with a Long Short-Term Memory networks aproach forrainfal-runoff simulation. Water,10:1543,doi: 10.3390/w10111543.   \nHuYC,YanL,HangT,etal.2020.Stream-flow forecastingofsmallrversbasedonLSTM.arXive-prints.arXiv:2001.05681. https://arxiv.org/abs/2001.05681.   \nImmerzeel WW,van Beek L,Bierkens M.2010.Climate change willafectthe Asian watertowers.Science,328:1382-1385.   \nImmerzeelWW,LutzAF,Andrade M,etal.220.Importanceandvulnerabilityofthe world's watertowers.Nature,577:364 369.   \nJiHP,Fang GH,YangJ,etal.2019.Multi-objectivecalibrationofadistributedhdrologicalmodelinahighlyglacierized watershed in Central Asia.Water,11: 554,doi: 10.3390/w11030554.   \nJodarJ,CarpinteroE,arts-RosiloS,etal.218.Combnationofumpedhydrologicalandremotesensingmodelstoaluate water resources in asemi-arid high altitude ungauged watershed of Siera Nevada (Southern Spain).Science of the Total Environment, 625: 285-300.   \nKingma D,Ba J. 2015.Adam: A Method for Stochastic Optimization. In: Proceedings of the $3 ^ { \\mathrm { r d } }$ International Conference on Learning Representations. San Diego: Computational and Biological Learning Society.   \nKratzertF,Klotz D,BrennerC,etal.2018.Rainfall-runoff modelling usingLong Short-Term Memory(LSTM) networks. Hydrology and Earth System Sciences,22: 6005-6022.   \nKratzertF,KlotzD,HerreggerM,etal.2l9a.Towardimproved predictions inungaugedbasins:Exploitingtheowerof machine learning.Water Resources Research,55:11344-11354.   \nKratzertF,KlotD,alevG,etal.9b.owardslaringiversal,egional,ndlocalhydrologicalbhaviorsvicie learning applied to large-sample datasets.Hydrology and Earth System Sciences,23: 5089-5110.   \nKratzertF,KlotzD,HochreiterS,etal.2020.Anoteonleveragingsynergyinmultiplemeteorologicaldatasets withdpleaing forrainfall-runoffmodeling.HydrologyandEarth System Sciences Discussion.[Preprint].htps:/diorg/10.5194/hess-2020- 221, in review.   \nLi W,Kiaghadi A,Dawso C.2021.High temporalresolutionrainfallrunofmodelingusing long-short-term-memory(LSTM) networks.Neural Computing and Applications,33: 1261-1278.   \nLi ZL,ShaoQX,XuZX,etal.2010.Analysis ofparameteruncertaintyinsemi-distributed hydrological modelsusingbostrap method: Acase studyof SWATmodelappliedto Yingluoxia watershed in northwest China.JournalofHydrology,385:76- 83.   \nLuo XG,Yuan XH,Zhu S,etal.2l9.A hybrid support vectorregression framework for streamflow forecast.Jouralof Hydrology, 568:184-193.   \nMaier HR,JainA,DandyGC,etal.2O10.Methods used forthe developmentofneural networks forthe predictionof water resource variables inriversystems: Currentstatusand future directions.Environmental Modellng & Software,25:891-909.   \nMichaud J,Sorooshian S.1994.Comparison of simple versus complex distributed runoff modelson amidsized semiarid watershed.WaterResources Research,30:593-605.   \nNiLL,WangD,WuJF,etal.2020.Streamflow forecastingusing extreme gradientboosting modelcoupled withGaussian mixture model.Journal of Hydrology, 586:124901,doi: 10.1016/j.jhydrol.2020.124901.   \nQin J,YangK,Liang SL,etal.2Oo9.Thealtitudinal dependenceofrecentrapid warmingovertheTibetanPlateau.Climatic Change,97: 321,doi: 10.1007/s10584-009-9733-9.   \nRazavi T,CoulibalyP.2O13.Streamflowprediction inungauged basins:Review of regionalizationmethods.Journalof Hydrologic Engineering,18:958-975.   \nReichstein M,Camps-Valls G,StevensB,et al.2019.Deep learningand processunderstanding fordata-driven earth system science.Nature,566:195-204.   \nRudin C.2O19.Stopexplainingblackbox machine learming modelsforhighstakes decisionsanduse interpretable models instead. Nature Machine Intelligence,1: 206-215.   \nShen CP.2O18.A transdisciplinaryreview of dep learning researchand its relevance for waterresources scientists.Water Resources Research,54:8558-8593.   \nShen CP,LaloyE,ElshorbagyA,etal.2018.HESOpinions: Incubatingdeep-learning-powered hydrologicscienceadvances as a community.Hydrology and Earth System Sciences,22: 5639-5656.   \nShenYJ,ShenYJ,FinkM,etal.2O18a.UnravelingthehydrologyoftheglacierizedKaiduBasinbyintegratingmultisource data in the Tianshan Mountains,Northwestern China.Water Resources Research,54:557-580.   \nShen YJ,ShenYJ,FinkM,etal.2018b.Trendsandvariabilityinstreamflowandsnowmeltrunoff iminginthesouthern Tianshan Mountains.Journal of Hydrology, 557:173-181.   \nTarasovaL,Knoche,ietrchJ,etal.l6.Effectsoiputscretizatio,oelomplexityndcaratiostrategyodel performance in a data-scarce glacierized catchment in Central Asia.Water Resources Research,52: 4674-4699.   \nViviroli D,Kummu M,Meybeck M,etal.2020.Increasingdependenceoflowlandpopulationson mountain wateresources. Nature Sustainability, 3:917-928.   \nXiang ZR,Yan J,Demir I.2020.Arainfal-runoff model withLSTM-based sequence-to-sequence learing.Water Resources Research,56,doi:10.1029/2019wr025326.   \nYangT,SunFB,GentineP,etal.2Ol9.Evaluationandmachinelearingimprovementofglobalhydrologicalmodel-basedflood simulations.Environmental Research Letters,14:114027,doi:10.1088/1748-9326/ab4d5e.   \nYangTT,AsanjanAA,WellsE,etal.2O17.Developingreservoirmonthlyinflowforecastsusingartficial intelligenceand climate phenomenon information.Water Resources Research,53:2786-2812.   \nZheng ZS,MaQJinSC,etal.20l9.Canopyandterainiteractionsafctingsnowpackspatialpattersintheerra Nevada of California.WaterResources Research,55:8721-8739. ",
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 17
    },
    {
        "type": "text",
        "text": "",
        "page_idx": 18
    }
]