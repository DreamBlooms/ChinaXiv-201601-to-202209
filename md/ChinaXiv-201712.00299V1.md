# Tekla Structures 的二次开发在框构桥设计中的应用

齐成龙

（中国铁路设计集团有限公司桥梁院，天津300142）

【摘要】三维建模和二维出图在现阶段BIM应用过程中具有同等的重要性，为了充分利用TEKLA软件在钢筋混凝土结构BIM建模方面的优势并提高框构桥设计效率，本文介绍了一个使用C#语言对TEKLA软件进行二次开发的框构桥设计工具。该工具以FUBS 框构桥配筋计算程序文本文件结果作为输入数据,通过调用TEKLA接口，自动生成框构桥三维钢筋混凝土结构模型、生成二维工程图并统计数量。同时，本文还分析了该设计工具的开发流程和对一些难点的解决方案。经过实践检验,利用本设计工具进行框构桥设计，具有高效、准确的优势。该设计工具的开发过程和开发思路，可以为类似工程应用提供参考。

【关键词】BIM；TEKLA；二次开发；框构；钢筋【中图分类号】TU17；TU375.4；U44 【文献标识码】A【DOI】10.16670/j.cnki.cn11-5823/tu.2017.05.09

【文章编号】1674-7461(2017)05-0050-06

# 引言

>三维设计技术是当前计算机辅助设计的发展趋势，在机械、建筑、化工、石油等设计行业已得到较为成功的应用,并成为市场竞争的重要工具[1-2]中国铁路总公司提出,要建立以BIM为主要技术框架,以铁路工程全生命周期管理为目标的工程信息化平台和应用模式[3],从而确立了BIM技术在铁路设计中的地位。

模型是信息的载体，而三维建模又是BIM技术的基础和难点。天宝公司的Tekla作为一款优秀的平台性BIM设计软件，具有强大的混凝土、钢筋三维建模及其二维出图功能。当然，任何事情都有两面性，Tekla软件除了以上优点之外还有很多不足，比如对于钢筋混凝土结构更倾向于提供底层建模工具，对于特定的结构类型，如果仅通过人机交互界面来实现三维建模及二维出图目标，则需要用户的大量手动修改和重复性操作，不仅降低了效率，对于整个工程的质量控制也是不利的。

所以，为了充分利用TEKLA软件的钢筋设计功能，针对具体工程结构类型来开发相应设计工具就显得很有必要。已有FUBS框构桥配筋计算程序能够形成文本文件形式的初步配筋设计成果，通过C#语言调用TEKLA接口开发出一个设计工具，本设计工具能够读入FUBS的计算结果，并开放交互界面使用户根据个性化需求修改FUBS计算结果，最终自动生成框构桥三维钢筋模型、生成二维工程图并统计数量。本文将详细阐述上述开发过程和开发思路，以期为类似工程应用提供参考。

# 2框构桥背景介绍

框构桥的设置一般情况下是为了满足公路下穿铁路的立交要求，与梁式桥相比，由于其顶板厚度小于梁高，通常设置在净空要求比较紧张的立交位置，该位置如果采用公路下挖的方案，则存在公路排水、平顺性要求等诸多限制，因此一般是控制全线线位高程的关键节点。框构桥的设置能够起到降低整体线位高程进而节省工程投资的作用。

根据公路、铁路相对位置关系的不同，框构桥有正交、斜交之分，图2所示为斜交框构。框构桥的钢筋配置主要有以下几种：

骨架钢筋：沿纵桥向配置，每一个骨架包含若干不同种类的钢筋并且配置在横桥向某固定区域范围内，一个框构桥可以有若干个骨架依次循环沿横桥向按固定间距排列。

OD0

![](images/63eac4e7cc2ff35af99f5ef41a823b90026c0186f577ecea4c50ecf3a1d4ab06.jpg)  
图1框构桥主体结构纵断面图

![](images/38a4dabc755553d7d44e4fd2bcc04e32fbfc5c0a24e7da7413b4af1917cdda0e.jpg)  
图2框构桥主体结构俯视图  
图3骨架钢筋排列方式

框构桥沿纵桥向受到列车荷载、混凝土收缩徐变、温度、二期恒载等多种作用，骨架钢筋配置即是为了满足这些作用的受力要求，一般情况下需要通过计算确定。

此外，框构桥钢筋配置还包括横桥向钢筋、拉筋、顶板钝角加强钢筋等，这些钢筋的配置一般是通过构造要求确定。

# 3接口程序介绍

本文介绍的设计工具是连接FUBS和TEKLA的纽带，它以FUBS的计算结果为输入，以存在于

TEKLA中的模型和图纸为输出，本章阐述二者的对外接口。

# 3. 1 FUBS对外接口

FUBS系统是基于Midas通用计算软件计算框构桥形成的内力结果基础上，开发的框构桥设计后处理程序。FUBS目前可以处理1孔、2孔、3孔框构的设计，并且仅适用于对称框构的设计。

对于起主要受力作用的骨架钢筋，调查已有框构桥的骨架钢筋配置，将其分成n个种类，任何一个框构桥的骨架钢筋配置都可以简化为这n个类型钢筋的排列组合，每一个具体的骨架钢筋类型，其长度、直径以参数的形式存在。

FUBS程序在配筋计算结束以后，会生成几个文本文件，这些文本文件记录了框构桥的所有信息，包括主体结构尺寸和钢筋配置信息等。其中，骨架钢筋配置信息包括骨架类型数、骨架间距，以及在某一个具体的骨架当中，对于类型i的骨架,钢筋各肢长度、直径是多少等。

在本文介绍的设计工具中，FUBS输出的这些文本文件即是其对外接口。

# 3.2 TEKLA接口

接口（Interface）是两个实体之间的界面，TEKLA 提供了两个接口，一个是用户接口（UserInter-face），该接口是用户和软件之间的界面，也就是通常所说的人机交互界面；另一个是API（ApplicationProgrammingInterface），该接口是TEKLA软件和其它软件之间的界面，对于TEKLA来说，它允许其他软件通过C#语言和VB语言与之进行交互。

本文的TEKLA二次开发成果即是通过C#语言调用TEKLA的API接口来实现的。

FUBS的计算结果是满足框构桥受力和构造要求的最低钢筋配置，本设计工具即在此基础上调用TEKLA接口，自动生成主体结构模型，批量生成钢筋模型。形成针对框构桥从结构计算到三维建模到二维出图和工程量计算的一整套设计系统，以达到提高生产效率和设计质量的目的。

# 4 程序架构

本二次开发成果由三维建模和二维出图两个独立的程序组成，完整工作流程如图4所示，

FUBS程序的结构计算工作完成后，会将计算结果以文本文件的形式输出，

三维建模程序读入这些文本文件，并提供了如图5和图6所示的两个用户交互界面，这两个对话框允许用户根据个性化要求重新确定主体结构尺寸和钢筋布置，并能够将修改后的框构设计成果以文本文件的形式输出，这些文本文件与FUBS输出结果格式相同，可在修改设计时被三维建模程序重新读入。完成上述框构设计过程后，建模程序输出带有普通钢筋和混凝土结构的三维TEKLA模型。

![](images/30638ef96da75d464536ae6e78af05775f9e378c87a5099b84a92d6573e9a72c.jpg)

二维绘图程序以三维框构模型做为输入元素，由于建立的三维框构模型并未包含二维出图需要的所有信息，例如在不同的图幅当中哪些钢筋需要显示、以何种方式显示、哪些需要标注等。所以在三维建模程序中，以自定义属性的方式为钢筋对象添加这些信息，从而实现这部分信息的完整传递。

框构钢筋图分为三种：主体钢筋图、骨架钢筋图、顶板钝角加强钢筋图。对于同一根钢筋来说，在不同视图当中，是否显示及其显示方式是不同的，所以，为钢筋添加三个自定义属性TopView，SK-View,WholeView,这些自定义属性值为三位数abc,此三位数的每一位只能是0或者1，属性值的含义如表1所示。

表1钢筋自定义属性含义   

<html><body><table><tr><td></td><td>a</td><td>b</td><td>C</td></tr><tr><td>0</td><td>不显示</td><td>不标注</td><td>以点的方式显示</td></tr><tr><td>1</td><td>显示</td><td>标注</td><td>以线的方式显示</td></tr></table></body></html>

![](images/ec0c0f062a99558e78502b2bd18cd4f205dff28c3500a0f3c98a6f25b69db7e6.jpg)  
图5主体结构信息修改界面  
图6配筋信息修改界面  
图8Tekla创建的钢筋数量表

![](images/d0d93fc2a87eb722ce186ef526cc8d5f592c0fe3ab39bfc717d2df2fd8afc06f.jpg)  
图7局部钢筋模型

编号 规格 直径 形状示意 每楼长 数 总长） 单重（g 总重（kg）  
S1(2)-1 HRB400 22 然 福 14957 80 1196. 2.98 3570.61  
S4(2) HRB400 20 福 12898 240 3095 2.47 7646.05  
211 HR8400 2025 L 美 5704 8 4561 248 112675  
S22 HRB400 20 L 5 大 3802 80 304.1 2.47 751.31  
S1(1) HR8400 22 9 品 47564 40 1902. 2.98 5677.27  
S1(1)-2 HRB400 22 营 g7 山 47564 40 1902. 2.98 5677.27  
\$31 HR8400 20 H 13 一 15650 80 1251. 2.47 309242  
S31-1 HR8400 20 江 120 山 17750 80 1419. 2.47 3507.38  
S31-2 HRB400 20 r20 山 16650 80 1331. 2.47 3290.02  
S2(1) HRB400 22 L M J 39888 120 4786. 2.98 14283.2  
S2(2) HRB400 25 L 7 J 7980 40 319.2 3.85 1228.93  
S2(2)-1 HRB400 25 1 1 J 15980 40 639.2 3.85 2460.93

二维绘图程序对读取的混凝土、钢筋三维模型进行遍历，抽取包含自定义属性在内的所有有用信息，根据预设的对不同信息的不同处理方式，调用TEKLA绘图功能API,最终完成二维图纸绘制。三维模型中包含工程数量模板，二维绘图程序在生成结构图、钢筋图的同时还会根据工程数量模板自动生成包含有钢筋大样的数量表。

# 5框构倾斜导致的问题

# 5.2 问题描述

框构二维工程图包含四个部分：主体结构图，主体钢筋布置图，顶板钝角加强筋布置图和钢筋数量表。其中，主体钢筋布置图包含主体钢筋和钢筋骨架图，该部分图纸通过结构纵桥向平面的切割、投影得到。

2Tekla 软件在由三维模型生成二维工程图的过程中,需要首先确定视图深度,视图深度范围内的三维模型被投影到所需平面,作为生成二维图纸的原始数据，但是TEKLA有一个限制条件：投影平面必须与整体坐标系XYZ的三个自带平面平行,并且模型一旦投影到图纸上,只能修改显示方式、无法修改其在平面上的位置。对于下图所示的倾斜框构桥，其顺桥向的前后端边界与 $\mathbf { x }$ 轴存在夹角。

![](images/4f2303b70e8d5e3e048832e67ab927bcb076a8515c77920bee424ec9c8125db0.jpg)  
图9骨架钢筋布置

在这种情况下，如欲在一张图纸中同时反应从“骨架1"到"骨架4”的所有钢筋，就需要将各骨架钢筋均向 $\mathbf { x } = 0$ 平面投影。从而，由于框构的倾斜，x值不同的各骨架，其投影结果存在Y方向的错动，同时，各骨架钢筋与 $\mathbf { x } = 0$ 位置处混凝土结构边缘的相对位置关系也不准确。

即使仅生成某个骨架的钢筋布置图，依然会出现上述问题，以“骨架 $3 ^ { \cdot \cdot }$ 为例，应该将此骨架上的所有钢筋向 ${ \mathrm { x } } = 2 . 5 *$ space平面投影，再出二维图纸。如图10所示：

![](images/955519ca02dbcc00f2efbae3993246e5991e59743cd53782349a6b61d6c0f06e.jpg)  
图10骨架内钢筋布置示意

因为对于同一骨架的所有钢筋，为了避免碰撞，它们的 $\mathbf { \sigma } _ { \mathbf { X } }$ 值并不相同，此时如果仍然通过向骨架平面位置处投影来创建二维图纸，也会出现和多骨架钢筋图相似的问题。假如实际情况下骨架钢筋到两端结构线边缘的距离相等，即 $\mathrm { L } 1 = \mathrm { L } 2$ ,但是在投影至骨架平面后，到两端的距离会变成 $\mathrm { L } 3 > \mathrm { L } 4$ O如果某骨架钢筋到骨架平面的距离过大或者框构过于倾斜，会导致 $L 4 < 0$ ,也就是说,在这种条件下，某些竖向骨架钢筋会超出混凝土结构线的范围，该骨架钢筋将在二维图纸中消失。

# 5.2 解决方法

对于框构倾斜导致骨架钢筋沿Y方向偏离甚至消失这一问题，拟通过下述方法解决：建立两个三维模型,一个模型是直的,另一个是倾斜的。由于框构的倾斜不会对xy平面的二维图纸造成不利影响，并且倾斜框构中的钢筋长度是准确的，所以利用倾斜模型生成顶板钝角加强钢筋图及工程数量，利用直模型生成YZ平面的钢筋图。为了实现这一目的，需要在三维建模和二维出图程序中同时进行处理。

三维建模程序处理流程如图11所示。

在三维建模程序中，首先为混凝土主体结构添加自定义属性RecOption，程序根据框构倾斜角度进行判断，当倾角为0时，仅在原点位置生成一个直模型,令RecOption $= 1$ ；否则在原点位置生成倾斜模型,令RecOption $\mathbf { \varepsilon } = 0$ ,并在偏移点生成直模型，令RecOption $= 1$ 。

![](images/aa554ece88469d13f78a23378ef2aee457d159e8333a35493cf342163a1c1616.jpg)  
图11框构倾斜问题的三维建模程序处理流程

![](images/c6b291b1137be0982c0f0571fbb7f3532ca540c43bb998536c21e554f4c744c6.jpg)  
图12包含钢筋及主体结构的三孔框构模型

二维出图程序处理流程如图13所示。

三维建模程序生成的主体结构模型包含RecOption自定义属性，并通过.uel截面文件的第二个参数反应倾斜角Angle值，出图程序读取三维模型后，根据Angle和RecOption的不同组合做出不同的响应，流程如图13所示。

![](images/c3dd66a46c2398785cef01c70f74441ad210d2d236f35455e5550dac4912c6c7.jpg)  
图13框构倾斜问题的二维出图程序处理流程

用户在TEKLA窗口手动选择框构模型。出图程序读取主体结构梁单元的Angle值，当Angle $< >$ 0时，以读取的模型为基础生成顶板钝角加强筋图纸及工程量表。

当 $\mathrm { A n g l e } = 0$ 时，继续读取RecOption自定义属性,当RecOption $= 1$ 时,以读取的模型为基础生成主体钢筋布置图；当RecOption $< > 1$ 时，以读取的模型为基础生成所有图纸及工程量。

![](images/6861ab6a1cff2aac4eb030085afc1a821dfc61a070f4b9f1a845c2fe4d21131f.jpg)  
图14Tekla生成的主体钢筋布置

# 6结语

本文对一个框构桥BIM配筋设计程序的开发过程和思路进行了介绍，本程序通过C#语言读入FUBS框构桥配筋计算程序生成的文本文件，并开放交互界面，使用户根据个性化需求修改FUBS计算结果，最终，程序调用TEKLA开放的建模、绘图API接口，根据用户确定的结构尺寸和配筋结果，自动生成框构桥三维钢筋模型、生成二维工程图并统计工程数量。

为了解决框构倾斜导致的骨架钢筋沿Y方向偏离甚至消失的这一问题，同时对三维建模程序和二维出图程序进行了处理。三维建模程序根据倾斜角度的不同，生成不同数量的模型，并对模型的用户定义属性赋予不同数值；二维出图程序读入三维模型的倾斜角度和用户定义属性值，根据这些数值的不同做出不同的响应，从而能够创建准确的二维工程图。

# 参考文献

［1］陈振明，张耀林，黄冬平.Tekla Structure软件在CCTV主楼钢结构深化设计中的应用[J].施工技术，2008，37(8) : 73-74.  
［2］张磊．三维技术在拱桥方案设计中的应用实例[J].土木建筑工程信息技术，2012，4(4)：35-37.  
［3］中国铁路总公司．中国铁路总公司关于铁路工程建设信息化推进工作会议纪要.铁总办函［2013]309号.2013.  
［4］范重，王喆，谭成冬，等.扭曲箱形构件的空间坐标表示法［J].建筑结构学报，2007，28（2）：87-95.  
[5］齐成龙，冯沛，宋树峰，等.基于达索3D体验平台的预应力混凝土连续梁桥建模方法［J].铁道建筑，2015(10):64-69.  
［6］高剑，曹洁华,贺明玄.Tekla Structures的二次开发在工程中的应用[J].施工技术，2008(5)：166-167.  
[7］宋建军，程治，吴梦先，等.TeklaStructures与FastCAM软件在套料过程中的结合应用研究[J].钢结构，2016(9):111-114.

# Application of Secondary Development on Software Tekla Strucutres in Frame Bridge Design

Qi Chenglong

(Bridge Department，China Railway Design Corporation，Tianjin 3OO142，China）

Abstract:Both 3D modeling and 2D drawing play important roles in BIM application.To fully utilize the advantages of Tekla software in reinforced concrete structures’BIM modeling to enhance the eficiencyofframe bridge design，this paper introduces a frame bridge design instrument which is a secondary development productof Tekla with C#language.This instrument takes the text document of FUBS frame rebar calculation software as input data, and generates the 3D frame bridge reinforced concrete structure model and the 2D drawing along with engineering amount colection as results through the Tekla API interface.Meanwhile,this paper analyzes the develop flow and solutionscheme of some key points within this design instrument.Through practice test，it is proven efective and efcient to design a frame bridge with this instrument.The develop process and scheme can be used as a reference for similar engineering applications.

KeyWords:BIM；Tekla；Secondary Development；Frame Bridge；Rebar