# 玻色采样的行为模拟和其复杂度量化分析

张武荣，Ph.D. IEEE Senior Member

摘要：本文证明高斯玻色采样问题和矩阵积和式计算问题一样，仍然是指数复杂度问题。对于使用有限采样时钟频率的物理光学装置，即使采样到一个有效样本都是难以完成的任务。本文提出通过高斯玻色采样来证明量子计算优越性的新方案：该方案采用量子真随机数和大型计算机相结合，用量子真随机数实现量子的内禀随机性，并使用大型计算机完成采样状态模拟和判断，从而整体无差错实现高斯玻色采样问题，完成单纯经典超级计算机无法完成的计算任务，最终证明量子计算的优越性。本文提出的行为级模拟方案，可以使用伪随机数有效仿真玻色采样问题中的大概率事件，从而可以很方便地验证物理采样装置的有效性和正确性。

关键词：量子计算量子优越性高斯玻色采样 积和式计算行为模拟声明：本文为对科学问题的客观研究，不和任何政治，商业，和个人主观立场和利益发生冲突。该研究工作和结果，和作者过去和现在的任职公司无关。

# 1. 概述

图灵机是经典计算的理论基础[1]。扩展图灵理论(ECT:The Extended Church-Turing Thesis)认为，任何在可实现物理装置上完成的流程(Process)，都可以被概率图灵机仿真[2]。但是，量子计算的概念自上世纪80年代诞生以来，量子计算研究者一直希望能够用一个工程可实现的量子物理装置，完成经典计算机无法完成的任务，从而证明量子计算相对于经典计算的优势，从而挑战扩展图灵理论。用线性光学装置验证高斯玻色采样问题[3]，被认为是最有希望的技术路线。其实验装置原理如图1所示。

![](images/ee88a6108b1bd8bcce476316d156e7dfb65bb82fb5267fe30341f6e6328cc392.jpg)  
Figure1丨高斯玻色采样原理示意图。n个不可区分的光子(或者是小球)通过一个复杂的光路，随机落入n个可以区分的出口(或者是盒子)。采样实验的目的就是求出每个出口都有一个光子的状态的概率。在这种状态下，每个玻色子都可以区分，等效为费米子状态。

在高斯玻色采样问题中，求解等效费米子状态的概率实质是计算随机概率矩阵 $P$ 的积和式，并且它已经被证明是经典计算机无法有效计算的指数复杂度问题[4]，而文献[3]进一步证明对矩阵P的积和式的有限精度近似，也是指数复杂度问题。同时，计算复杂度理论也认为，量子物理的内禀随机性，无法用经典计算机有效模拟[5]。基于以上两点，用线性光学装置实现的高斯玻色采样装置，被普遍认为是无法用经典计算机有效模拟的系统，从而具有挑战扩展 ETC 理论的可能性，而最终的可行性需要实际系统来验证。高斯玻色采样问题[3]证明“量子优越性”的逻辑并不是显而易见的，它是隐式表达的：如果有一个维度的随机矩阵，对该矩阵的积和式的直接计算，包括一定精度的近似，都超越了经典计算机的能力，但是该矩阵的积和式的值，可以被一个量子光学装置采样模拟，而这个量子光学装置又不能被经典计算机模拟，从而在计算矩阵积和式这个问题上，量子光学装置就实现了量子优越性。本文认为该逻辑是严谨和严密的，并且目前还成立。不过，本文研究认为，这个量子光学装置应该用量子真随机数发生器结合一个大型计算机来替代。

实现文献[3]中提出的量子装置的首要挑战是噪声污染问题[6][7]。另外，在文献[3][6]都提到了对极小概率事件进行模拟时的可扩展性(Scalability）问题，但没有检索到有更深入和量化研究的相关文献。事实上，量子的内禀随机性才是高斯玻色采样方案[3]实现量子计算优越性最重要的复杂度来源，因为到目前为止，经典计算机实现的还都是“伪”随机。

根据文献[3]对玻色采样方案的描述和分析，整个玻色光学采样过程事实上是一个光量子蒙特卡洛模拟过程[3][8]，是服从经典概率理论[9]中弱大数定理的伯努利试验。实验装置对有效样本数的采集过程，就是逐渐逼近矩阵积和式的过程。如果采用量子力学的假设，我们也可以认为所有的玻色子状态，包括等效的费米子状态，都以量子叠加态的方式同时呈现在所有的出口。但从海量的叠加状态中，把等效的费米子状态挑选和识别出来，需要对叠加态测量导致叠加态塌缩，最终仍然是一个服从经典概率论的大数实验过程。从根本上，文献[3]中的方案依赖的是量子的内禀随机性，而不是通过量子叠加态来加速计算过程，因为对叠加态的操作目前还无法实现。无论是文献[3]还是本文，都不认为量子叠加态是目前证明量子计算优越性的途径，因为这条技术路线首先面临一个让人敬畏的哲学悖论：产生量子叠加态的假设是量子的随机性，而回答能否对叠加态样本空间有效解析，又是对随机性的否定。所以我们认为，目前用经典概率论来研究文献[3]所提出的高斯玻色采样问题是充分的，合适的。

本文将采用经典概率理论[9]来分析玻色光学采样装置的可扩展性。我们证明，对于玻色采样问题中随机概率矩阵 $P$ 的积和式，其均值随着矩阵的维数增加而快速指数下降。根据伯努利大数定理，对该概率分布采样所需要的样本数也会指数增加。对于使用有限采样频率的物理装置，即使采集到一个有效样本，都是一个指数复杂度问题。这是因为，经典采样时钟的频率有其物理极限，而所需样本数指数增加。

应该指出的是，文献[3][6]其实也意识到了样本数指数增长问题，但并没有定量的分析结果。同时我们也应该指出，有限的有效样本数的采集需要指数复杂度时间，和文献[3]的主要结论是吻合的：文献[3]的主要结论是，对矩阵 $P$ 的积和式有限精度的近似都是一个指数复杂度问题，而这个过程其实就是有效样本数采集过程。

更进一步，文献[3]并不期望通过量子叠加态来实现计算的加速。事实上，文献[3]的逻辑是依据量子器件独有的内禀随机性，实现一个光学物理装置，能够完成特定范围光子数的采样实验，而这个光子数对应的矩阵积和式无法用经典计算实现，从而证明量子的优越性。这个期望在10 年前文献[3]发表时可能是有意义的。但在文献[3]发表10 年后的今天，实际结果恰恰是相反的：在光子数超过 20之后，用光学装置完成高斯玻色采样就会非常困难，但小于50 维的矩阵积和式计算，目前对于经典计算机反而不是问题。

用物理光学器件实现的玻色采样装置非常容易受到噪声的干扰[6]。然而，如果把复杂的光学网络当作一个装在黑盒子里的系统来观察，其行为级特征很容易用经典计算机做无噪声模拟。如果经典计算机中的随机数采用“量子真随机[10]”来实现量子的“内禀”随机性，整个采样过程完全可以用经典计算机叠加量子真随数发生器来等效模拟。

同时，也有文献研究如何用用经典计算机仿真量子系统[11]，以及如何用经典计算机近似高斯玻色采样问题[12][13][14]。这启示我们，如果容忍由于伪随机而引入的误差，我们也可以用经典计算机来模拟高斯玻色采样过程中的大概率事件，而由非完全随机性引入的误差，可能要远远小于物理光网络中所引入的噪声和受到的干扰，其仿真结果可以用来校对和验证物理光网络[15]的实验结果和性能。另外，如果用量子真随机数发生器，和大型计算机结合来模拟高斯采样问题，可以完成经典超级计算机不能完成的任务，从而验证量子计算针对经典计算的优越性。但这要求“量子真随机性”能够得到验证，并且有足够的扩展性来满足超级计算机的采样速度。

全文如下组织：第一部分总结玻色采样中的关键问题和本文的关键工作；第二部分为系统模型；第三部分用经典概率理论分析玻色采样所需要的样本数；第四部分介绍玻色采样问题的行为级模拟，并提出了一种挑战扩展图灵理论的玻色采样新方案；第五部分介绍如何用经典仿真在一定容差范围内，来验证玻色采样的物理实验结果；第六部分为全文结论。

# 二 系统模型

本章节建立描述玻色采样实验中公式和符号。如Figure1所示，玻色采样实验中的随机转移矩阵

用 $P$ 来表示：

$$
P = ( p _ { i j } ) _ { i , j \in [ n ] } = { \binom { p _ { 1 1 } } { \vdots } } \quad \cdots \quad { p _ { 1 n } } \\ { p _ { n 1 } } \quad \cdots \quad p _ { n n } ] \in R ^ { n \times n } , 0 \leq p _ { i j } \leq 1
$$

矩阵的第i行中的元素 $p _ { i j }$ ，代表第i个光子落入第j个检测器的概率，每行元素的和为1。

$$
\begin{array}{c} \overbrace { \underbrace { \sum _ { j = 1 } ^ { n } p _ { i j } = 1 } _ { \begin{array} { l } { | p _ { i 1 } \mod | p _ { i 2 } } \end{array} } } ^ { \boldsymbol { n } } \underbrace { 1 \overbrace { \sum _ { j = 1 } ^ { n } | p _ { i j } | } ^ { \boldsymbol { n } } = 1 } _ { \begin{array} { l } { | p _ { i j } \mod | p _ { i 1 } } \end{array} }  \end{array}
$$

Figure2丨第i个光子落入不同检测器的概率示意图。线段的长度代表单次实验时落入不同检测器的倾向性大小。但它们的长期平均应该是相等的。

这里 $p _ { i j }$ 是随机变量。它们都具有相同的分布，代表光子以无差别的倾向性随机落入不同的位置，所以它们存在相同的分布和均值：

$$
\begin{array} { r } { E \left( p _ { i j } \right) = \frac { 1 } { n } } \end{array}
$$

值得注意的是，由于有 Figure2所示的归一化约束条件，同一行 $n$ 个元素 $p _ { i j }$ 之间并不一定独立。根据[3]中的假设和玻色子的物理性质，不同的光子之间是相互独立性，因而对于不在同一行的元素 $p _ { i j }$ 之间，它们是相互独立的。独立随机变量的均值符合如下关系[9]:

$$
E \left( p _ { i j } \cdot p _ { m n } \right) = E \left( p _ { i j } \right) \cdot E ( p _ { m n } ) , i \neq m
$$

如前所述，所有 $\overset { \cdot } { n }$ 个检测器都检测到光子的概率为矩阵 $P$ 的积和式：

$$
P e r m ( P ) = \sum _ { \delta \in S _ { n } } \prod _ { i = 1 } ^ { n } p _ { i , \delta ( i ) }
$$

其中， $S _ { n }$ 是 $n$ 个整数的全排列集合，共有 $\therefore$ 个元素。 $S _ { n }$ 集合随着 $n$ 的增加而指数增长，是积和式计算的指数复杂度根源。

由于有Figure2所示的归一化限制，我们讨论如何构造随机概率矩阵 $P$ 。我们首先生成一个随机矩阵 $\left( r _ { i j } \right) \in R ^ { n \times n }$ ，矩阵中所有的元素 $\cdot r _ { i j }$ 独立同分布，并且它们的均值为 $\begin{array} { r } { E \left( r _ { i j } \right) = \frac { 1 } { n } } \end{array}$ ，对于每一行中的元素作如下归一化处理：

$$
p _ { i j } = \frac { r _ { i j } } { \sum _ { j = 1 } ^ { n } r _ { i j } }
$$

根据(5)生成的 $p _ { i j }$ 仍然满足(2)和(3)的约束条件，但 $p _ { i j }$ 的概率分布和 $\dot { \boldsymbol { r } } _ { i j }$ 会不同。随着 $\cdot _ { n }$ 的增加， $p _ { i j }$ 的概率分布和 $\dot { \boldsymbol { r } } _ { i j }$ 的概率分布函数会逐渐趋同。但由于本文的结论和随机变量的具体分布没有关系，我们没有必要进一步讨论 $p _ { i j }$ 或者 $\cdot r _ { i j }$ 的具体分布和变化。

有必要指出的是，随机变量的归一化处理有多种形式，而公式(5)只是其中的一种。在二维矩阵情况下，公式(5)等效为在一条直线上随机取了两个点。我们当然也可以在一个圆上或者球面上随机取点，但由于本文的结论和具体的分布函数没有关系，在此不再详细讨论。

# 三． 玻色采样所需样本数随矩阵维度指数增加

随机矩阵的积和式 $P e r m ( P )$ 也是随机变量。用经典计算机直接计算 $P e r m ( P )$ 是指数复杂度问题，但它的均值却可以根据经典概率理论严格计算。跟据随机变量和的均值等于均值的和[9]:

$$
E { \big ( } P e r m ( P ) { \big ) } = \sum _ { \delta \in S _ { n } } E \left( \prod _ { i = 1 } ^ { n } p _ { i , \delta ( i ) } \right)
$$

更进一步，由于P矩阵中不同列的随机变量相互独立，根据公式(2)和(3):

$$
E { \big ( } P e r m ( P ) { \big ) } = \sum _ { \delta \in S _ { n } } \prod _ { i = 1 } ^ { n } E { \big ( } p _ { i , \delta ( i ) } { \big ) } = \prod _ { i = 1 } ^ { n } { \frac { i } { n } } 
$$

从公式(6)可以发现，随机矩阵的积和式的均值是随着 $n$ 的增加而快速指数下降，其趋势如Figure4所示。公式(6)的结论和随机变量的具体分布函数没有关系。Figure3比较了在正态和均匀两种分布。可以发现，实际计算值和根据公式(6)的理论值完全一致。

![](images/5b4b3bf1c435859827c109b0373893ef4e0bcfd9c5071c4bb1c28c2160c72f30.jpg)  
Figure 3丨随机矩阵积和式均值的理论值和计算仿真值比较。按照公式(5)，对从2维到9维的每一维矩阵，生成 200个随机矩阵样本，分别计算2000个随机矩阵的积和式，然后对2000个矩阵积和式样本求均值。左图为均匀分布，右图为正态分布。理论值(6和计算仿真值完全吻合。

根据大数定理[9]，实验所需要的有效样本事件的个数和事件概率之间为倒数关系，它们之间的关系如 Figure4左右两图所示。文献[15]介绍了名为“九章”的高斯玻色采样光学装置，其中的关键参数之一是其 250kHz 的采样速率。如果我们设置一个最小有效样本数要求(等效为一个近似误差门限),比如 10000，则 Figure 5显示了用“九章”完成有效样本采样的时间成本。可以看出，即使在有限精度下，用目前的“九章”完成一个25光子的玻色采样都是一个几乎不可能的事情，而25 维的矩阵积和式计算，在大型计算机上的耗时会小于秒级[16]。

很明显，文献[3]提出的高斯玻色光学采样方案对于使用经典有限采样时钟频率的装置，仍然是指数复杂度问题。这是因为，指数级提高这类时钟系统的频率是不可能的。另外，随着时钟频率的提升，对光学通道的路径误差的要求就需要等比例降低，实际实现会非常困难。同时，时钟频率的上限由光源的相干时间上限决定，也不可能无限制增加。这类参数的具体数值计算并不复杂，本文不再赘述。

我们将在剩余的章节介绍和讨论实现高斯玻色采样的新方案，即，用量子真随机数结合超级计算机，实现高斯玻色采样，完成经典计算机无法完成的任务。

![](images/57d49a88ae965bbdb1126188abc54134bc3fc504203e8d9c8791c516453c77df.jpg)

![](images/25f017936f9a65693762196f8daf30244479b4e2a0172cbe19445c364659c6b2.jpg)  
Figure 4丨随机矩阵积和式均值和实验所需样本数的关系。左图显示根据理论公式(6)计算的积和式均值。右图为所需的样本数，假定所需的最小有效样本事件为10000。  
Figure5丨用不同方式计算和仿真随机矩阵积和式所需时间成本比较。关于用Laptop笔记本电脑(CPU：Intel COREi7 $1 0 ^ { 2 1 1 } )$ 进行仿真和计算的时间成本标定，请见附录。虽然直接计算和采样都是指数级复杂度，但采样的复杂度和直接计算的复杂度相比，有指数级的下降。

# 四. 玻色采样问题的行为模拟和等效

# 4.1玻色光学采样装置的行为级等效模拟

对于玻色采样光学物理装置，一个光子需要通过一个复杂并且容易受干扰的物理光路，最后以一定的概率从某一个出口被检测到。如果我们把物理实现的细节装入一个黑盒子，仅观察和问题相关的入口和出口关系，整个光路完全可以用Figure6的右图来做行为级模拟。如果使用的随机数是“真”随机数，则行为级模拟和无噪声的物理实现是完全等效的。

关于随机性对采样结果的定量影响分析，已经超出了本文的研究范围。我们猜想，和伪随机相比，“真”随机实验可以无限逼近真值，而采用伪随机数的实验结果，会和真值之间存在一个恒定的误差门限。具体特征需要进一步的研究。

为了初步判断伪随机性对采样实验结果的影响，Figure8比较了一个采用“真”随机[17]和伪随机数的仿真模拟结果。可以看出，采用伪随机数获得的结果，其差别和“真”随机数获得的结果无法区分。在工程和科学研究领域，采用伪随机数对大概率事件的模拟是非常普遍的做法。由于篇幅和时间限制，本章节对随机性影响的定量分析是初步的，还需要进一步的研究。

![](images/ab2cc9e506b7855090777a5f5a7f3c8d1b7a55241338645c127f653228e71d76.jpg)

Figure6丨物理光学装置的行为级模拟。如果把左图的物理装置看作一个黑盒子，其行为可以用右图的过程等效模拟。对于某一个光子，可以先产生一个“真”随机数，服从均匀分布。这个真随机数和对应的概率区间相比对，如果落入某个区间，就认为光子从对应的检测器被检测到。如果随机数是完全随机的，则左右两个图是等效的。

![](images/04c28ae10d7e7fb41bfabe7653a07432e5ab7cda2fbc0477976c4dca18d75232.jpg)

Figure7丨行为级模拟实验去逼近 $2 \times 2$ 和 $8 \times 8$ 随机矩阵的积和式计算。左上和右上是用行为级模拟实验的方法分别去逼近一个 $2 \times 2$ 和 $^ { 8 \times 8 }$ 随机矩阵的积和式，实验中采用伪随机数。可以看出，行为级模拟实验可以很好地逼近随机矩阵积和式的真值。左下和右下是对应的绝对误差。我们猜想，采用伪随机数的实验结果会和真值之间存在一个恒定的误差门限。但如果采用真随机数，实验结果会随着有效样本而

不断增加熵值，从而逐渐接近真值。

![](images/d63e9f37062791130d55d8f89e1da345188e8571aacc04b2844e16319d27774d.jpg)  
Figure8丨采用“真”随机数和伪随机数的结果比较比较。为了对比随机性对仿真结果的影响，我们从[17]下载了40000个“真”随机数，同时用Matlab 的伪随机数，对同一个 $2 \times 2$ 随机矩阵的积和式采样。在本次实验中，伪随机数和“真”随机的实验结果差别很难。

# 4.2证明量子优越性的替代实现方案

随着经典计算能力的提升，以经典时钟为采样频率的光学装置是无法挑战扩展图灵理论的。但是，文献[3]中实现量子优越性的主要逻辑目前仍然成立，因为作为量子优越性的一部分，量子的内禀随机性理论上仍然无法用经典计算实现。但是，需要一种装置，能够在有限时间内，对海量的采样样本完成状态判断。

这个装置就是一个比超级计算机有指数规模缩小的大型计算机。从图5可以看出，虽然直接计算和采样都是指数级复杂度，但采样的复杂度和直接计算的复杂度相比，有指数级的下降。这说明，用于采样模拟的经典计算机，比直接结算所需要的经典超级计算机，有指数规模的缩小。

Figure 6 中的方案，是用量子真随机数发生器和大型计算机结合来模拟高斯采样问题。如果把样本状态判断部分用经典大型计算机来实现，而随机数的发生采用量子真随机数，可以完成经典计算机不可能完成的任务，从而验证量子计算针对经典计算的优越性。这要求“量子真随机性”能够得到验证，并且有足够的扩展性来满足大型计算机的采样速度，这是非常值得研究的领域。本文附录中的时间成本标定可以作为设计参考。

# 五．玻色采样实验的经典仿真验证

第三节的分析结果告诉我们，在玻色采样实验中，把等效费米子状态的概率计算出来，堪比大海捞

针，是个概率极小的事件。如果把矩阵的积和式作为最终验证目标，玻色光学装置的有效性可能是无法验证的，因为这个矩阵的积和式的真值本身就无法计算。但是，采样实验中有一些大概率事件是可以统计的，比如所有检测到光子的通道数，如文献[15]中 Fig 3.C 和Fig 3.E中所示。

使用普通桌面电脑对这类大概率做行为级模拟，也是非常容易的。用行为模拟的结果和物理装置的测试结果做比对，就可以验证实验装置的有效性。

从Figure8可以看出，对于大概率事件的模拟，采用伪随机数和采用“真”随机的结果差别不大，采用伪随机数也是工程和科学研究中的普遍做法。从Figure9和Figure 10的结果对比可以看出，文献[15]的实验中存在大量的光子丢失。

![](images/6ef29f1750a45b30c51a71d0d84d094f221e6507bdaceae7e3312ee768b1cadc.jpg)  
Figure9丨检测到光子的通道数分布仿真。我们用伪随机数模拟[15]中的Fig.3(C)。右图从[15]中复制。左图为伪随机数模拟结果，由于使用笔记本仿真的时间成本的原因，总仿真样本为11500000。右图从[15]中复制而来，总采样样本为 5000000。比较两个图，完全有理由相信，在[15]的采样实验中，大量的光子在光学通道里丢失了。

![](images/e9133270c14bf9463fc4897113df40365cc4aaa29891f35d32559045ae4e8ca4.jpg)  
Figure10丨检测到光子的通道数的概率密度。我们用伪随机数模拟[15]中的Fig.3(E)。右图从[15]中复制。我们用有效计数的批次和总实验批次的比率作为概率分布密度。随机矩阵的维数总 $1 0 \times 1 0$ 到

$1 0 0 \times 1 0 0$ 。模拟实验中不会有噪声，干扰，和光子丢失，但是会由于伪随机而引入的可忽略误差。模拟实验结果，可能说明大量的光子在[15]中的实验丢失了。我们同时发现，这类大概率事件的仿真，和随机矩阵的

# 六．讨论和结论

文献[3]提出通过光学装置实现高斯玻色采样，从而证明量子计算的优越性。证明量子计算优越性的逻辑是：依据量子器件独有的内禀随机性，实现一个光学物理装置，能够完成特定范围光子数的玻色采样实验，而这个光子数对应的矩阵积和式无法用经典计算实现，从而证明了量子计算的优越性。

本文证明，高斯玻色光学采样问题对于使用经典有限采样时钟频率的光学装置[15]，是难以完成的指数复杂度问题。具体来说，用[15]完成一个25光子的玻色采样都几乎是不可能的事情，但在方案[3]发表后10年的今天，在超级经典计算机上计算小于50 维矩阵的积和式已经不是问题。

本文提出可以用行为级模拟来等效玻色采样问题，而行为级模拟技术也可以很方便地验证物理装置的有效性和正确性。最重要的是，由于文献[3]证明量子优越性的逻辑目前仍然成立，本文提出实现高斯玻色采样问题以证明量子优越性的新方案，即：采用量子“真”随机数和大型计算机相结合的方案，用量子“真”随机数实现量子的内禀随机性，用大型计算机完成玻色实验中的状态判断，从而完成单纯经典计算机无法完成的计算任务，实现量子优越性。

致谢：作者感谢[15]的通信作者之一，陆朝阳博士在本文开始之前，给作者转发的文献[3]的全文版本。同时非常感谢作者的前同事和朋友对本研究工作的关注和鼓励，包括杨学志博士，梁志科先生，陈光日先生。作者在完成了本文的过程中，得到了他们的鼓励。特别是杨学志博士，他敏锐地注意到了本人提出的行为级模拟的价值，并积极在社交媒体上公开和宣传。同时感谢一些量子计算爱好者，对本人发表在“科技观察与评论”微信公众号上的文章的关注。这个研究中有两位贡献者还是在校大学本科生。由于该话题的敏感性，他们选择匿名。

# 参考文献

1.A.M.Turing, On computable numbers, with an application to the Entscheidungsproblem, Proceedings of the London Mathematical Society,2, 42, pp. 230-65, doi:10.1112/plms/s2-42.1.230,1937.   
2. E. Bernstein,U. Vazirani, Quantum complexity theory, in Proceedings of the 25th Annual ACM Symposium on Theory of Computing, 1993.   
3． Scott Aaronson, Alex Arkhipov, The computational complexity of linear optics,Proceedings of the 43rd Annual ACM Symposium on Theory of Computing, 2011.   
4.Leslie G. Valiant, The complexity of computing the permanent, Theoretical Computer Science,8(2):189 - 201,1979.   
5.Michael J. Bremner, Richard Jozsa,and Dan J. Shepherd, Classical simulation of commuting quantum computations implies collapse of the polynomial hierarchy，Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences 467, 459 (2011).   
6.Gil Kalai and Guy Kindler, Gaussian Noise Sensitivity and Boson Sampling, Computer Science, 2014.   
7. C. Gogolin, M. Kliesch,L. Aolita,and J. Eisert. Boson-Sampling in the light of sample complexity. arXiv:1306.3995, 2013.   
8. Nicholas Metropolis,S.Ulam,The Monte Carlo Method, Journal of the American Statistical Association, Vol. 44, No. 247, pp.335-341. Sep. 1949.   
9. Athanasios Papoulis,and S. Unnikrishna Pillai, Probability, Random Variables and Stochastic Processes.   
10. Yang Liu,Qi Zhao, Ming-Han Li, Jian-Yu Guan, Yanbao Zhang, Bing Bai, Weijun Zhang, Wen-Zhao Liu, Cheng Wu, Xiao Yuan, Hao Li, W. J. Munro, Zhen Wang,Lixing You, Jun Zhang, Xiongfeng Ma, Jingyun Fan, Qiang Zhang, and Jian-Wei Pan, Device-independent quantum random-number generation. Nature, 562(7728), 2018.   
11.Leslie G. Valiant, Quantum computers that can be simulated classically in polynomial time, In Proceedings of the thirty-third annual ACM symposium on Theory of computing (STOC'01),Association for Computing Machinery, New York, NY, USA,114-123,2001. DOI: https://doi.org/10.1145/380752.380785   
12.Haoyu Qi, DanielJ.Brod,Nicolas Quesada,Raul Garcia-Patrón,Regimes ofclassical simulability for noisy Gaussian boson sampling, arXiv:1905.12075v2   
13.Lior Eldar, Saeed Mehraban, Approximating the Permanent of a Random Matrix with Vanishing Mean, IEEE 59th Annual Symposium on Foundations of Computer Science, 2018   
14. Alan Frieze and Mark Jerum, An analysis of a Monte Carlo algorithm for estimating the permanent, Combinatorica 15,67-83,1995. htps://doi.0rg/10.1007/BF01294460   
15.Han-Sen Zhong,Hui Wang,Yu-Hao Deng,Ming-Cheng Chen,Li-Chao Peng,Yi-Han Luo,Jian Qin,Dian Wu, Xing Ding, Yi Hu,Peng Hu, Xiao-Yan Yang, Wei-Jun Zhang, Hao Li, Yuxuan Li, Xiao Jiang,Lin Gan, Guangwen Yang,Lixing You, Zhen Wang, Li Li, Nai-Le Liu, Chao-Yang Lu, Jian-Wei Pan, Quantum computational advantage using photons, Science 370,1460-1463 (2020) 18 December 2020.   
16. Junjie Wu, Yong Liu, Baida Zhang, Xianmin Jin, Yang Wang, Huiquan Wang, and Xuejun Yang, A benchmark test ofboson sampling on Tianhe-2 supercomputer,National Science Review 5: 715-720,2018.   
17. An allged “true" randomness generator based on atmosphere noise: htp://www.random.org

18.

# 附录：计算和仿真速度标定

本文中的仿真使用的是一个 Lenovo X13 笔记本电脑，其CPU 为 Intel COREi7 ${ 1 0 } ^ { \mathfrak { t h } }$ 。使用的软件为开源 GNU Octave 6.2.0，绝大部分功能和Matlab 类似。开源 GNU Octave 在仿真的时候，只使用 CPU

的一个核，没有GPU加速。

![](images/6c15abf743f4e94928165246bbae06825a4efca17f14a37b056ee323eae93ca8.jpg)  
FigureS1丨笔记本电脑每秒可以仿真的随机矩阵个数。该曲线为实际测试测试性能。

![](images/7eba65f917674c532dff57fce999c196e890e7ebe255bbcde9bd9510a6d54883.jpg)  
Figure S2丨分别用笔记本电脑和“九章”仿真的时间。用总样本数除以每秒可以以处理的样本数。其中“九章”每秒可以处理的样本数为 $2 5 0 \mathsf { k }$ 。

Calculation Time Costs UsingLaptop (Intel COREi710th) !rrrm 二 433 RealCalculation 里 1 1 Extrapolation 3029282726 25 1111111115 T 24 ee ei) giiligelnei 2322 二 1x1 < 05 814 中 1 1 中 00 L 1 6654 03 （ 02 （ 0 （ 02 11111111111111110111111111111111 03 0 44567880 0 111114 00 09 0 5 10 15 20 25 30 35 40 45 50 55 Dimension of the Random Matrix (X)