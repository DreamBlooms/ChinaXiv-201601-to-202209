# Precipitation forecasting by large-scale climate indices and machine learning techniques

Mehdi GHOLAMI ROSTAM, Seyyed Javad SADATINEJAD, Arash MALEKIAN\*

UniversityofTehran,Tehran1417466191,Iran

Abstract: Global warming is one of the most complicated challenges of our time causing considerable tension on our societies and on the environment. The impacts of global warming are felt unprecedentedly in a wide variety of ways from shifting weather patterns that threatens food production,to rising sea levels that deteriorates the risk of catastrophic flooding. Among allaspects related to global warming, there is a growing concern on water resource management. This field is targeted at preventing future water crisis threatening human beings. The very first stage in such management is to recognize the prospective climate parameters influencing the future water resource conditions. Numerous prediction models, methods and tools, in this case,have been developed and applied so far. In line with trend,the current study intends to compare three optimization algorithms on the platform of a multilayer perceptron (MLP) network to explore any meaningful connection between large-scale climate indices (LSCIs) and precipitation in the capital of Iran,a country which is located in an arid and semi-arid region and suffers from severe water scarcity caused by mismanagement over years and intensified by global warming. This situation has propelled a great deal of population to immigrate towards more developed cities within the country especially towards Tehran. Therefore, the current and future environmental conditions of this city especially its water supply conditions are of great importance. To tackle this complication an outlook for the future precipitation should be provided and appropriate forecasting trajectories compatible with this region's characteristics should be developed. To this end, the present study investigates three training methods namely backpropagation (BP), genetic algorithms (GAs), and particle swarm optimization (PSO) algorithms on a MLP platform. Two frameworks distinguished by their input compositions are denoted in this study: Concurrent Model Framework (CMF) and Integrated Model Framework (IMF). Through these two frameworks,13 cases are generated: 12 cases within CMF, each of which contains all selected LSCIs in the same lead-times,and one case within IMF that is constituted from the combination of the most correlated LSCIs with Tehran precipitation in each lead-time. Following the evaluation of all model performances through related statistical tests, Taylor diagram is implemented to make comparison among the final selected models in al three optimization algorithms,the best of which is found to be MLP-PSO in IMF.

Keywords: backpropagation; genetic algorithms; machine learning; multilayer perceptron; particle swarm optimization; Taylor diagram

# 1 Introduction

There is a growing concentration on sustainable development in water resource management. This field is targeted at preventing future water crisis threatening human beings. The very first stage in such management is to recognize the prospective climate parameters influencing the future water resource conditions. Numerous prediction models, methods and tools, in this case, have been developed and applied so far. Indeed, it is well known within the climate science literature that the teleconnection, which is a valuable context in climatology, has the considerable ability to justify and project climate parameters (Araghinejad and Meidani, 2013).

Teleconnection considers a distant phenomenon to study on regional climate conditions. As these large-scale climate phenomena are repetitive, they are categorized as paterns (Pozo et al., 2005),which can be effective both locally and globally and create much variability in climate parameters. Furthermore, they can result in drought and wet periods worldwide by changing precipitation trends (Hidalgo and Dracup, 2O03; Zahraei and Karamouz, 2O04; Kampichler et al., 2012; Choubin et al., 2014; Ouyang et al., 2014; Degefu and Bewket, 2017; Xu et al., 2018). Many definitions have been suggested for these patterns,which the main one identifies the teleconnection as a large-scale atmospheric-oceanic pattern, which is constant, repetitive and large-scale oscillated in some parameters, such as pressure (Wallace and Gutzler, 1981). For instance, El Nino, large-scale oceanic warming in the tropical Pacific Ocean, occurs repetitively every few years (Bjerknes， 1969). Its accompanying atmospheric component, Southern Oscillation, is the principal mode of pressure variability in the tropics, which affects the climate of many regions worldwide (Allan et al., 1996). The connections between the stated patterns and the climate parameters throughout different regions have been observed in many studies, e.g., Tyson (1987), Oldenberg et al. (2000), Gong and Ho (2003), Pozo-Vazquez et al. (2005), Canon (2007),and Gaughan and Waylen (2012). A well-known pattern is North Atlantic Oscillation (NAO), that in winter its station-based index is the climate variability mode in North Atlantic Ocean and is defined as the difference in normalized mean winter (December to March of the next year) sea level pressure (SLP) anomalies between Iceland and Portugal (Hurrell,1995). Most modern NAO indices, however, are according to the simple difference in surface pressure anomalies between various northern and southern locations as well as Gibraltar and Reykjavik sites (Jones et al., 1997; Brandimarte et al., 2011). It is proved that this pattern has a strong impact on winter precipitation in Hungary (Matyasovszky, 2OO3), Turkey (Karabok et al., 2005) and Mediterranean precipitation trend (Santos et al., 2O05). Indian Ocean Dipole (IOD), a coupled ocean-atmosphere phenomenon, is the other remarkable pattrn defined in 1999 as a dipole pattern of sea surface temperature (SST) variability in the tropical Indian Ocean (Saji et al., 1999). Anomalous cooling of SST in the southeastern equatorial Indian Ocean and anomalous warming of SST in the western equatorial Indian Ocean normally characterize this pattern (Nigam et al.,1993). In the Mediterranean region, Eastern Mediterranean Pattern (EMP), related to the $5 0 0 \ \mathrm { h P a }$ geopotential height between its east and west sides, is quite dominant (Hatzaki et al., 2007).

The connections of these and many other such patterns with climate parameters have been considered in numerous studies in which the methods, especially recent ones, derived from machine learning approaches. The slight difference between machine learning and statistical trajectories is their main points of concentrations, which in statistical methods are more on testing hypotheses, whereas in machine learning ones are more on formulating the process of generalization as a search through possible hypotheses (Wittn and Frank, 2OO5). Furthermore, machine learning focuses more on a prediction based on known features learned from exposure to datasets over the process known as training (Abbot et al., 2O18). In Iran, few studies,accordingly, put their emphases on using such approaches in the area of large-scale climate indices (LSCIs), e.g., Ashrafi et al. (2012) and Choubin et al. (2014).

Iran, located in an arid and semi-arid region, suffers from severe water scarcity caused by mismanagement over years and intensified by climate change (Ghazal et al.， 2O14), which, consequently, has propelled a large number of population to immigrate towards more developed cities especially in Tehran province. Sharp population growth in this province over recent years, is an apparent evidence of this fast-growing immigration. According to Statistical Center of Iran (2018) in the last 1O years, the population of Tehran province has increased from less than one million to over 15 million, which means this province, however, covering just $2 \%$ of entire Iran area, hosts $20 \%$ of country's population, of which $8 6 . 5 \%$ of the population resides in urban areas, particularly, in Tehran metropolitan, with about 8 million inhabitants. Providing water supplies among all other environmental issues in this metropolitan is of great concern. To tackle this complication an outlook for the future precipitation should be provided and appropriate forecasting trajectories compatible with this region's characteristics should be developed. To this end, this paper aims to compare the prediction capability of LSCIs by focusing on over 39 patterns and putting the emphasis on the application of three optimization algorithms in the multilayer perceptron network.

# 2 Datasets

Tehran metropolitan, facing Alborz mountain range to one side and the Iran central desert to another, varies in the term of elevation from the north to south ( $9 0 0 \mathrm { ~ m ~ }$ a.s.l. in average); this significant difference causes a pronounced influence on the variability of precipitation over the city. As a whole, Tehran is a semi-arid city with mean annual precipitation of $2 3 0 ~ \mathrm { m m }$ . Among numerous synoptic stations over this city, the oldest one is Meharabad $( 3 5 . 6 9 ^ { \circ } \mathrm { N } $ ， $5 1 . 3 1 ^ { \circ } \mathrm { E }$ ： $1 1 9 1 \mathrm { ~ m ~ }$ a.s.l.), which has the longest climate records since 1951. The monthly precipitation of this station for a 62-a period (1951-2012) was obtained from the IMO (Iran Meteorological Organization). Those teleconnection patterns that had the most qualified datasets and have been suggested in previous papers for the case-study region (e.g.， Abdi and Williams, 201O; Ashrafi et al., 2012; Araghinejad and Meidani, 2013； Choubin et al.， 2014; Arvin， 2015; Gerkaninezhad and Bazrafshan， 2018)， were obtained (Table 1） from National Oceanic and Atmospheric Administration (2015) for the period 1951-2012.

Table 1 Initial large-scale climate indices (National Oceanic and Atmospheric Administration (2015)   

<html><body><table><tr><td>Row</td><td>Index</td><td>Row</td><td>Index</td></tr><tr><td>1</td><td>The Pacific/North American Pattern (PNA)</td><td>19</td><td>Arctic Oscillation (AO)</td></tr><tr><td>2</td><td>North Atlantic Oscillation (NAO)</td><td>20</td><td>Antarctic Oscillation (AAO)</td></tr><tr><td>3</td><td>West Pacific Pattern (WP)</td><td>21</td><td>Southern Oscillation Index (SOI)</td></tr><tr><td>4</td><td>North Pacific Pattern (NP)</td><td>22</td><td>Central Indian Precipitation</td></tr><tr><td>5</td><td>East Pacific Pattern (EP)</td><td>23</td><td>Northeast Brazil Rainfall Anomaly</td></tr><tr><td>6</td><td>Pacific Decadal Oscillation (PDO)</td><td>24</td><td>Tropical Northern Atlantic (TNA)</td></tr><tr><td>7</td><td>Eastern Pacific Oscillation (EPO)</td><td>25</td><td>Tropical Southern Atlantic (TSA)</td></tr><tr><td>8</td><td>North Oscillation Index (NOI)</td><td>26</td><td>Atlantic Meridional Mode (AMM)</td></tr><tr><td>9</td><td>El Nino - Southern Oscillation (ENSO)</td><td>27</td><td>Atlantic Multi-decadal Oscillation (AMO)</td></tr><tr><td>10</td><td>Multivariate ENSO Index (MEI)</td><td>28</td><td>Western HemisphereWarm Pool (WHWP)</td></tr><tr><td>11</td><td>Extreme Eastern Tropical Pacific SST (Nino 1+2)</td><td>29</td><td>North Tropical Atlantic SST Index (NTA)</td></tr><tr><td>12</td><td>Central Tropical Pacific SST (Nino 4)</td><td>30</td><td>Oceanic NINO Index (ONI)</td></tr><tr><td>13</td><td>East Central Tropical Pacific SST(Nino 3.4)</td><td>31</td><td>Trans Nino Index (TNI)</td></tr><tr><td>14</td><td>Sahel Standardized Rainfall</td><td>32</td><td>Pacific Warm pool (PWP)</td></tr><tr><td>15</td><td>Eastern Asia/Western Russia (EA/WR)</td><td>33</td><td>Indian Ocean Dipole (IOD)</td></tr><tr><td>16</td><td>Caribbean Index (CAR)</td><td>34</td><td>Solar Flux</td></tr><tr><td>17</td><td>Bivariate ENSO Time series (BEST)</td><td>35</td><td> Monthly totals Atlantic hurricanes and named tropical storms</td></tr><tr><td>18</td><td>Quasi-Biennial Oscillation (QBO)</td><td>36</td><td>North Sea-Caspian Pattern (NCP)</td></tr></table></body></html>

# 3 Methodology

The schematic diagram of the entire study trajectory is shown in Figure 1. As shown, this study consisted of four main steps. The first of was data collecting and choosing the most appropriate LSCIs, followed by stating the main two frameworks (i.e., Concurrent Model Framework (CMF), and Integrated Model Framework (IMF). Pearson correlation, then, was used to define the most correlated LSCIs in each time lag before having the IMF. The third step was generating the three modelling methods， i.e.， BP-based (backpropagation-based) MLP (multilayer perceptron), GA-based (genetic algorithm-based) MLP and PSO-based (particle swarm optimization-based) MLP. In the end, the most appropriate case was introduced by the Taylor diagram.

![](images/fb5e4932fda27e421ac770c4e2d2b2e5594eca204f9b79e61e9bef4021a0e37e.jpg)  
Fig.1Schematic study trajectory diagram. As can be seen,after providing the inputs of two frameworks (i.e, concurrent model framework and integrated model framework),thremethods,namely,backpropagation-based (BP-based） multilayer perceptron (MLP)， genetic algorithm-based (GA-based) MLP and particle swarm optimization-based (PSO-based) MLP were targeted.

# 3.1 Principal component analysis (PCA)

The idea of PCA is to reduce the dimensions in a dataset in which there are a large number of interrelated variables (Pasini, 2O17). PCA is a useful tool to investigate simultaneously correlations between a large number of parameters, for finding subsets in data and defining outliers. Linear combinations of the principal components can be applied to reproduce parameters characterizing objects in the dataset (Abdi and Wiliams, 2O1O). In the present study, several LSCIs (i.e., 36 ones) were entered into the PCA process to be reduced. As the first step, the correlation matrix was preferred rather than the covariance matrix since its application is more common than that of the covariance matrix (Joliffe, 2OO2). The most controversial part of PCA is to define the optimized number of principal components (PCs) preventing serious loss of information. Among all different criteria and algorithms for choosing the PC numbers, the commonly used Kaiser's rule (Kaiser, 196O)，which suggests retaining only those principal components whose variances exceed 1, was applied. After implementing the varimax rotation on loading matrix (Joliffe, 2002) (Eq. 1), LSCIs with high rotated loadings were retained. As a conclusion, 9 LSCIs (i.e., Southern Oscillation Index, Multivariate ENSO Index, East Central Tropical Pacific SST, Central Tropical Pacific SST, Bivariate ENSO Time series, Oceanic NINO Index，Atlantic Meridional Mode,North Tropical Atlantic SST Index, and Tropical Northern Atlantic) were selected out of 36 ones.

$$
\mathrm { L o a d i n g \ m a t r i x } = V \times { \cal L } ^ { 1 / 2 } ,
$$

where $V$ is the eigenvectors matrix and $L ^ { 1 / 2 }$ is the diagonal square respective eigenvalues.

# 3.2 Multilayer perceptron (MLP)

The study of artificial neural networks is motivated by their similarity to biological systems consisting of very simple but numerous nerve cels (neurons) working massively in paralel and linked to each other in a weighted way (Kriesel, 2O07). Equation 2 shows the formulated neural neuron operation.

$$
y = f ( \sum w _ { i } x _ { i } + b ) ,
$$

where $y$ is the scalar output (Kriesel, 2007); $f$ is the neuron activation or transfer function; and $w _ { i } .$ $x _ { i }$ and $b$ are weight, input and bias of the $i ^ { \mathrm { t h } }$ member, respectively. The MLP is the most frequently used neural networks (Popescu et al., 2OO9), which is in the feed-forward artificial neural network class consisting of at least three layers of input, hidden and output layer (Rosenblatt, 1961). Figure 2 demonstrates the schematic MLP topology used in this study. A three-layer MLP including one hidden layer was implemented.

![](images/146972b5a9c1130c1a8ea2fd1f420a73b22901a8de9e2ee081364983c0b7a0b0.jpg)  
Fig.2Schematic topology of a three-layer MLP(Multilayer perceptron)applied in this study. In the input layer for each input,one neuron should be considered; the numberof the neurons of the hidden layer in each model was selected based on trial and error and represented in its relating section; the number of the neurons in the output layer,as can be seen, is the modeled precipitation measure for each month.

# 3.3Optimization methods

The training methods that this study benefited from were BP, GAs (genetic algorithms) and PSO. The BP is an approach to calculate the gradient of the loss function of an MLP network concerning its weights (Ashrafi et al., 2O12). It, however, is expensive in term of computational cost but was found out within the academic community how simply weights of its hidden layer can be optimized. This method, basically, applies the gradient descent algorithm to minimize the network error. Regularly, a gradient descent algorithm is used to adapt the weights according to a comparison between the desired and actual network response (Seiffert, 2Ool); however, it is likely to become captured in local minimum when moving across a rugged error surface. Therefore, many suggestions have been made to avoid this failure, like GAs and PSOs. In this study, the selected function to train the BP-based MLP network was Levenberg-Marquardt, since the accuracy of results, in this case, was better than those of other training approaches. The applied activation functions in each neuron of the hidden and output layers were the sigmoid and linear functions, respectively. Moreover, the number of neurons in the hidden layer experimentally has been chosen in every model to reach the lowest error value.

Genetic algorithm (GA) is an evolutionary algorithm, in which a population of individuals evolves based on a set of bio-inspired theories such as selection， mutation and crossover (Srinivasan et al., 2O03) to generate high-quality solutions for optimization problems (Mitchell, 1996). These algorithms encode a potential solution to a specific issue on a simple chromosome-like data structure (Whitley， 1994) competing with each other to achieve increasingly better results (Seiffert, 2O01). Concerning the mentioned problem of gradient descent algorithm, implementing of GA as a complete substitution might lead the model to more precise conclusions.

Observations of social and collective behaviour of biological organisms are the main inspirations in PSO (Garro et al., 2O15), specifically the movement of the best member of the population at the same time on their own experience. This seeking behaviour was associated with that of an optimization search for solutions to non-linear equations in a real-valued search space (Bratton et al., 2OO7). The population is considered as a cumulus of particles $i$ where each has a position $x _ { i } \in R ^ { D }$ ， $( i { = } 1 , ~ . . . , ~ M )$ ，in a multidimensional space. These particles are evaluated in a particular optimization function to recognize their fitness value and save the best solution. All the particles change their positions in the search space according to a velocity function $\nu _ { i }$ which takes into account the best position of a particle in a population $P _ { g }$ (social component) as well as their own best position $P _ { i }$ (cognitive component) (Jiang et al., 2OO7). The particles will, repetitively, move to different positions until they find themselves in an optimum one (Garro and Vazquez, 2015).

The datasets, for all optimization methods should be divided into three sets: training, validation and test sets. In the present study, the first $70 \%$ ，the next $1 5 \%$ and the last $1 5 \%$ of the entire dataset were, respectively, dedicated to the training, the validation and the test sets. As the MLP was aimed to be implemented for time series, randomly data spliting and assgning to each mentioned sets were inappropriate. Therefore, a solid division of datasets was considered.

# 3.4Frameworks

This study benefited from two different model frameworks varying in the term of inputs: CMF) and IMF. In CMF, all contemporary LSCIs were entered in 12 individual models in each lead-time from O to 1l months in advance (Eq. 3), whereas in IMF the best LSCIs in each time lag, based on Pearson correlation, were entered in just one model (Eq. 4).

$$
P _ { n - 1 1 } = f ( { \mathrm { N i n o } } 3 . 4 _ { n - 1 1 } , { \mathrm { N i n o } } 4 _ { n - 1 1 } , . . . , { \mathrm { B E S T } } _ { n - 1 1 } )
$$

$$
P _ { n } = f ( \mathrm { L S C I } _ { n } , \mathrm { L S C I } _ { n - 1 } , \mathrm { L S C I } _ { n - 2 } , \mathrm { L S C I } _ { n - 3 } , . . . , \mathrm { L S C I } _ { n - 1 2 } ) ,
$$

where $P _ { n }$ is the amount of monthly precipitation in $n$ month. In Equation 3 all of the LSCIs were at the same time lags,which concluded 12 models from $P _ { n }$ to $P _ { n - 1 1 }$ ， whereas in Equation 4, precipitation in $n$ month was associated with a combination of the most correlated LSCIs in each time lags covering $n$ to $_ { n - 1 2 }$ （2

# 3.5Model performance evaluation

Root mean square error (RMSE) and mean absolute error (MAE) were employed in the model evaluation stage, both of which have been used as standard statistical metrics to measure model performance in a great variety of fields such as meteorology, air quality and climate research. These metrics were applied to select the most appropriate model in each optimization method based on the lowest error value. Besides, $Z$ -test that indicates the accuracy of the selected models in the term of similarity between the means of desired and actual model responses was investigated. In $Z \cdot$ -test, as long as $Z$ (Eq. 5) remains below the critical value, null hypothesis (HO: $\mu _ { 1 } { = } \mu _ { 2 }$ ,where $\mu _ { 1 }$ and $\mu _ { 2 }$ are the means of the two comparing populations) is fulfilled and the model keeps the dataset mean approximately constant (Mann,1997). The $Z$ value formula is as follows:

$$
Z = \frac { ( \overline { { { x } } } _ { 1 } - \overline { { { x } } } _ { 2 } ) - ( \mu _ { 1 } - \mu _ { 2 } ) } { \sigma _ { \overline { { { x } } } _ { 1 } - \overline { { { x } } } _ { 2 } } } ,
$$

$$
\sigma _ { \overline { { { x } } } _ { 1 } - \overline { { { x } } } _ { 2 } } = \sqrt { \frac { \sigma _ { 1 } ^ { 2 } } { n _ { 1 } } + \frac { \sigma _ { 2 } ^ { 2 } } { n _ { 2 } } } ,
$$

where $\mu$ is the mean of each population; $\bar { x }$ is the mean of the sample drawn from each population; $\sigma$ is the standard deviation; $n$ is the size of sample drawn from each population (Mann, 1997); and the subscript number 1 and 2 respectively represent observed and predicted. The advantage of using $Z$ -test for the final three models led the results of the present study to be re-evaluated and more reliable.

# 3.6Taylor diagram

Taylor diagram was applied to compare the performance of the final selected models. This diagram is particularly useful in assessing the relative merits of competing models and in monitoring overall performance as a model evolves (Taylor, 2O01). Its overview is shown in Figure 3, in which the correlation coefficient between simulated and observed datasets is given by the azimuthal angle and the standard deviation of the simulated set is proportionally related to the radial distance from the origin (Xu et al., 2016).

![](images/97d5b13316966780f4a3fe56c51b6ec196e62f8160529e35262d472394d9ec7c.jpg)  
Fig. 3 Diagram of statistical comparison among the models. The reference point on $x$ -axisis the standard deviation of the observed dataset and the radial distance from this point (dashed contour)represents the RMSE (root mean square errr)of the model; the dotted contours, which arethe radial distance from the origin,shows the standard deviation of the simulated sets.It is clear that the most precise model is the one closer to the reference point (Taylor, 2001).

# 4Results and discussion

For all 13 cases (12 ones generated in CMF and 1 in IMF), BP-based MLP, GA-based MLP and

PSO-based MLP were generated. Among all 9 selected LSCIs, SOI, Nino3.4 and Nino 4 were highly correlated with Tehran monthly precipitation; therefore, the input for IMF case in all three optimization methods was the combination of these three indices in each lead-time (Eq. 7).

$P _ { n } = f ( \mathbf { S } \mathbf { O } \mathbf { I } _ { n }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 1 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 2 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 3 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 4 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 5 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 6 }$ ，$\mathrm { N i n o } 3 . 4 _ { n - 7 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 8 }$ $\mathrm { N i n o } 3 . 4 _ { n - 9 }$ ， $\mathrm { N i n o } 3 . 4 _ { n - 1 0 }$ ， $\mathrm { N i n o } 4 _ { n - 1 1 }$ $\mathrm { N i n o } 4 _ { n - 1 2 } \$

RMSE, MAE, $Z$ -test, and Taylor diagram were used to identify the most appropriate model among all36 outcomes. The results of allthree optimization methods through CMF and IMF are presented in Figure 5, in which all lead-time can be visually compared. $x$ -axis shows the cases used in this study (12 cases from simultaneous to 11-month lead-time in CMF and 1 case in IMF). According to Figure 5a, the best proposed monthly model in BP-based MLP according to its error values belonged to 3-month lead-time in CMF. In this case, RMSE and MAE were 19.37 and $1 2 . 3 8 ~ \mathrm { m m }$ respectively, both of which were lower than those of the other cases. The number of its hidden layer neurons was 8 concluded on the basis of trial and error. Except for this case, IMF outperformed other cases in CMF, proving its prediction ability.

![](images/6654f4ce9530f49e3659c7f0238df9515cda478e46661a3e010c06c6b092f5ea.jpg)  
Fig. 5 Performance of all generated cases in three optimization methods. The O-11 of $x$ -axis shows the framework of CMF(concurrent model framework).IMF, integrated model framework. MAE,meanabsolute error; RMSE, root mean square error.

The same information related to GA-based MLP model is shown in Figure 5b. It should be noted that this algorithm was applied as the complete substitution in the training stage in the MLP network. The performance of this algorithm is highly dependent on gamma and mutation rate (0.2 and O.1, respectively). Case model, 8-month lead-time, seemed quite satisfactory according to its RMSE( $1 7 . 4 ~ \mathrm { m m } )$ andMAE( $1 3 . 6 ~ \mathrm { m m } )$ . It can be highlighted that for GA-based MLP, in contrast with BP-based MLP, there is not any remarkable superiority sign of IMF over other CMF. Figure 5c indicates PSO-based MLP results. As stated earlier, cognitive and social components are the key parameters in the performance of the PSO algorithm, both of which based on error and trial were considered, respectively, as 1 and 2 in this study. According to Figure 5c, IMF (RMSE, 18.5 $\mathrm { m m }$ ； MAE, $1 2 . 9 \ \mathrm { m m } )$ ） was the case that the results remarkably outperformed the other cases, while 2-month lead-time seemed to be more accurate throughout other cases in CMF. The results of $Z$ -test for all selected cases in three methods are presented in Table 2.

Table2Z-test for selected cases in each method   

<html><body><table><tr><td>Time scale</td><td>Model framework</td><td>Lead-time (month)</td><td>Z</td></tr><tr><td>Monthly</td><td>CMF</td><td>3</td><td>0.84</td></tr><tr><td>Monthly</td><td>CMF</td><td>8</td><td>0.62</td></tr><tr><td>Monthly</td><td>IMF</td><td>-</td><td>0.56</td></tr></table></body></html>

Note: CMF,Concurrent ModelFramework; IMF,IntegratedModelFramework; -,no lead-time in IMF.

As the critical $Z$ in $5 \%$ significance level in two-tailed case is 1.94, which is greater than the calculated $Z$ (Table 2) in all selected cases, the variation between the means of observed and estimated values was not derived to be notable; therefore, the results of these models could be considered as reliable. The comparison between BP-based MLP, GA-based MLP and PSO-based MLP, respectively, in 3- and 8-month lead-time and IMF framework are demonstrated in Table 3, which clearly expresses the vagueness of distinguishing the best model among the three final selected cases based on RMSE or MAE. Since the judgment on the most accurate performance might be chalenging due to some close results, Taylor diagram could help with interpreting. This diagram, under consideration of RMSE of the cases, standard deviation of the simulated datasets and correlation coefficient between the simulated and observed datasets (Taylor, 2OO1), precisely presents the best-generated model (Fig. 6). The reference point on $x$ -axis,which indicates the standard deviation of the observations, was $2 3 . 5 4 ~ \mathrm { m m }$ According to Figure 6 the PSO-based MLP was the best case, as it was the closest one to the reference point.

Table 3Selected models and their RMSE (root mean square error) and MAE (mean absolute error) under training, validation and test steps   

<html><body><table><tr><td rowspan="2">Method</td><td rowspan="2">Model framework</td><td rowspan="2">Lead-time (month)</td><td colspan="2">Training</td><td colspan="2">Validation</td><td colspan="2">Test</td></tr><tr><td>RMSE</td><td> MAE</td><td>RMSE</td><td>MAE</td><td>RMSE</td><td>MAE</td></tr><tr><td></td><td></td><td></td><td>(mm)</td><td>(mm)</td><td>(mm)</td><td>(mm)</td><td>(mm)</td><td>(mm)</td></tr><tr><td>BP-based MLP</td><td>CMF CMF</td><td>3</td><td>18.53</td><td>12.10</td><td>20.43</td><td>14.90</td><td>19.37</td><td>12.38</td></tr><tr><td>GA-based MLP</td><td></td><td>8</td><td>19.34</td><td>14.61</td><td>20.36</td><td>14.26</td><td>17.39</td><td>13.59</td></tr><tr><td>PSO-based MLP</td><td>IMF</td><td>-</td><td>21.21</td><td>15.12</td><td>19.17</td><td>13.69</td><td>18.54</td><td>12.97</td></tr></table></body></html>

![](images/c9fe6ab6cd320712c5af1941054d326ad4310a70647fc9793d0b44c5a9b24b8e.jpg)  
Fig. 6Result of Taylor diagram. As can be seen, the performance of all cases are in an approximately same range; however, the MLP-PSO is the closest case to the reference point.

# 5 Conclusions

In this study, three optimization methods, BP, GAs and PSO, on the platform of a multilayer perceptron (MLP) network were considered. These methods were applied in the training stage of the MLP and in turn, were completely substituted. Two frameworks, CMF and IMF, were denoted. Through these two frameworks, 13 cases were generated with 12 cases within CMF, each of which contained all selected LSCIs in the same lead-times, and one case within IMF that was constituted from the combination of the most correlated LSCIs with Tehran precipitation in each lead-time. In each optimization method, the most accurate case, based on the RMSE and MAE, was recognized and then assessed by the application of $Z$ -test. Since the RMSE and MAE of the selected cases were close to each other, it might be concluded that all three cases performed in the same accuracy; however, through the Taylor diagram, it could be denoted that PSO-based MLP in IMF had the best performance for its lowest distance to the reference point in the diagram. Therefore, Equation 7, as the input combination under PSO-based MLP algorithm, can be applied for precipitation forecasting reliably in Tehran metropolitan. The overall results, however, can be interpreted that in all optimization methods the IMF could conclude more precise outcomes and outperform CMF.

In previous studies, the optimization methods can promote the performance of a multilayer perceptron network (Choubin et al., 2014; Tskiran et al., 2015; Prabhu and Karthikeyan, 2018;

Qui et al., 2O18; Bensingh et al.,2019). The results of this study were in agreement with Choubin et al. (2014), which suggested that PSO algorithm could evolve a multilayer perceptron network to generate better results. Although, the errors,resulting in this research, seemed considerable, the selected model could track the future trends more reliably rather than predicting the exact amounts of precipitation (Bjerknes, 1969; Jones et al., 1997; Matyasovszky, 2003; Karabok et al., 2005; Hatzaki et al., 2007; Kakapour, 2011; Ashrafi et al., 2012; Choubin et al., 2014). Despite that, the present study with the application of machine learning reached an optimum forecast model, in which up to $34 \%$ of Tehran monthly precipitation could be explained. As a conclusion, it is recommended to take surface parameters coupled with LSCIs under consideration to investigate the probability of further uncertainty reduction.

# References

Abbot J,Marohasy J.2O18.Forecasting of medium-term rainfallusing artificial neural networks:case studies fromeastern Australia. doi: 10.5772/intechopen.72619.[2017-12-27]. https://www.intechopen.com.   
Abdi H,WiliamsL.2O10.Principalcomponentanalysis.WileyInterdisciplinaryReviews: Computational Statistics,2:43- 459.   
Allan RJ,Beard GS,Close A,etal.1996.Mean sea level pressure indicesof theElNino-Southernoscilation: relevanceto stream discharge in south-eastern Australia. Divisional report. Canberra: CSIRO Division of Water Resources, 96/1.   
Araghinejad S,Meidani E.2O13.Areviewof climate signalsas predictors of long-term hydro-climatic variability.Climate Variability. doi: http://dx.doi.org/10.5772/56790.   
Arvin A.2015.Relationshipbetween El-Nino-southern oscilltion (ENSO)and total ozone variations in Iran. Geographyand Development Iranian Journal, 12: 165-180. (In Farsi)   
Ashrafi K,Shafiepour M,GhasemiL,etal.2012.Predictionofclimatechangeinduced temperatureriseinregionalscaleusing neural network. International Journal of Environmental Research, 6(3): 677-688.   
Bensingh R J, Machavaram R, Boopathy SR,et al. 2019. Injection molding processoptimization of a bi-aspheric lens using hybrid artificial neural networks (ANNs)and particle swarm optimization (PSO). Measurement,134: 359-374.   
Bjerknes J.1969.Atmospheric teleconnections from the equatorialPacific.Monthly Weather Review,97(3):163-172.   
BrandimarteL,diBaldassarreG,Bruni G,etal.2011Relation betweenthe North-Atlanticoscillationand hydrocliatic conditions in Mediterranean areas. Water Resource Management, 25: 1269-1279.   
BratonD,Kennedy J.2007. Defining a standard for particle swarm optimization.Proceedingsof the 2007 IEEE Swarm Intelligence Symposium, 120-127, doi: 10.1109/SIS.2007.368035.   
CanonJ,GonzalezJ,ValdezJ.2oo7.Precipitation intheColoradoRiverbasinand itslowfrequencyasociationswithDO and ENSO signals. Journal of Hydrology, 333(2-4): 252-264.   
ChoubinB,Khalighi-Sigaroodi S,MalekianA,etal.2O14.Droughtforecastinginasem-arid watershedusingcimatesignals: a neuro-fuzzy modeling approach. Journal of Mountain Science, 11: 1593-1605.   
Degefu MA,Bewket W.2O17.Variabilitytrends,andteleconectionsofstreamflows withlarge-scaleclimatesignals nthe Omo-Ghibe river basin, Ethiopia. Environmental Monitoring and Assessment,189(4): 142.   
Garo B,Vazquez R.2O15.Designingartificial neural networksusing particleswarm optimizationalgorithms. Computational Intelligence and Neuroscience, ID 369298.   
GaughanAE,WaylenPR.2O12.Spatialand temporal precipitation variabilityin the Okvango-Kwando-Zambezi catchment, southern Africa. Journal of Arid Environments, 82: 19-30.   
Gerkaninezhad M Z,Bazrafshan O.2O18.Impactof climatic signals onthe wet and dryseason precipitation (case study: Persian Gulf and Oman Sea watersheds). Journal of the Earth and Space Physics,44: 333-349. (In Farsi)   
Ghazal R,ArdeshirA, Zahedi RadI,2O14.Climatechangeandstorm-water management strategies in Tehran.Procedia Engineering, 89: 780-787.   
GongD,Ho C.2003.Detectionof large-scaleclimatesignals inspringvegetation index (normalized differencevegetation index) over the Northern Hemisphere. Journal of Geophysical Research, 1O8(D16): 4498.   
HatzakiM,FlocasH,simakooulosD,etal.esteediterraantececiontt.IteatoaJoualof Climatology, 27(6): 727-737.   
Hidalgo H,Dracup J.2O03.ENSOandPDO efects on hydroclimatic variationsof theupper Colorado River basin.Joural of Hydrometeorology, 4(1): 5-23.   
Hurrell JW.1995.Decadal trends inte northAtlanticoscilation: regional temperaturesand precipitation.Science,269(5224): 676-679.   
JiangM,LuoY,YangS.2O7.Particleswarmoptimzation-stochastictrajectoryanalysisandparameterselection.InFelixT   
Jolliffe I T.2002. Principal Component Analysis ( $2 ^ { \mathrm { n d } }$ ed.). New York: Springer, 2.   
Jones P,JonssonT,WheelerD.997.ExtensiontotenorthAtanticsciltionusingearlyistrumentalpressurebetios from Gibraltar and south-west Iceland. International Journal of Climatology,17(13): 1433-1450.   
Kaiser H. 1960.The application of electronic computers tofactor analysis.Educational and Psychological Measurements,20: 141-151.   
Kampichler C,van Turnhout C,Devictor V,etal.2012.Large-scalechanges incommunitycomposition: determining landuse and climate change signals. PLoS ONE, 7(4): e35272.   
Karabok M, Kahya E, Karaca M.2Oo5.The influencesof the Southern and North Atlantic oscilations onclimatic surface variables in Turkey. Hydrological Processes,19(6): 1185-1211.   
Kriesel D. 2007. A Brief Introduction to Neural Networks. [2020-01-20]. htp://www.dkriesel.com.   
Mann P. 1997. Introductory Statistics $3 ^ { \mathrm { r d } }$ ed.). New York: Wiley, 405.   
Matyasovszky I. 2O03.The relationship between NAO and temperature in Hungary and its nonlinear connection with ENSO. Theoretical and Applied Climatology, 74: 69-75.   
Mitchell M. 1996. An Introduction to Genetic Algorithms. Cambridge: MIT Press, 3.   
Nigam S,Shen H.1993. Structure of oceanic and atmospheric low-frequency variabilityover the tropical Pacific and Indian Oceans. Journal of Climatology, 6(4): 657-676.   
Oldenberg-van G, Burgers G, Tank A.20oo. OntheEl-Nino teleconnection tospring precipitation in Europe. International Journal of Climatology, 20(5): 565-574.   
Ouyang R,Liu W,Fu G, etal.2014.Linkages between ENSO/PDO signals and precipitation,stream-flowin China during the last 100 years.Hydrology and Earth System Science,18(9): 3651-3661.   
PasiniG. 2O17. Principal component analysis for stock portfolio management.International Journal of Pureand Applied Mathematics,115(1): 153-167.   
Popescu M,BalasV,Popescu L,etal.2Oo9.Multilayer perceptronand neural networks.WSEAS Transactions onCircuitsand Systems,8(7): 579-588.   
Pozo-VazquezDGamz-FortisSR,Tovar-PescadorJ,etal.O5.ElNnoSutheoscilltioneventsandaoiatedEuroan winter precipitation anomalies. International Journal of Climatology, 25(1): 17-31.   
PrabhuM V, Karthikeyan R.2018.Comparative studiesonmodelingandoptimizationof hydrodynamic parameters on inverse fluidized bed reactor using ANN-GA and RSM. Alexandria Engineering Journal, 57(4): 3019-3032.   
Qui S,Chen B, Wang R,etal.2O18. Atmosphericdispersion predictionand source estimationof hazardous gas using artificial neural network,particle swarm optimizationand expectation maximization.Atmospheric Environment,178:159-163.   
RosenblattF.1961.Principles of Neurodynamics: Perceptronand the Theory of Brain Mechanisms. Washington DC: Spartan Books, 245.   
Saji N,Goswami B, Vinayachandran P,etal.1999.Adipole mode in thetropical Indian Ocean.Nature,401: 360-363.   
Santos J,CorteJ,LeiteS.Oo5.WeatherregimesadteirconectiontohewinterainfalinPortugal.InterationalJoualof Climatology, 25(1): 33-50.   
Seifert U. 2001. Multiple layer Perceptron training using genetic algorithms.Bruges: Procedings of European Symposium on Artificial Neural Networks,159-164.   
Srinivasan D,Seow T H. 2003.Particle swarm inspired evolutionary algorithm (PS-EA)for multi-objective optimization problem. Acta Biomaterialia,4: 2292-2297.   
Taylor K E. 20o1. Summarizing multiple aspects of model performance in a single diagram. Journal of Geophysical Research, 106(D7): 7183-7192.   
Tyson P.1987. Climate changeand variability in southern Africa. The Quarterly Journal of Royal Meteorological Society8: 552-562.   
Walace J,Gutzler D.1981.Teleconnections inthe geopotential heightfield during the northern hemisphere winter.Monthly Weather Review, 109(4): 748-812.   
Whitley D. 1994. A genetic algorithm tutorial. Statistics and Computing,4: 65-85.   
Wittan IH, Frank E. 2Oo5.Data Mining: Practical Machine Learning Tools and Techniques ( $2 ^ { \mathrm { n d } }$ ed.). San Francisco: Elsevier, 29.   
Xu L,Chen N,Zhang X.2O18.Acomparison of large-scaleclimate signalsand the North American multi-model ensemble (NMME) for drought prediction in China. Journal of Hydrology, 557: 378-390.   
Xu Z, Hou Z,Han Y,etal.216.Adiagram forevaluating multiple aspectsof model performance insimulating vectorfields. Geoscientific Model Development,9: 4365-4380.   
Zahraei B,Karamouz M.2Oo4.Seasonal precipitation predictionusing large scale climate signals.SaltLake City: World Water and Environmental Resources Congress.