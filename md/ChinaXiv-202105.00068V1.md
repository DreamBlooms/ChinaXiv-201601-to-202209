# An Iterative Local Search Based hybrid algorithm for the service area problem

Yunfeng Konga,b

α Key Laboratory of Geospatial Technology for the Middle and Lower Yellow River Regions, Ministry of Education, Henan University, Kaifang, China; b College of Environment and Planning, Henan University, Kaifang, China.

Abstract: This article presents a hybrid algorithm for the service area problem.The design of service areas is one of the essential issues in providing efficient services in both the public and private sectors.For a geographical region with a number of small spatial units, the service area problem is to assign the service-demand units to the service-supply units such that each facility has a service area.The basic criteria for the service areas are the highest service accessibility, the contiguous service areas,and that the service demand does not exceed the service supply in each service area. A hybrid algorithm for the service area problem is proposed by extending iterative local search (ILS) algorithm with three schemes: population-based ILS,variable neighborhood descent (VND) search,and set partitioning.The performance of the algorithm was tested using 6O welldesigned instances. Experimentation showed that the instances could be solved effectively and efficiently.The solutions found by the hybrid algorithm approximate optimal solutions or the lower bounds with an average gap of $0 . 1 5 \%$

Keywords: service area problem;hybrid algorithm; local search;set partitioning

# 1. Introduction

This article deals with the service area problem (SAP).The design of service areas is one of the essential issues in providing efficient services in both the public and private sectors (Daskin 2O11). The delineation of service areas for schools (Ferland and Guenette 1990; Schoepfle and Church 1991; Caro et al. 2O14), hospitals and healthcare centers (Pezzella et al. 1981; Jacobs et al.1996; Emiliano et al. 2017; Hu et al. 2018),disaster shelters (Li et al. 2008; Hu et al. 2014),green energy resources (Yanik et al. 2016) and many other facilities can be generalized as a contiguity-constrained capacitated facility SAP. For a geographic area with small spatial units,the SAP should assgn the service-demand units to servicesupply units such that each facility has a service area and some criteria are satisfied.The basic criteria for the design of service areas are the highest service accessibility, the

contiguous service areas,and that the service demand does not exceed the service supply in each service area.Service accessibility can be evaluated by total travel distance from demand units to their supply units.The shortest travel distance is usually preferred when using the service. Contiguous service area is also a necessity for satisfying policy or management purposes.In addition, the total service demand in each service area should be no greater than its service capacity.

The SAP can be defined as a contiguity-constrained generalized assignment problem (GAP). It aims to minimize the total travel distance when using the service while satisfying constraints on facility capacity and service area contiguity. The GAP is known to be nondeterministic polynomial time hard (NP-hard).The constraints on spatial contiguity also pose great obstacles in modeling and solving the geographic problems (Duque et al. 2011). Consequently,various exact and heuristic methods have been proposed for solving the SAP.

Mixed integer linear programming (MILP) has been widely utilized to solve the districting problems. Owing to the computational complexity of the districting problems, many of the MILP models developed since the 196Os were simplified by ignoring some districting constraints such as district contiguity and unit integrity.The model solutions must be adjusted by repairing split units and fragmented districts.Such methods have been suggested for school districting (Koenigsberg 1968; Franklin and Koenigsberg 1973; Caro et al. 2004), political districting (Hess et al. 1965; Hojati 1996; George et al. 1997; Li et al. 2007),and the territory design problem (Kalcsics et al. 2O05). Modeling and repairing approaches could be adapted to solving the SAP. However,in case of a spatial mismatch between service demands and supplies in a geographic region,it may be difficult to find satisfactory solutions.

The second class of MILP models have considered district contiguity. Three types of formulations on district contiguity一tree-based,order-based,and flow-based一can be embedded into an assignment model or a location-allocation model for solving districting problems (Shirabe 2005; Duque et al. 2011). Nemoto and Hotta (2003) proposed a MILP model for political districting.The model considers district contiguity, but it does not guarantee the compactness of the districts. Salazar-Aguilar et al. (2O11) proposed a biobjective model for designing commercial territories. Constraints such as balance of sales volume and district contiguity are formulated in the model. However, four hours of computation time were used to solve the problem instances with 150 units and 6 territories. Plane et al. (2019) proposed a minimum inter-person separation model for political districting. For instances with $6 { \times } 6$ grids can be solved optimally or near-optimally in 6.30-53,632.22 seconds. Kong et al. (2019) formulated a center-based allocation model with flow-based constraints on district contiguity to solve the districting problem. Given district centers from a K-medoids algorithm,the districting instances could be solved efficiently.Since the service-supply units are already provided in the SAP,the model could be modified to solve the problem.

The third exact approach has been suggested based on the set partitioning problem (SPP). Given a large number of feasible districts generated by the construction or heuristic methods,the SPP model attempts to select an optimal set of districts from the candidate districts as a districting solution (Garfinkel and Nemhauser 1970; Nygreen 1988; Mehrotra et al. 1998). Solutions from the problem instances indicate that the SPP model for the small-sized instances can be solved exactly.The model results also seem to be satisfactory for large problems.To obtain satisfying solutions,they suggested different techniques to generate promising candidate districts. Kong et al. (2017) proposed an iterated local search algorithm with set partitioning to solve the school districting problem.The SPP model could choose a much better solution from the historical districts identified by the local search. However, the algorithm was not fully tested on general SAP instances.

Local-search-based and population-based heuristics are the mainstream methods used for solving the SAP.Starting from an initial solution, the local-search based algorithms, such as greedy search,simulated annulling, tabu search,old bachelor acceptance search,and the greedy randomized adaptive search procedure (GRASP), could iteratively improve the incumbent solution using neighborhood search (Li et al. 2O08; Ricca and Simeone 2O08; Rios-Mercado and Fernandez 20o9). The neighborhood space of the incumbent solution is explored by one or several search operators,and the incumbent solution is updated according to the acceptance criteria adopted in a specific algorithm. The one-unit shift is a widely used operator that moves a boundary unit to its neighboring district while maintaining the connectivity of its original district (Tavares-Pereira et al. 2007; Ricca and Simeone 2008; Xiao 2008; Li et al. 2O08; Liberatore and Camachocollados 2016). Butsch et al. (2014) introduced three operators for districting problems: shift, double shift,and swap. Kong et al. (2O17) suggested much more complicated local search operators for school districting. However, algorithms with expensive local search operators have not fully tested in the existing literature.

Population-based heuristics have become popular for solving districting problems in recent literature.The evolutionary algorithms (Forman and Yue 2O03; Bergey et al. 2003; Bacao et al.2005; Tavarespereira et al. 2007; Chou et al. 2007; Tavares-Pereira et al. 2007; Xiao 2008; Chou 2011; Hu et al. 2014; Liu et al. 2016) maintain and improve multiple candidate solutions using mechanisms such as crossover,mutation,and selection. The crossover operation for districting problems is usually implemented by overlaying two individuals and then repairing the fragmented overlaid areas (Chou et al. 2OO7; Datta et al. 2008; Xiao 2008; Liu et al. 2016). The mutation operation usually moves every boundary unit to its neighboring districts with a small mutation possibility.To increase the speed of the algorithm convergence and the solution quality, Tavarespereira et al. (2Oo7) proposed an evolutionary algorithm with local search for the districting problem.The population diversity in evolutionary algorithms and the search intensity in local search heuristics are balanced in the hybrid algorithm.In addition, nature-inspired metaheuristics such as scatter search (Salazar-Aguilar et al. 2O12)and artificial bee colony (Rincón-Garcia et al. 2015) have also been applied to solve districting problems.

These are some limitations to the solution methods for the districting problems.First, the existing algorithms are capable of solving artificial or real problem instances; however, the performance of the algorithms has not been sufficiently tested on benchmark instances, so the optimality of solutions from the algorithms is stil unknown. Second, some innovative ideas in operations research, such as hybrid metaheuristics, matheuristics, learning-based adaptive algorithms,and hyper-heuristics, have not been adequately utilized for solving the districting problems.Third,some studies report that districting problems are difficult to directly solve using exact methods. However,along with progress in MILP,especially the embedded heuristics in mixed-integer programming (MIP) optimizers, state-of-the-art MIP solvers could solve increasingly dificult problems (Lodi 2017). Designing new algorithms based on the framework of modern MIP solvers may be a promising approach to the districting problems.

This article presents a hybrid algorithm for the SAP. It was proposed by extending iterative local search (ILS) algorithm with three schemes: population-based ILS, variable neighborhood descent (VND) search,and set partitioning. The algorithm was tested using 60 well-designed problem instances.The effectiveness and efficiency of the proposed hybrid algorithm for the SAP were verified using the problem instances. Compared with exact solutions,the solutions from the hybrid algorithm approximate optimal or the lower bounds with an average gap of $0 . 1 5 \%$ . To the best of authors' knowledge, it is the first time to introduce a population-based ILS with VND search and set partitioning for the SAP.

# 2.Problem formulation

For a geographic area, let $V = \{ 1 , 2 \dots n \}$ be a set of $n$ small units. Each unit i has service demand $p _ { i }$ Let $S = \left\{ s _ { 1 } , s _ { 2 } \ldots s _ { K } \right\} ( S \subset V )$ be a set of $\boldsymbol { K }$ service-supply units,and each unit $s _ { k }$ has service capacity $q _ { k }$ Let $d _ { i k }$ be the distance between demand unit $i$ and supply unit $k$ Let $a _ { i j }$ indicate whether units $i$ and $j$ share a border and $N _ { i }$ be a set of units that are adjacent to unit $i ( N _ { i } = \{ j | a _ { i j } = 1 \} $ ）

A MILP model can be formulated by defining the SAP as a contiguity-constrained GAP.The contiguity of service areas can be ensured by a network flow model (Shirabe 2005; Duque et al. 2011). Let $x _ { i k } \in \{ 0 , 1 \}$ denote whether unit $i$ is assigned to supply unit

Sk， $H _ { k }$ ? $( H _ { k } \ge 0 )$ ）be the service overload of supply unit $s _ { k } ,$ and $f _ { i j k } \big ( f _ { i j k } \ge 0 \big )$ be the flow from unit $i$ to unit $j$ in service area $k$ .The model for the SAP is formulated as follows:

$$
\begin{array} { r l } & { \alpha \sum _ { k \in S } H _ { k } + \sum _ { i \in V } \sum _ { k \in S } p _ { i } d _ { i k } x _ { i k } } \\ & { \sum _ { k \in S } x _ { i k } = 1 , \forall i \in V } \\ & { \sum _ { i \in V } p _ { i } x _ { i k } \le q _ { k } + H _ { k } , \forall k \in S } \\ & { f _ { i j k } \le ( n - K ) x _ { i k } , \forall i \in V , j \in N _ { i } , \forall k \in S } \\ & { f _ { i j k } \le ( n - K ) x _ { j k } , \forall i \in V , j \in N _ { i } , \forall k \in S } \\ & { \sum _ { j \in N _ { i } } f _ { i j k } - \sum _ { j \in N _ { i } } f _ { j i k } \ge x _ { i k } , \forall i \in V \backslash S , \forall k \in S } \\ & { x _ { i k } = \{ 0 , 1 \} , \forall i \in V , k \in S } \\ & { f _ { i j k } , H _ { k } \ge 0 , \forall i \in V , j \in N _ { i } , k \in S } \end{array}
$$

The objective function (1) is to minimize the total travel distance from service demand units to their supply units.It also penalizes service overloads by using a large enough coefficient $\alpha$ . Constraints (2) confirm that each unit $i$ is assigned to only one service-supply unit.Constraints (3)are soft constraints on service capacities. Constraints (4),(5),and (6) are the flow-based formulations on contiguity,which are rewritten formulations in Duque et al. (2011). For two adjacent units $i$ and $j ,$ if both of them are assigned to service-supply unit $s _ { k }$ $\scriptstyle x _ { i k } = 1$ and $x _ { j k } = 1$ ), there might be a flow from unit $i$ to $j$ in basin $k ( f _ { i j k } \ge 0 )$ ; otherwise, these is no any flow between them $( f _ { i j k } = 0 )$ . This is confirmed by constraints (4) and (5). Constraints (6) ensure that one unit of flow must be created at non-service-supply unit $i$ if it is assigned to service-supply unit $s _ { k }$ .Constraints (4),(5) and (6) enforce all the flows created in service area of $k$ must run to the sink unit $k$ Constraints (7) and (8) impose restrictions on decision variables.Note that the soft constraints (3) on facility capacities are used in the model.The service overloads $\left( H _ { k } \right)$ in the constraints are penalized by the objective function.There are two advantages of using soft constraints.First,the soft constraints could help the MIP optimizer to find a feasible solution eficiently and guide the search toward preferred solutions.Second,using hard capacity constraints,there is no feasible solution for some instances, e.g. the total demand is greater than the total supply,or both the assignment constraints and capacity constraints cannot be satisfied.Such infeasible instances can be handled by the soft constraints.

# 3. A hybrid algorithm

# 3.1 Iterative local search

A hybrid algorithm for the SAP was proposed based on ILS algorithm.ILS is a simple,easy to implement,and quite effective metaheuristic for discrete optimization problems (Lourenco et al. 2O1O).ILS starts from an initial solution and iteratively improves the

solution by local search and perturbation. Local search heuristic is used to intensively explore the solution space. However,the iterative search may easily get trapped in local optima that are far away from the global optimum. ILS escapes from local optima by applying perturbations to the current local minimum.The basic ILS procedure is illstrated in Algorithm 1.

Algorithm1: Iterated local search

1. $s _ { 0 } =$ GeneratelnitialSolution();   
2. s = LocalSearch(so);   
3.Repeat until termination condition met:   
4. $s ^ { \prime } =$ Perturbation(s);   
5. $s ^ { * } =$ LocalSearch(s);   
6. If f(s\*) <f(s): s = S\*;   
7. Output s.

# 3.2Initial solution

The transportation problem (TP) model as follows was used to generate initial solutions. The model assigns the demand in each unit to one or multiple supply units with minimum traveling cost.The TP can be easily solved bya MIP solver owing to its bipartite structure. The small random coefficients $\epsilon _ { i k }$ $\displaystyle  \lvert \lvert \epsilon _ { i k } \rvert < 0 . 0 2 \}$ are used in the objective function to obtain a random solution.

Minimize

Subject to:

$$
\begin{array} { r l } & { \sum _ { i \in V } \sum _ { k \in S } ( 1 + \epsilon _ { i k } ) p _ { i } d _ { i k } x _ { i k } } \\ & { \sum _ { k \in S } x _ { i k } = 1 , \forall i \in V } \\ & { \sum _ { i \in V } p _ { i } x _ { i k } \le q _ { k } , \forall k \in S } \\ & { x _ { i k } = [ 0 , 1 ] , \forall i \in V , k \in S } \end{array}
$$

The solution from the TP model needs to be repaired.First, some units in a solution may be split into two or more parts.For each split unit,the algorithm assigns it to a service area according to the largest portion of split.Second,some service areas in a solution may be non-contiguous.The non-contiguous areas can be repaired by deleting the fragmented units and then reassigning them to their neighboring areas. Note that the solution from region growth may violate the constraints on service capacities.The infeasible solutions are allowed in the algorithm. However,a solution with service overloads willbe penalized in the following local search by the objective function (1) and tend to be a feasible solution.

# 3.3 Local search

The design of local search operators in optimization algorithm is critical for repeatedly improving the incumbent solution.The one-unit shift is a widely used operator that moves a boundary unit to its neighboring district while maintaining the connectivity of its original district (Tavares-Pereira et al. 2007; Ricca and Simeone 2008; Xiao 2008; Li et al. 2008;

Liberatore and Camachocollados 2016). Butsch et al. (2014) introduced three operators for districting problems: shift, double shift, and swap.

Two local search operators are used in the algorithm to improve the solutions.The operators attempted to move one or more units located on the boundary to their neighboring service areas. Note that only the feasible moves are allowed,because when moving a boundary unit from its original area to a destination area, the original area may be non-contiguous.The one-unit shift and two-unit shift are illustrated in Figure 1.

0 1 1 2 2 0 1 1 2 3 3   
0 1 1 2 3 3 0 1 1 2 3 3   
0 0 1 2 3 3 0 0 1 2 3 3   
One-unit shift   
0 1 12 2 3 0 1 2 2 2 3   
0 1 1 2 3 3 0 1 1 2 3 3   
0 0 →1 2 3 3 0 1 1 2 3 3

Two-unit shift

The one-unit shift moves boundary unit ito one of its neighboring area $k$ as outlined in Algorithm 2.In the algorithm,allthe boundary units are selected and then shuffled randomly.For each boundary unit i, the algorithm tries to move the boundary unit from its original area to one of its neighboring areas.The move is accepted in cases that the original area is connective,and the new solution is better than the incumbent solution.

Algorithm 2:one-unit shift

1. ulist=BoundaryUnits(s);   
2. ulist=Shuffle(ulist);   
3.For $i$ in ulist:   
4. For $k$ in NeighboringAreas(i):   
5. $\begin{array} { r } { { \cal S } ^ { * } = \mathsf { M o v e } ( s , i , k ) ; } \end{array}$ （20   
6. If Area(i) is contiguous and $f ( s ^ { * } ) { < } f ( s )$ ：   
7. $\scriptstyle { s = s ^ { * } } .$

8.Return $s ^ { * }$

The two-unit shift moves boundary unit $i$ to one of its neighboring areas $k ,$ and at the same time moves boundary unit $j$ in area $k$ to one of its neighboring areas (Algorithm 3). In other words,one unit is moved into area $k ,$ .and another unit in area $k$ is moved out. Differing from the one-unit shift that involves two areas,a two-unit shift usually involves three areas.Swapping two units between two adjacent areas is a special case that involves two areas.

<html><body><table><tr><td>Algorithm 3:two-unit shift</td></tr><tr><td>1. ulist=BoundaryUnits(s);</td></tr><tr><td>2.ulist=Shuffle(ulist);</td></tr></table></body></html>

<html><body><table><tr><td colspan="2">3. For i in ulist:</td></tr><tr><td>4. For jin ulist:</td><td></td></tr><tr><td>5.</td><td>If Area(i) and Area(i) are not adjacent: continue;</td></tr><tr><td>6.</td><td>For k in NeighboringAreas(i):</td></tr><tr><td>7.</td><td>s*= Move(s,i, j, k);</td></tr><tr><td>8.</td><td>If Area(i) or Area(j) is non-contiguous: continue;</td></tr><tr><td>9.</td><td>If f(s*)<f(s): s= s*;</td></tr></table></body></html>

10. Return s.

The two local search operators have different search space and computational complexity: ${ \sf O } ( { \sf K } n )$ and $\mathsf { O } ( K n ^ { 2 } )$ . However,the number of possible moves is generally much fewer,because only the boundary units can be moved to their neighboring areas,and there are only a few neighboring areas available for a boundary unit.

# 3.4Perturbation

Perturbation is one of the key components of ILS algorithm. Using local search operators, the solution may easily reach to local optima.A ruin and recreate procedure is useful to perturb the SAP solution from local optima.There are multiple methods to ruin the solution such as deleting some boundary units,deleting all the units in some areas,and deleting some units in a connective region.Then, the deleted units can be reassigned to their nearest facilities. The second perturbation method is to move some boundary units to their neighboring areas. A repair procedure on the new solution is usually necessary since some areas in the perturbed solution may be non-contiguous. On the other hand, the objective of perturbed solution may become worse. However,the following local search could improve the solution quality significantly.

The strength of perturbation is critical for ILS algorithm. A very strong perturbation tends to generate a much worse solution, such that better solutions willbe found with a very low probability.On the other hand,for a very small perturbation,the solution wil often back to its original state of local optimum by the following local search. An appropriate strength of perturbation willmaintain the diversification of ILS search,and thus benefits to find better solutions.

Four perturbation schemes are randomly used in our ILS algorithm: ruin boundary units and recreate, ruin service areas and recreate,ruin a connective region and recreate, and move boundary units to their neighboring areas. Let strength be the strength of perturbation,i.e.a percentage of the solution components,for example, strength% of boundary units,strength% of service areas, or strength% of all units.In allperturbation schemes, the perturbed units/areas are randomly selected.

# 3.5 Set partitioning

Let $\varOmega$ denote the set of historical service areas identified in ILS algorithm. Each area $i$ has an objective $c _ { i }$ and a set of units $U _ { i }$ in the area. Let subset $\mathcal { \Omega } _ { j } = \{ i | i \in \mathcal { \Omega } , j \in U _ { i } \} .$ ,the SPP model (13)-(15) could be used to select a subset service areas of $\varOmega$ ,which gives a minimal objective and also covers all the units in set $V .$ .The decision variable $x _ { i }$ indicates whether the candidate area $i$ is selected.

Minimize

Subject to:

$$
\begin{array} { r l } & { \sum _ { i \in \Omega } c _ { i } x _ { i } } \\ & { \sum _ { i \in \Omega _ { j } } x _ { i } = 1 , \ \forall j \in V } \\ & { x _ { i } \in \{ 0 , 1 \} , \forall i \in \varOmega } \end{array}
$$

The set partitioning could be added to ILS algorithm as a post procedure aiming to improve the SAP solution. The SPP is known to be NP-hard; however, existing MIP optimizers could solve the SPP instances with considerable sizes of $\Omega$ and V.

# 3.6 Contiguity of service areas

To keep the contiguity of service areas in SAP solutions, several algorithms are frequently used in local search and perturbation.The first algorithm is to check the connectivity of a service area.Ifa spanning tree can be established using all the units in an area, the area is connective (Liu et al. 2016). The second algorithm is to find the fragmented units in a solution.The spanning tree method can also identify the fragmented units. For each service area, a spanning tree is gradually constructed from the supply unit. If some units cannot be assigned to the tree,they are the fragmented units.The third algorithm is to repair a solution with non-contiguous service areas. The fragmented service areas are repaired by deleting the fragmented units and then gradually reassigning them to their neighboring areas.

# 3.7Ahybrid algorithm

We introduced a hybrid algorithm based on ILS to solve the SAP. The standard ILS algorithm was enhanced by three schemes: population-based search, variable neighborhood descent (VND) search,and set partitioning.The proposed algorithm is outlined in Algorithm 4.

Algorithm 4:Hybrid algorithm for SAP

Parameters: population size (psize), minimum dissimilarity between any two solutions (mindiff),perturbation strength (strength), number of consecutive loops that the best solution is not updated (mloops), time limit for set partitioning (t).   
1. $\pmb { P } =$ GeneratelnitialSolutions (psize); (Section 3.2);   
2. pool=null;   
3. $\scriptstyle S _ { b e s t } = { \mathsf { B e s t } } ( P ) ;$ （204号

4.notlmprove=0;   
5.While notlmprove $\angle$ mloops:   
6. Select a solution $s$ from $P$ randomly;   
7. s'=Perturbation (s,strength); (Section 3.4);   
8. s\*=VNDsearch(s');   
9. If f(s\*)<f(sbest): Sbest=s\*，notlmprove=0;   
10. else:notlmprove $+ { = } 1$ ：   
11. pool $\mathbf { \tau } = \mathbf { \tau }$ UpdateServiceAreaPool $( p o o I , s ^ { * } )$ ：   
12. $\boldsymbol { P } =$ UpdatePopulation $( P , s ^ { * } .$ mindiff);   
13. $s { = }$ SetPartitioning (pool, t); (Section 3.5);   
14.Output s.

The hybrid algorithm maintains a number of candidate solutions. It is a populationbased algorithm rather than the standard single solution-based ILS algorithm.The diversification of ILS search is guaranteed by the perturbation scheme. However,it is usually difficult to select a strength parameter for solution perturbation. Furthermore, the best perturbation strength for an instance might depend on the perturbation scheme and the attributes of the instance.The population-based extension of ILS may enhance the diversification of local search.A number of elite and diverse solutions are selected by the algorithm.In step 12,the population is updated according to the solution objectives and the similarities among the solutions.To maintain solution diversity, only elitist and dissimilar solutions are selected to be the new population.The updated population should be dissimilar.For any two solutions,their dissimilarity can be defined as the percentage of the demand units that are assigned to different facilities. Based on this definition, a dissimilar population means that the dissimilarity between any two solutions in the population is greater than a minimum dissimilarity.This percentage can be predefined as an algorithm parameter (mindiff).In some cases, the size of the new population may be smaller than the parameter popsize; however, the following process of perturbation could generate new dissimilar solutions.

The second scheme is to use VND local search instead of simple local search in ILS. A simple local search is to improve the solution by performing one-unit shift and two-unit shift respectively. VND is repeatedly exploring different neighborhood structures by deterministic change of neighborhoods until the solution cannot be improvement. Using VND search, ILS algorithm can easily find solutions in local optimum,and then moves the solution to new search point by perturbation.

The third scheme is to improve ILS solution by set partitioning. In each ILS loop, all the service areas in solution $s ^ { * }$ are recorded in the list pool. Each areal record includes the units in the service area and its objective value. At the end of ILS, thousands or more areas will be recorded in the pool. A SPP model (Section 3.5) could be used to select a better solution from the candidate service areas.

# 4. Experiment

# 4.1 Experiment settings

Three study areas, ZY, GY,and GY2 in Kong et al. (2019), were adapted for delineating the service areas.There are 324, 297 and 1276 spatial units in the study areas, respectively. Figure 2 shows the spatial units and the service demand in each unit.

![](images/3205823af6d63728e72bf458af078736888267b58aaed30314d2b77b16e59cc4.jpg)  
Figure 2: The spatial units in areas ZY,GY and GY2 (Kong et al. 2O19). The grey circles indicate the size of the service demand in each unit.

Using the three study areas, 6O instances for the SAP were prepared to test the hybrid algorithm.For each study area, 20 instances were designed as follows.(1)36,44 and 24 units in the three areas were assumed to be the candidates of service-supply units with service-supplies of 9195,42326 and 1324763,respectively.(2) Select a number of facilities from candidates randomly.13-17,37-41,and 18-22 service-supply units were selected for the three areas,respectively.(3) Adjust the facility capacities in each instance proportionally to ensure that the supply-demand ratio is around 1.15 and 1.03, respectively.(4) Select a number of facilities from candidates by solving a capacitated pmedian problem,and then adjust the facility capacities with the same supply-demand ratio in step (3).

Table 1 shows the attributes of the instances.The 2O instances for each study area can be classfied into 4 sets: random facility locations with higher supply-demand ratio (A), ${ \mathsf p }$ -median facility locations with higher supply-demand ratio (B), random facility locations with lower supply-demand ratio (C), and $\mathfrak { p }$ -median facility locations with lower supplydemand ratio (D).As a result, the instances are diverse in terms of the number of demand units, the number of facilities, the facility locations, the supply-demand ratio and the average number of units served by one facility.

Table 1.Supply-demand ratios of 12 sets of instances   

<html><body><table><tr><td>Area</td><td>No. units</td><td>Demand</td><td>No. facilities</td><td>Set A</td><td>Set B</td><td>Set C</td><td>Set D</td></tr><tr><td>ZY</td><td>324</td><td>3873</td><td>13-17</td><td>1.15</td><td>1.15</td><td>1.03</td><td>1.03</td></tr><tr><td>GY</td><td>297</td><td>36,824</td><td>37-41</td><td>1.15</td><td>1.15</td><td>1.03</td><td>1.03</td></tr><tr><td>GY2</td><td>1276</td><td>819,812</td><td>18-22</td><td>1.15</td><td>1.15</td><td>1.03</td><td>1.03</td></tr></table></body></html>

The proposed algorithm was implemented by using the Python programming language.The Python script were run in $\mathsf { P y P y 6 . 0 }$ ,a fast and compliant implementation of the Python language (see http://pypy.org). Each instance was repeatedly solved for ten times. Since random mechanism was used in initial solution generation, local search and perturbation,different solutions will be obtained by repeatedly executing the algorithm. To verify the optimality of the solutions, the instances were also solved by the MILP model formulated in Section 2.The algorithm ran on a desktop computer with Intel Core I7-6700 CPU 3.40-GHz, 8-GB RAM and the Windows 10 operating system.

In the experiment,algorithm parameters are shown in Table 2.The coefficient $\alpha$ in objective function (1) was set to 1Oooo.It is large enough to penalize the service overload in some service areas.To analyze the sensitivity of the parameter settings,the instances were also solved by changing one of the parameters.The TP model and SPP model were solved by the IBM ILOG CPLEX Optimizer 12.6.3.Additionally, two parameters were set for the CPLEX optimizer for solving for the SAP model: $M I P G a p { = } 1 0 ^ { - 1 0 }$ and Timelimit $\scriptstyle \mathtt { \mathtt { = } 7 2 0 0 }$ （204号 (seconds). Note that we solve the SAP model in two stages: (1) solve a transportation problem (Section 3.2) and repair the fragmented solution; and (2) solve the SAP model with the repaired solution as an initial solution.

Table2.Parameters for the hybrid algorithm   

<html><body><table><tr><td>Area</td><td>ZY</td><td>GY</td><td>GY2</td></tr><tr><td>Population size</td><td>10</td><td>10</td><td>10</td></tr><tr><td>Minimum dissimilarity between any two solutions</td><td>5%</td><td>5%</td><td>5%</td></tr><tr><td>Perturbation strength</td><td>5%</td><td>5%</td><td>5%</td></tr><tr><td>Maximum number of consecutive loops that the best solution is not updated</td><td>500</td><td>500</td><td>200</td></tr><tr><td>Time limit for set partitioning</td><td>50s</td><td>50s</td><td>100s</td></tr></table></body></html>

# 4.2 Solution results

The solutions for 6O instances are shown in Table 3.The instance name in the table consists of the area name,the number of facilities and the type offacility configurations. For each instance,the lower bound, upper bound,and computation time obtained from the CPLEX optimizer are shown in columns $L B , U B ,$ and Time.The upper bounds labeled with asterisk are optimal objectives.For each instance,there are 1O solutions obtained from the hybrid algorithm.The best, average and worst objective gaps are shown in columns $G a p _ { m i n } ,$ $G a p _ { a v g }$ and $G a p _ { m a x }$ respectively. The gaps are calculated by the formula $( o b j - L B ) / L B ^ { * } 1 0 0 \%$ .Column Dev shows the standard devotion of the objective values. Column Time indicates the average computation time in seconds. Note that all the solutions are feasible in terms of capacity constraint and contiguity constraint.

Table 3.Solution results from 6O instances   

<html><body><table><tr><td rowspan="2">Inst.</td><td rowspan="2">Instance</td><td colspan="3">CPLEX</td><td colspan="5">Hybridalgorithm</td></tr><tr><td>LB</td><td>UB</td><td>Time/s</td><td>Gapmin</td><td>Gapavg</td><td>Gapmax</td><td>Dev</td><td>Time/s</td></tr><tr><td>ZYA</td><td>zy_13a</td><td>2582.40</td><td>2582.40*</td><td>353.69</td><td>0.01%</td><td>0.16%</td><td>0.26%</td><td>0.08%</td><td>56.16</td></tr><tr><td></td><td>zy_14a</td><td>2320.96</td><td>2320.96*</td><td>105.89</td><td>0.00%</td><td>0.04%</td><td>0.18%</td><td>0.06%</td><td>48.44</td></tr><tr><td></td><td>zy_15a</td><td>2125.35</td><td>2125.35*</td><td>133.53</td><td>0.00%</td><td>0.12%</td><td>0.23%</td><td>0.09%</td><td>45.94</td></tr><tr><td></td><td>zy_16a</td><td>1995.61</td><td>1995.61*</td><td>54.44</td><td>0.04%</td><td>0.11%</td><td>0.17%</td><td>0.04%</td><td>41.73</td></tr><tr><td></td><td>zy_17a</td><td>1972.27</td><td>1972.27*</td><td>312.98</td><td>0.01%</td><td>0.07%</td><td>0.13%</td><td>0.04%</td><td>56.33</td></tr><tr><td>GYA</td><td>gy_37a</td><td>70172.91</td><td>70172.91*</td><td>147.39</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>23.40</td></tr><tr><td></td><td>gy_38a</td><td>70357.88</td><td>70357.88*</td><td>219.98</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>25.10</td></tr><tr><td></td><td>gy_39a</td><td>69942.63</td><td>69942.63 *</td><td>1180.34</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>30.66</td></tr><tr><td></td><td>gy_40a</td><td>70002.58</td><td>70002.58*</td><td>378.72</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>37.10</td></tr><tr><td></td><td>gy_41a</td><td>69486.77</td><td>69486.77*</td><td>166.11</td><td>0.00%</td><td>0.04%</td><td>0.21%</td><td>0.07%</td><td>33.58</td></tr><tr><td>GY2A gy2_18a</td><td></td><td>2151429.06</td><td>2153367.10</td><td>7201.48</td><td>0.18%</td><td>0.20%</td><td>0.23%</td><td>0.02%</td><td>82.50</td></tr><tr><td></td><td>gy2_19a</td><td>2032040.61</td><td>2032040.61*</td><td>263.55</td><td>0.03%</td><td>0.05%</td><td>0.06%</td><td>0.01%</td><td>55.01</td></tr><tr><td></td><td>gy2_20a</td><td>1974506.43</td><td>1974506.43*</td><td>295.04</td><td>0.01%</td><td>0.02%</td><td>0.05%</td><td>0.01%</td><td>56.54</td></tr><tr><td></td><td>gy2_21a</td><td>1931624.28</td><td>1931624.28*</td><td>84.78</td><td>0.00%</td><td>0.02%</td><td>0.03%</td><td>0.01%</td><td>39.18</td></tr><tr><td></td><td>gy2_22a</td><td>1875355.92</td><td>1875355.92*</td><td>47.84</td><td>0.00%</td><td>0.01%</td><td>0.01%</td><td>0.00%</td><td>31.94</td></tr><tr><td>ZYB</td><td>zy_13b</td><td>1811.21</td><td>1811.21*</td><td>107.56</td><td>0.02%</td><td>0.08%</td><td>0.15%</td><td>0.05%</td><td>38.04</td></tr><tr><td></td><td>zy_14b</td><td>1731.02</td><td>1731.02*</td><td>152.00</td><td>0.00%</td><td>0.22%</td><td>0.54%</td><td>0.19%</td><td>43.18</td></tr><tr><td></td><td>zy_15b</td><td>1656.53</td><td>1656.53*</td><td>78.72</td><td>0.00%</td><td>0.13%</td><td>0.51%</td><td>0.17%</td><td>27.47</td></tr><tr><td></td><td>zy_16b</td><td>1647.33</td><td>1647.33*</td><td>147.52</td><td>0.00%</td><td>0.01%</td><td>0.04%</td><td>0.02%</td><td>42.52</td></tr><tr><td></td><td>zy_17b</td><td>1618.93</td><td>1618.93*</td><td>153.38</td><td>0.05%</td><td>0.24%</td><td>0.85%</td><td>0.34%</td><td>47.96</td></tr><tr><td>GYB</td><td>gy_37b</td><td>69052.55</td><td>69052.55*</td><td>154.39</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>26.87</td></tr><tr><td></td><td>gy_38b</td><td>68989.99</td><td>68989.99*</td><td>312.53</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>20.32</td></tr><tr><td></td><td>gy_39b</td><td>69047.82</td><td>69047.82*</td><td>162.70</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>25.52</td></tr><tr><td></td><td>gy_40b</td><td>68677.92</td><td>68677.92*</td><td>147.28</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>0.00%</td><td>24.55</td></tr><tr><td></td><td>gy_41b</td><td>68555.13</td><td>68555.13*</td><td>196.78</td><td>0.00%</td><td>0.02%</td><td>0.15%</td><td>0.05%</td><td>28.13</td></tr></table></body></html>

<html><body><table><tr><td></td><td></td><td>GY2B gy2_18b 1953522.29</td><td>1953522.29*</td><td></td><td>222.22 0.00%</td><td>0.01% 0.02%</td><td></td><td>0.01%</td><td>33.28</td></tr><tr><td></td><td></td><td>gy2_19b 1927032.00</td><td>1927032.00*</td><td></td><td>67.030.00%</td><td>0.01% 0.02%</td><td></td><td>0.00%</td><td>32.49</td></tr><tr><td></td><td></td><td>gy2_20b 1904637.49</td><td>1904637.49*</td><td></td><td>74.10 0.00%</td><td>0.00% 0.01%</td><td></td><td>0.00%</td><td>37.30</td></tr><tr><td></td><td>gy2_21b</td><td>1889743.21</td><td>1889743.21*</td><td></td><td>86.73 0.00%</td><td>0.01% 0.02%</td><td></td><td>0.01%</td><td>44.94</td></tr><tr><td>ZYC</td><td>gy2_22b</td><td>1875200.30</td><td>1875200.30*</td><td></td><td>59.46 0.00%</td><td>0.00% 0.01%</td><td></td><td>0.00%</td><td>32.68</td></tr><tr><td></td><td>zy_13c</td><td>2822.23</td><td>2822.23*</td><td>43.70 0.00%</td><td></td><td>0.19% 0.40%</td><td></td><td>0.13%</td><td>60.05</td></tr><tr><td></td><td>zy_14c</td><td>2589.93</td><td>2589.93*</td><td>514.55 0.07%</td><td></td><td>0.25% 0.39%</td><td></td><td>0.13%</td><td>66.04</td></tr><tr><td></td><td>zy_15c</td><td>2405.40</td><td>2405.40*</td><td>399.81 0.14%</td><td></td><td>0.36% 0.69%</td><td></td><td>0.20%</td><td>76.24</td></tr><tr><td></td><td>zy_16c</td><td>2260.01</td><td>2260.01*</td><td>274.39 0.11%</td><td></td><td>0.45% 0.77%</td><td></td><td>0.20%</td><td>51.74</td></tr><tr><td>GYC</td><td>zy_17c</td><td>2250.94</td><td>2250.94*</td><td>575.95 0.13%</td><td></td><td>0.23% 0.35%</td><td></td><td>0.08%</td><td>57.98</td></tr><tr><td></td><td>gy_37c</td><td>79828.37</td><td>79924.28</td><td>7204.52 0.19%</td><td></td><td>0.29% 0.57%</td><td></td><td>0.14%</td><td>51.77</td></tr><tr><td></td><td>gy_38c</td><td>79514.67</td><td>79514.67*</td><td>1112.73 0.00%</td><td></td><td>0.12% 0.69%</td><td></td><td>0.22%</td><td>55.39</td></tr><tr><td></td><td>gy_39c</td><td>78748.95</td><td>78748.95*</td><td>1280.30 0.00%</td><td></td><td>0.16% 1.00%</td><td></td><td>0.32%</td><td>55.31</td></tr><tr><td></td><td>gy_40c</td><td>78402.60</td><td>78402.60*</td><td>1088.69 0.00%</td><td></td><td>0.07% 0.13%</td><td></td><td>0.04%</td><td>53.01</td></tr><tr><td></td><td>gy_41c</td><td>79603.48</td><td>79771.00</td><td>7203.73 0.21%</td><td></td><td>0.34% 0.74%</td><td></td><td>0.16%</td><td>68.47</td></tr><tr><td></td><td>GY2C gy2_18c</td><td>2316782.75</td><td>2317477.99</td><td>7204.80 0.06%</td><td></td><td>0.13% 0.18%</td><td></td><td>0.04%</td><td>105.16</td></tr><tr><td></td><td></td><td>gy2_19c 2141600.45</td><td>2142243.12</td><td>7205.44 0.14%</td><td></td><td>0.18% 0.24%</td><td></td><td>0.03%</td><td>105.21</td></tr><tr><td></td><td>gy2_20c</td><td>2118415.85</td><td>2119263.56</td><td>7205.84 0.08%</td><td></td><td></td><td>0.14% 0.19%</td><td>0.04%</td><td>113.90</td></tr><tr><td></td><td>gy2_21c</td><td>2026852.86</td><td>2026852.86</td><td>7205.17 0.09%</td><td></td><td>0.11% 0.14%</td><td></td><td>0.02%</td><td>89.63</td></tr><tr><td>ZYD</td><td>gy2_22c</td><td>2003751.38</td><td>2003951.77</td><td>7204.17 0.03%</td><td></td><td>0.10% 0.16%</td><td></td><td>0.05%</td><td>98.95</td></tr><tr><td></td><td>zy_13d</td><td>2050.88</td><td>2050.88*</td><td></td><td>77.56 0.02%</td><td>0.04% 0.08%</td><td></td><td>0.02%</td><td>55.50</td></tr><tr><td></td><td>zy_14d</td><td>1927.72</td><td>1927.72*</td><td></td><td>202.80 0.11%</td><td></td><td>0.33% 0.84%</td><td>0.27%</td><td>52.55</td></tr><tr><td></td><td>zy_15d</td><td>1874.58</td><td>1874.58*</td><td></td><td>104.13 0.10%</td><td></td><td>0.27% 0.52%</td><td>0.14%</td><td>60.89</td></tr><tr><td></td><td>zy_16d</td><td>1840.85</td><td>1840.85*</td><td></td><td>787.34 0.26%</td><td>0.65% 1.00%</td><td></td><td>0.26%</td><td>45.89</td></tr><tr><td></td><td>zy_17d</td><td>1841.48</td><td>1841.48*</td><td>3965.80 0.73%</td><td></td><td>0.82% 0.99%</td><td></td><td>0.08%</td><td>56.36</td></tr><tr><td>GYD</td><td>gy_37d</td><td>76744.96</td><td>76744.96*</td><td>1090.050.00%</td><td></td><td>0.00% 0.00%</td><td></td><td>0.00%</td><td>52.91</td></tr><tr><td></td><td>gy_38d</td><td>77792.10</td><td>77792.10*</td><td>2035.78 0.00%</td><td></td><td></td><td>0.02% 0.07%</td><td>0.03%</td><td>49.18</td></tr><tr><td></td><td>gy_39d</td><td>78960.76</td><td>79150.72</td><td>7206.91 0.24%</td><td></td><td></td><td>0.39% 0.67%</td><td>0.16%</td><td>55.73</td></tr><tr><td></td><td>gy_40d</td><td>78321.25</td><td>78572.69</td><td>7205.88 0.32%</td><td></td><td></td><td>0.47% 0.60%</td><td>0.09%</td><td>57.29</td></tr><tr><td></td><td>gy_41d</td><td>80428.82</td><td>80533.51</td><td>7205.42 0.15%</td><td></td><td>0.30% 0.49%</td><td></td><td>0.10%</td><td>52.80</td></tr><tr><td>GY2D gy2_18d 2016743.88</td><td></td><td></td><td>2016743.88*</td><td>6941.550.10%</td><td></td><td></td><td>0.13% 0.18%</td><td>0.04%</td><td>67.05</td></tr><tr><td></td><td></td><td>gy2_19d 1986365.28</td><td>1986365.28*</td><td></td><td>929.58 0.06%</td><td></td><td>0.09% 0.13%</td><td>0.02%</td><td>55.23</td></tr><tr><td></td><td></td><td>gy2_20d 2026789.24</td><td>2026991.94</td><td></td><td>7205.20 0.06%</td><td></td><td>0.19% 0.37%</td><td>0.08%</td><td>105.73</td></tr><tr><td></td><td></td><td>gy2_21d 2016126.53</td><td></td><td></td><td>7208.63 0.15%</td><td></td><td>0.17% 0.21%</td><td>0.03%</td><td>104.84</td></tr><tr><td></td><td></td><td></td><td>2016529.84</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>gy2_22d 2028023.26</td><td>2028631.85</td><td>7207.47 0.11%</td><td></td><td></td><td>0.13% 0.14%</td><td>0.01%</td><td>71.51</td></tr></table></body></html>

Table 3 shows that all the SAP instances can be solved optimally or near-optimally by CPLEX optimizer. Among the model solutions, 46 are optimal and 14 are near-optimal with MIPGap between $0 . 0 0 \%$ and $0 . 3 2 \%$ . Deferent from the early reports that only very small districting instances could be exactly solved,some larger instances for the SAP could be solved in our experiment.This should be attributed to the progress in MILP solver and CPU speed,but also the soft-constrained model formulations. It is also found that the instance complexity depends on both the instance size and the supply-demand ratio.The instances with high supply-demand ratio (instance sets A and B) would be solved more efficiently than those with low supply-demand ratio (instance sets C and D).

The results in Table 3 also show that the proposed hybrid algorithm is effective and efficient. First, the solutions from the hybrid algorithm approximate to the optimal solutions or the lower bounds with an average gap of $0 . 1 5 \%$ and ranging from $0 . 0 0 \%$ to $0 . 8 2 \%$ . Among the best solutions in column $G a p _ { m i n } , 2 8 ( 4 6 . 7 \% )$ are optimal. Table 4 summarizes the number of optimal solution found by CPLEX and the hybrid algorithm. Second, the objective deviations are small, ranging from $0 . 0 0 \%$ to $0 . 3 8 \%$ . Third, all the instances were solved by the hybrid algorithm in a reasonable computation time: averages of 51.55,41.35 and 68.15 seconds for areas ZY, GY and GY2, respectively.

Table 4.Number of optimal solutions found by CPLEX and the hybrid algorithm   

<html><body><table><tr><td rowspan="2">Instance set</td><td colspan="4">CPLEX</td><td colspan="4">Hybrid algorithm</td></tr><tr><td>A</td><td>B</td><td>C</td><td>D</td><td>A</td><td>B</td><td>C</td><td>D</td></tr><tr><td>ZY</td><td>5</td><td>5</td><td>5</td><td>5</td><td>2</td><td>3</td><td>1</td><td>0</td></tr><tr><td>GY</td><td>5</td><td>5</td><td>3</td><td>2</td><td>5</td><td>5</td><td>3</td><td>2</td></tr><tr><td>GY2</td><td>4</td><td>5</td><td>0</td><td>2</td><td>2</td><td>5</td><td>0</td><td>0</td></tr></table></body></html>

Set partitioning in the hybrid algorithm is capable of improving the ILS solutions.The average improvement on all instances is $0 . 1 2 \%$ .Table 5 illustrates the improvements for each set of instances.For area GY,the instances of type Cand D are significantly improved by set partitioning: $0 . 6 0 \%$ and $0 . 4 3 \%$ , respectively. Occasionally, the ILS heuristic may be difficult to find a feasible solution; however,the set partitioning procedure could select a feasible solutions with high quality. The computation times for solving SP models are shown in Table 6. The SP models for SAP instances could be solved very efficiently. Generaly,the SAP solutions could be improved by set partitioning in a short computation time.

Table 5.Solution improvement by set partitioning   

<html><body><table><tr><td>Instance set</td><td>A</td><td>B</td><td>C</td><td>D</td></tr><tr><td>ZY</td><td>0.04%</td><td>0.07%</td><td>0.07%</td><td>0.08%</td></tr><tr><td>GY</td><td>0.06%</td><td>0.04%</td><td>0.60%</td><td>0.43%</td></tr><tr><td>GY2</td><td>0.04%</td><td>0.00%</td><td>0.01%</td><td>0.04%</td></tr></table></body></html>

Table 6. Computation time in seconds for set partitioning   

<html><body><table><tr><td>Instance set</td><td>A</td><td>B</td><td>C</td><td>D</td></tr><tr><td>ZY</td><td>1.53</td><td>1.06</td><td>3.33</td><td>2.60</td></tr><tr><td>GY</td><td>0.29</td><td>0.23</td><td>0.93</td><td>1.12</td></tr><tr><td>GY2</td><td>1.00</td><td>0.53</td><td>3.39</td><td>4.96</td></tr></table></body></html>

# 4.3 Analysis of algorithm parameters

To evaluate the sensitivity of the parameter settings,all the instances were solved by the proposed algorithm using 9 additional sets of parameters.The solution gaps are summarized in Table 7. Column Default shows the solution gaps from the algorithm with parameters listed in Table 2. Other columns shows the solution gaps from the algorithm by settingdifferent parameters:

P1: default parameters, but set population size to $1 ( p s i z e { = } 1 )$   
P5: default parameters, but set population size to 5 $\scriptstyle ( p s i z e = 5 )$   
P20: default parameters,but set population size to 2 $\scriptstyle { \underline { { ? } } } 0 \ ( p s i z e = 2 0 )$ ：   
R10: default parameters,but set perturbation strength to $10 \%$ (strengti $h { = } 1 0 \%$ ） R15: default parameters,but set perturbation strength to $1 5 \%$ (strengt $h { = } 1 5 \%$ ） OP1: default parameters, but use one-unit shift search operator only;   
OP2: default parameters, but use two-unit shift search operator only;   
LS: default parameters, but use simple local search in ILS loops;   
RG: default parameters,but use region growth method to generate initial solutions.

Table 7.Solution gaps (%) from the Hybrid algorithm using different sets of parameters   

<html><body><table><tr><td>Inst. set</td><td>Default</td><td>P1</td><td>P5</td><td>P20</td><td>R10</td><td>R15</td><td>OP1</td><td>OP2</td><td>LS</td><td>RG</td></tr><tr><td>ZYA</td><td>0.10</td><td>0.25</td><td>0.15</td><td>0.21</td><td>0.16</td><td>0.23</td><td>0.77</td><td>0.22</td><td>0.29</td><td>0.16</td></tr><tr><td>GYA</td><td>0.01</td><td>0.02</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.02</td><td>0.14</td><td>0.00</td><td>0.00</td><td>0.00</td></tr><tr><td>GY2A</td><td>0.06</td><td>0.09</td><td>0.07</td><td>0.05</td><td>0.05</td><td>0.06</td><td>0.16</td><td>0.09</td><td>0.05</td><td>0.22</td></tr><tr><td>ZYB</td><td>0.14</td><td>0.20</td><td>0.22</td><td>0.14</td><td>0.08</td><td>0.04</td><td>0.97</td><td>0.04</td><td>0.46</td><td>0.13</td></tr><tr><td>GYB</td><td>0.00</td><td>0.01</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.02</td><td>0.00</td><td>0.00</td><td>0.00</td></tr><tr><td>GY2B</td><td>0.01</td><td>0.10</td><td>0.01</td><td>0.00</td><td>0.01</td><td>0.01</td><td>0.03</td><td>0.01</td><td>0.01</td><td>0.11</td></tr><tr><td>ZYC</td><td>0.30</td><td>0.42</td><td>0.40</td><td>0.32</td><td>0.26</td><td>0.38</td><td>1.33</td><td>0.47</td><td>0.64</td><td>0.51</td></tr><tr><td>GYC</td><td>0.20</td><td>0.38</td><td>0.09</td><td>0.07</td><td>0.28</td><td>0.11</td><td>2.37</td><td>0.10</td><td>0.39</td><td>0.08</td></tr><tr><td>GY2C</td><td>0.13</td><td>0.34</td><td>0.30</td><td>0.14</td><td>0.17</td><td>0.16</td><td>0.53</td><td>0.33</td><td>0.18</td><td>0.77</td></tr><tr><td>ZYD</td><td>0.42</td><td>0.95</td><td>0.41</td><td>0.67</td><td>0.33</td><td>0.45</td><td>2.63</td><td>0.40</td><td>0.99</td><td>0.42</td></tr><tr><td>GYD</td><td>0.24</td><td>0.26</td><td>0.04</td><td>0.10</td><td>0.07</td><td>0.08</td><td>0.82</td><td>0.14</td><td>0.37</td><td>0.09</td></tr><tr><td>GY2D</td><td>0.14</td><td>0.22</td><td>0.17</td><td>0.14</td><td>0.17</td><td>0.16</td><td>0.64</td><td>0.34</td><td>0.19</td><td>0.66</td></tr><tr><td>Average</td><td>0.15</td><td>0.27</td><td>0.15</td><td>0.15</td><td>0.13</td><td>0.14</td><td>0.86</td><td>0.18</td><td>0.30</td><td>0.25</td></tr></table></body></html>

There are several findings from the solution results in Table 7. First, solution gaps in columns Default, OP1 and OP2 show that the two-unit shift search operator is more effective than the one-unit shift; and the combination of one-unit shift and two-unit shift operators is slightly better than the two-unit shift operator.The one-unit shift is a fast local search operator,while the two-unit shift is slower but more effective.For designing the local search procedure in ILS,an issue is that whether it is best to have a fast operator or an effective one.The experimentation suggest that the best choice is to use both of the one-unit shift and two-unit shift in ILS search.

Second, solution gaps in columns Default,P1, P5 and P2O indicate that the population-based search ( $P s i z e = 5$ ,10 or 2O)is better than the single-solution-based search $( P s i z e = 1 )$ .Maintaining a population of elite and diverse solutions,local search in ILS could explore much larger neighborhood space,and thus have more possbility to find better solutions.It is observed that the population-based ILS performs better than the single-solution-based ILS,and the population size is not sensitive to solution quality.

Third,other parameters have some effects on the performance of the proposed algorithm,but are not very sensitive to the solution quality.The perturbation strength is a key parameter to balance the intensification and diversification of ILS search.In our algorithm, the perturbation strength between $5 \% \sim 1 5 \%$ is appropriate for solving most instances.For ILS local search, both the simple local search and VND search could guide the algorithm to find good solutions.Since the VND search is capable to reach local optimum in solution space, the ILS with VND search might be better than the ILS with simple local search.The final solutions for the SAP slightly depend on the initial solution method.For most instances,the procedure of solving a TP model and repairing the model solution is the best mothed to generate initial solutions.

# 5 Conclusion

A new hybrid algorithm was proposed to solve the contiguity-constrained capacitated facility SAP.To the best of the authors' knowledge,it is the first time to introduce a population-based ILS with VND search and set partitioning for delineating service areas. The performance of the proposed method was intensively tested on 6O well-designed instances. Experimentation shows that the algorithm is capable of finding high-quality near-optimal solutions in a reasonable computation time.

The proposed hybrid algorithm is different from existing algorithms in some aspects. The perturbation in ILS algorithm plays an important role in escaping from local optima and an appropriate perturbation strength could guide the ILS search approaching the global optimum.The algorithm was designed based on the standard ILS algorithm,and further enhanced by three schemes: VND search, population-based ILS,and set partitioning. VND search in ILS could extensively explore the neighborhood space of the incumbent solution,and thus increases the convergence speed of ILS.The populationbased ILS maintains a set of solutions.Starting from the elite and diverse solutions, the perturbation and local search in ILS have a higher possibility of finding better solutions. Additionally, the service areas explored by the local search are reused for selecting a better solution by set partitioning.In traditional set-partitioning-based heuristics, even if different techniques are suggested to generate a large number of service areas, it is still difficult to identify the promising candidates for large problem instances.In local-searchbased or population-based heuristics,a large number of solutions are discovered; however, most of them are abandoned. Historical solutions in metaheuristics should be the high-quality candidates for the set-partitioning-based approaches.In our algorithm,all the service areas identified in each iteration were recorded and finally reselected by a SPP model.

Twelve sets of benchmark instances with different sizes and complexity for SAP were introduces based on three geographic areas.The instances are diverse in terms of the number of demand units, the number of facilities, the facility locations, the supplydemand ratio and the average number of units served by one facility.The optimal or near optimal solutions for the instances were obtained from CPLEX optimizer.The instances and all the solution results shown in this article can be downloaded from https://github.com/yfkong.The authors believe that the benchmark instances are valuable to evaluate existing and newly proposed algorithms for the SAP.

Finally, some general issues regarding the hybrid algorithm should be investigated in further studies.The parameter settings and the adaptive adjustment of the parameters for the algorithm remain as open issues. Both the theoretical and practical analysis on this topic may inform the algorithm to solve a specific instance more eficiently. Considering that districting problems have some common criteria,it could be possible to extend the algorithm to solve other problems such as the political districting problem and locationdistricting problems.

# References

Bacao,F., Lobo,V.,and Painho,M., 20o5. Applying genetic algorithms to zone design. Soft Computing, 9(5),341-348.   
Bergey, P. K., Ragsdale, C.T.,and Hoskote, M., 2O03.A Simulated Annealing Genetic Algorithm for the Electrical Power Districting Problem.Annals of Operations Research, 121(1), 33-55.   
Butsch, A., Kalcsics,J.,and Laporte, G.,2014. Districting for Arc Routing. Informs Journal on Computing, 26(4),809-824.   
Caro,F.,et al. 2004.School redistricting: embedding GIS tools with integer programming. Journal of the Operational Research Society, 55(8), 836-849.   
Chou,C., Chu,Y.,and Li, S., 2O07. Evolutionary Strategy for Political Districting Problem Using Genetic Algorithm. Lecture Notes in Computer Science, 4490(4),1163-1166.   
Chou,C., 2011.A Knowledge-based Evolution Algorithm approach to political districting problem.Computer Physics Communications,182(1),209-212.   
Daskin,M.S.,2011. Service science, Hoboken: John Wiley & Sons, 183-283.   
Datta,D.,et al., 2O08. Graph partitioning through a multi-objective evolutionary algorithm: a preliminary study. Proceedings of the 1Oth annual conference on Genetic and evolutionary computation,12-16 July 2008,Atlanta, 625-632.   
Duque,J. C., Church, R.L., Middleton, R.S.,2011. The p-regions problem. Geographical Analysis,43 (1), 104-126.   
Emiliano, W.M.,Telhada,J.,and Carvalho,M. D.,2017. Home health care logistics planning: a review and framework. Procedia Manufacturing,13, 948-955.   
Ferland,J. A.,and Guenette, G.,1990. Decision Support System for the School Districting Problem. Operations Research,38(1),15-21.   
Forman, S. L.and Yue,Y., 2O03. Congressional districting using a TSP-based genetic algorithm. Lecture Notes on Computer Science,2724, 2072-2083.   
Franklin,A. D.and Koenigsberg,E.,1973. Computed School Assignments in a Large District. Operations Research, 21(2),413-426.   
Garfinkel, R.S.and Nemhauser, G.L.,1970. Optimal Political Districting by Implicit Enumeration Techniques. Management Science,16(8), 495-508.   
George,J. A., Lamar, B.W.,and Wallace, C. A., 1997. Political district determination using large-scale network optimization.Socioeconomic Planning Science,31(1),11-28.   
Hess,S. W.,et al., 1965. Nonpartisan political redistricting by computer. Operations Research,13 (6),998-1006.   
Hojati,M., 1996.Optimal political districting. Computers & Operations Research,23(12), 1147-1161.   
Horn,M.E.T.,1995.Solution Techniques for Large Regional Partitioning Problems. Geographical Analysis,1995,27: 230-248.   
Hu, F., Yang, S., and Xu, W., 2014. A non-dominated sorting genetic algorithm for the location and districting planning of earthquake shelters. International Journal of Geographical Information Science,28(7), 1482-1501.   
Hu, Y.,Wang,F.,and Xierali, I., 2018. Automated Delineation of Hospital Service Areas and Hospital Referral Regions by Modularity Optimization. Health Services Research,53(1), 236-255.   
Jacobs, D.A., Silan, M. N.,and Clemson, B.,1996.An Analysis of Alternative Locations and Service Areas of American Red Cross Blood Facilities. Interfaces,26(3), 40-50.   
Kalcsics,J., Nickel, S.and Schroder,M., 2O05.Towards a unified territorial design approach: applications,algorithms and GIS integration. Top,13(1),1-56.   
Koenigsberg,E.,1968.Mathematical analysis applied to school attendance areas.Socioeconomic Planning Sciences, 1(4): 465-475.   
Kong,Y., Zhu, Y.,and Wang, Y., 2O17.A hybrid metaheuristic algorithm for the school districting problem. Acta Geographica Sinica, 2017,72(2): 256-268. (in Chinese)   
Kong,Y., Zhu, Y.,and Wang, Y.,2019. A center-based modeling approach to solve the districting problem,International Journal of Geographical Information Science,33(2), 368-384.   
Li, X., et al.,2008.A Decentralized and Continuity-Based Algorithm for Delineating Capacitated Shelters'Service Areas. Environment and Planning B: Planning and Design, 35(4),593-608.   
Li, Z.,Wang, R.and Wang, Y., 2007. A quadratic programming model for political districting problem.In: X.Zhang, L. Chen,L.Wu, et al.,eds.The First International Symposium on Optimization and Systems Biology (OSB'07), 8-10 August 2007 Beijing. Beijing: World Publishing Corporation, 427-435.   
Liberatore, F.,and Camachocollados, M., 2016. A Comparison of Local Search Methods for the Multicriteria Police Districting Problem on Graph.Mathematical Problems in Engineering, Article ID 3690474,13 pages，   
Liu, Y., Cho,W. K., and Wang,S., 2016. PEAR: a massively parallel evolutionary computation approach for political redistricting optimization and analysis.Swarm and evolutionary computation, 30, 78-92.   
Lodi,A.,2017.On Mixed-integer programming and its connection with data science [online]. EPFL. Available from: http://transp-or.epfl.ch/zinal/lectures2017.php [Accessed 5 April 2018].   
Lourenco,H.R., Martin, O.and Stützle,T., 2010. Iterated Local Search: Framework and Applications.In: Gendreau, M.and Potvin, J.Y.,eds. Handbook of Metaheuristics, 2nd. Edition. International Series in Operations Research & Management Science,Vol 146. New York: Springer, 363-397.   
Mehrotra,A., Johnson, E.L.,and Nemhauser, G.L., 1998.An Optimization Based Heuristic for Political Districting. Management Science,44(8), 1100-1114.   
Nemoto, T.and Hotta, K., 2003. Modeling and solution of the problem of optimal electoral districting. Communications of Operations Research of Japan,48(4),300-306 (in Japanese).   
Nygreen, B.,1988. European assembly constituencies for Wales一comparing of methods for solving a political districting problem.Mathematical Programming,42(1),159-169.   
Pezzella,F.,Bonanno, R.,and Nicoleti, B.,1981.A system approach to the optimal healthcare districting. European Journal of Operational Research,8(2), 139-146.   
Plane,D.A.,Tong, D.and Lei T.,2O19. Inter-person Separation: A New Objective Standard for Evaluating the Spatial Fairness of Political Redistricting Plans. Geographical Analysis, 51, 251-279   
Ricca,F.and Simeone, B.,2Oo8.Local search algorithms for political districting. European Journal of Operational Research,189(3),1409-1426.   
Rincón-Garcia E.A., et al., 2015. ABC,A Viable Algorithm for the Political Districting Problem. In: Gil-Aluja J.,et al.eds.Scientific Methods for the Treatment of Uncertainty in Social Sciences.Advances in Intelligent Systems and Computing,377.Cham: Springer.   
Rios-Mercado, R. Z.,and Fernandez, E., 2009. A reactive GRASP for a commercial territory design problem with multiple balancing requirements. Computers & Operations Research,36(3),755-776.   
Salazar-Aguilar, M.A., Rios-Mercado, R. Z.and Gonzalez-Verlarde,J. L., 2011.A biobjective programming model for designing compact and balanced territories in commercial districting.Transportation Research Part C: Emerging Technologies,19(5), 885-895.   
Salazar-Aguilar,M.A., et al., 2O12.Multiobjective Scatter Search for a Commercial Territory Design Problem.Annals of Operations Research,199(1),343-360.   
Schoepfle, O. B.and Church, R.L.,1991.A new network representation of a "classic" school districting problem.Socio-economic Planning Sciences,25(3),189-197   
Shirabe, T.,20o5.A model of contiguity for spatial unit allocation. Geographical Analysis, 37(1), 2-16.   
Sridharan, R.,1993.A Lagrangian heuristic for the capacitated plant location problem with single source constraints. European Journal of Operational Research,66:305-312   
Tavarespereira,F.,et al.,2O07.Multiple criteria districting problems.Annals of Operations Research, 154(1), 69-92.   
Xiao,N., 2008.A Unified Conceptual Framework for Geographical Optimization Using Evolutionary Algorithms.Annals of the Association of American Geographers, 98(4), 795-817.   
Yanik, S., Surer,O.,and Oztaysi, B., 2O16. Designing sustainable energy regions using genetic algorithms and location-allocation approach. Energy, 97,161-172.

Corresponding author: Yunfeng Kong, yfkong@henu.edu.cn

Foundation Support: The National Natural Science Foundation of China, No. 41871307.