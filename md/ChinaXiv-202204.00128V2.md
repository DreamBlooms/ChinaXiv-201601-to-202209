# Dynamic Prediction of Abnormal Condition for Multiple Fused Magnesium Melting Processes Based on Video Continual Learning

Zhang Zhe

Abstract—Process industryis thepilarindustryofnationaleconomyparticularlytheprocessofproducingmagnesiabyfused magnesiafurnacesystemisatypicalcategoryofprocessindustryDuetotecomplexsmeltingmechanismandchangingproduction factors,abnoralworkingconditionsofteoccurinfusedmagnesiafurace.Tesemi-moltenconditionisteostypicaladrful abnormalcondition.Inthispperndaptiepretraininginferencedyamictraining-validationemanticsgmentationmetdbad on industrial videois proposedfordynamic prediction of semi-molten conditionof multiplefused magnesium furnaces.The experimentalresultsshowthatcomparedwiththeprediction model withoutadaptivelearning,thepredictionperformanceof the adaptive learning model in this paper for multiple fused magnesium melting processes is significantly improved.

IndexTermsemanticgmentation,VideoContinualearing,bnoralConditionPrediction,MultipleFusedMagnesiafuace

# 1 INTRODUCTION

omy. The process of producing magnesia by fused magnesia furnace system is a typical category of process industry. Due to the complex smelting mechanism and changing production factors, abnormal working conditions often occur in fused magnesia furnace，particularly, the semi-molten condition is the most typical and harmful abnormal condition. If not processed in time,it will lead to molten leakage,low grade magnesia products,and severe safety accidents. In this paper,an adaptive semantic segmentation method based on industrial video is proposed for dynamic prediction of semi-molten condition of multiple fused magnesium furnaces.

This paper first introduces the research background of semi-molten condition prediction of fused magnesium furnaces,and studies the research status of condition recognition and prediction,as long as adaptive deep learning at home and abroad.Based on the video of multi-furnace fused magnesium furnaces, the training dataset is carefully made.In this paper, an end-to-end convolutional neural network based on 3D U-net is designed,and an adaptive pretraining-inference-dynamic training-validation method for predicting the semi-molten condition of multi-furnace fused magnesium furnaces is proposed. The effectiveness of the proposed method is verified via industrial datasets.The main work of this paper isas follows:

In this paper, the mechanism of the production process and semi-molten condition of the fused magnesium furnaces is studied first.We point out the phenomenon of video feature migration between multi-furnace magnesium furnaces,studies the research status of abnormal condition recognition and prediction based on process variables or computer vision,as well as the research status of adaptive deep learning. The specific issues and main work of this paper are also systematically summarized.

Aiming at the problem that it is difficult to quickly and effectively obtain label data for multi-furnace working condition video of fused magnesium furnaces,an improved semi-automatic labeling method for semi-molten condition is proposed.Firstly, the video of the smelting conditions of multiple furnaces of fused magnesium furnace is selected, and the abnormal area of each frame of the video image is coarsely labeled based on the spatio-temporal coordinate transfer method. Further, the spatio-temporal consistency of abnormal area labels is optimized by Weighted Median Filtering and Gaussian Filtering,and the data set of semimolten condition prediction of fused magnesium furnace containingpixel-levellabelsofabnormal areaismade.

In view of the various interference existing in the industrial environment, this paper proposes a 3D U-net convolution neural network to train the prediction model of semi-molten conditions.Aiming at the problem of environmental light fluctuation and the inherent characteristics of the furnace wall, the neural network preprocesses the image sequences of each frame of the video through the time sequence consistency transformation module.

Aiming at the problem of video feature migration in the multi-furnace production process of fused magnesium furnaces, this paper proposes a dynamic prediction method based on adaptive deep learning.Based on the idea of endedge-cloud collaborative learning，the proposed method adaptively updates the cloud database by using the sample balance screening mechanism.The multi-prediction models are adaptively switched through the multi-condition trigger mechanism based on validation accuracy, and the LSTM network is used to estimate the pixel threshold of the semimolten condition prediction model,so as to realize the adaptive learning of the data characteristics of the new furnace videos by the prediction model.

In this paper, the influence of new buffer data amount on the prediction results is studied through experiments, and the effectiveness of the proposed threshold estimation method of semi-molten condition prediction model based on LSTM network for improving the prediction accuracy in the presence of video feature migration is verified.Further, the experimental results show that compared with CRNN model and 2D U-net model,our adaptive dynamic learning model has the highest prediction accuracy and the lowest missing rate,for the prediction task of semi-molten conditions based on open and water mist disturbing datasets collected from multi-furnace fused magnesium furnaces.

# 2 RELATED WORK

# 2.1Abnormal Condition Prediction for Multiple FMFs

With the development of industrial artificial intelligence technologyand industrial Internet technology, in the field of process industry manufacturing,data modeling,condition monitoring,fault diagnosis and control optimization for complex controlled objects based on mechanism analysis and process variable big data driven method have gradually become a research spotlight.

Fused magnesium furnace (FMF) is a typical process industrial major energy consumption equipment. The production system of FMF melts magnesite into fused magne sia by electrothermal reaction. The production factors are complex and changeable,and there are many interference factors.As an important strategic material, fused magnesia has the characteristics of fire resistance,high temperature resistance,corrosion resistance，and oxidation resistance, which is widelyused in industries,aerospace,militaryand other fields.Semi-Molten conditionis the most frequent and serious abnormal phenomenon in the production process of FMF.

When this abnormal condition occurs,the ore cannot be melted in time,carbon dioxide gas produced by frame decomposition of magnesium carbonate will compress the high-temperature molten liquid to burn through the pro tective layer of the furnace wall and directly contact the furnace wall, resulting in the burning through of the furnace wall and the leakage of the molten liquid,which will pose a threat to the safety of the inspection workers and reduce the grade of the fused magnesia. In this paper,an end-to-end adaptive pretraining-inference-dynamic training-validation method is used to extract the characteristics of the video data of the working conditions of the multi-furnace fused magnesium furnaces.

Scholars have studied the diagnosis and prediction of semi-molten condition of fused magnesium furnace.In the aspect of image feature research,paper [1] quantified the five characteristics of the semi-molten condition image, namely the flame area, the average color of the whole image, the average color of the flame area,the total color of the flame brightness area and the flame brightness.The robust random configuration network was used to identify the semi-molten condition.

Based the dynamic video as the main model input, paper [2] proposed the deep convolution to generate new samples from the confrontation network to make up for the shortage of the original sample number. In the training process, the smelting video was first framed,and then the convolution neural network [3] was used in each frame to realize the featureextractionof the furnace flame,the semimolten furnace wall, the Mars outside the furnace and the background area,and then the detection and classification model of the image of the smelting process of the electromelting magnesium furnace was established.However, this method did not design a targeted solution to the problem of environmental light fluctuation interference and high brightness in the smelting site of the magnesium furnace.

Considered the dynamic information of the time and space dimensions of the magnesium furnace smelting video, paper [4] proposed the CRNN semi-molten condition diagnosis method based on the deep learning of the sequential dynamic image. This paper pointed out the difference between the water mist interference and the semi-molten condition on the time axis, introduced the super parameters representing the influence of the moving speed of the flame and the water mist on the image,and processed the gray consistency of the image. The sequential residual image was used as the input of the network to eliminate the environmental light and the inherent white spot of the furnace.CNN network and RNN network were used to extract temporal and spatial characteristics of the sequential image respectively.However, this structure separates the extraction of spatial and temporal features in video sequences, and does not further consider the coupling relationship between time and spatial dimensions.

Paper [5] studied the classification method of semimolten conditions by selecting two process variables of complementary magnesium furnace images and current data. The multivariate image analysis technology was used to replace the human eyes, and the feature extraction of magnesium furnace flame was carried out. The semi-supervised learning framework based on regularization was used for modeling, and the cross-entropy method was used to optimize the classifier objective function. Compared with the traditional optimization method， the training speed was significantly improved.In this paper, the feature fusion problem of current and image is transformed into a semisupervised learning problem，which reduces the workload of labeling image tags compared with the supervised method [4], [5]. During the production and operation of the fused magnesium furnace system,real-time video data will be generated; it takes a lot of time to add labels to each frame of video image,which cannot predict the semimolten condition of magnesium furnace in real-time online. Therefore, through adaptive deep learning methods such as transfer learning [6],relying on a small amount of label or evenunlabeled video information obtained inreal time,it is of important industrial application value and promotion value to predict whether the semi-molten industrial mines of magnesium furnace occur.

In the visible light range that can be collected by the video signal acquisition equipment,it is difficult for the human eye to accurately detect the early semi-molten area withunobviouscharacteristicsinrealtimeunderthe harsh and complex production environment, so as to predict the occurrence of semi-molten condition and give early warning.The goal is to achieve and exceed the effect of direct observation by the human eye.

# 2.2Image Segmentation and Open Set Learning

U-net network [7] is developed from FCN fully convolutional neural network [8]. The jump connection layer transmits high-resolution information directly from the encoding path to the decoding path of the same dimension through data splicing operation,so as to provide more refined features such as gradient for image segmentation. At the same time, the low-resolution information on the coding path after multiple down-sampling is transmitted to the decoding path to provide the semantic information of the segmentation target in the whole image context. The information of relevant dimensions can be visualized by deconvolution [9]. U-net network is commonly used in high dynamic range image reconstruction, end-to-end semantic segmentationandotherfields.

Deep learning has greatly improved the accuracy of image segmentation.Ppaer [1O] successfully used the deep learning method for image segmentation for the first time. In this paper, the full connection network was replaced by a convolution network, and the small feature map was rolled out of a large feature layer by transposition convolution, which can output the segmentation map of the same size as the original image.DeepLab Cavity Convolution [11] expands the receptive field while keeping the amount of computation unchanged, and can grasp more global information of images when the feature map is reduced to the same multiple. PSPNet network [12] is a pyramid scene parsing network. The network proposes a module with hierarchical global priority and contains different scale information between different subregions.The context information and multi-scale fusion improve the segmentation accuracy. Mask R-CNN [13] accomplished target detection and semantic segmentation simultaneously. U-net network [7] retains a large number of feature channels in the expansion path, so that more information flows into the restored segmented image,and overlays the feature maps of the same size on the compression path and the expansion path through jump connections to reduce the image information lost on the compression path.

Transfer learning is an important means to solve the basicproblemofdifficultaccessto labeled datain the field of machine learning.Domain adaptation is a kind of isomorphic transfer learning [6], in which domain is composed of data features and feature distribution,and is the main body of learning，the source domain is a domain with existing knowledge and rich supervisory information, while the target domain is a domain to learn, generally unsupervised or less supervised information.In the study of the prediction of the semi-molten condition of the fused magnesium furnace, the video data information of the magnesium furnace is generated in real time.However, the image of the magnesium furnace working condition obtained by frame by frame has no label,and the prediction network cannot know whether the semi-molten condition occurs.Therefore, it is necessary to label the image automatically by manual labeling or the automatic labeling method of the working condition based on the weighted median filtering [4] or to design the classifier of the semi-molten condition based on the deep neural network [5],which has certain hysteresis in the production prediction.

Unsupervised domain adaptation [14] does not require any label data in the target domain,but requires a large number of target domain data to adapt to the distribution of data, without any semantic information. Semi-supervised domain adaptation requires only a small amount of tag data in the target domain to achieve the performance that exceeds UDA [15]. In practical applications,a small amount of tag data can be obtained in new fields.This method is more suitable for practical applications.

# 2.3Dynamic continuous learning of industrial big data

Dynamic open environment often shows the characteristics of distribution deviation, category increase,attribute change and target diversity [16].Decision problems in dynamic open environment often show dynamic uncertainty [17], which will weaken the robustness of artificial intelligence technology. When deploying artificial intelligence systems in high-risk tasks,we should study how to improve the robustness of the model from the model and data levels [18].In order to cope with the unknown risks in the open environment,westudiesthe featuredistribution deviation of industrial video data caused by the change of production environment.

The essence of semi-molten condition prediction of fused magnesium furnace is image segmentation,which realizes therecognition and prediction of semi-molten area of furnace wall at pixel level. Image segmentation refers to the technology and process of dividing an image into several regions with unique properties and proposing interested objects. From a mathematical point of view, image segmentation is the process of dividing the digital image into disjoint regions.Its essence is to divide each pixel into categories or different independent individuals,and extract a region or afeature of concern to exclude redundant information on the image,which is conducive to reducing the calculation of subsequent operations.

For image processing tasks, the accuracy of deep learning network obtained from zero-start training is not necessarily high. On the basis of the existing training model based on a large number of training data, the model parameters are modified to achieve better results.This is a pretrain-fine tune strategy [19], fine tuning refers to the process of acting the pretrain model on the target task data set and adapting theparameters to the target taskdata set.

In this paper, the adaptive deep learning method for the prediction model of semi-molten condition of fused magnesium furnace is studied.The prediction object of the model can be converted from closed set to open set.Based on the incremental learning idea of focus loss function [20],a prediction model based onhistorical video data is obtained bypretraining. The parameters of convolution layer and full connection layer are modified according to the new video data by fine tuning method,and the new model parameters are constrained by the loss function,so that the adaptive learning model is still effective for the prediction of semimolten condition of historical data,and the generalization ability of the model is improved.

At the same time,according to the accuracy and loss value of the effect of prediction models, the trigger mechanism of the model updating is designed, and the accuracy andloss function of the semi-molten condition of thevalidation set of the incremental training model, the historical model and the pre-training model are compared. The optimal model is determined and saved automatically,and the historical prediction model is replaced,which improves the prediction accuracy of the semi-molten condition of the new buffer of video data.

# 3VIDEO DATASET BASED ON MULTIPLE FUSED MAGNESIA FURNACES

The data set includes the original images and labels of each frameof thevideo.Thedatalabelreflectswhether the semimolten condition,the time of semi-molten condition and the pixel-level region appeared in each furnace video. Only by accurately producing the label, it is possible to train the model with high prediction accuracy. Therefore,before designing the adaptive deep learning network for the semimolten condition of the fused magnesium furnace,the video of the operating condition of the fused magnesium furnace should be analyzed,and the video clips containing the semimolten condition and the normal condition at the same time with the appropriate time length in multiple furnaces should be intercepted produce the data set containing the operating condition image andits pixel-level label.

Among them, the working condition video is the .MTS format file collected by the Sony video acquisition equipment,which needs to be converted into the AVI format file. Afterthat,the labelismadeby Matlab and savedas data file in .MAT or .HDF5 format. The preprocessed images of each frame of the video are used as the network input, and the working condition label made by the weighted median filtering and other methods is used as the expected output of the model. Then,the three-dimensional U-net neural network based on temporal consistency transformation is trained to obtain the semi-molten working condition prediction model.

In this paper, the MAT neural network training data sets are produced based on the production condition video of two furnaces of fused magnesium furnace.This method can be applied to the production of multi-furnace video dataset. Firstly, this paper selects three videos with proportional balance between semi-molten and normal conditions and analyzes the time and spatial distribution of semi-molten.

In terms of the production of semi-molten area labels, we first use the method of spatio-temporal coordinate transfer to mark the semi-molten area coarsely,and then uses the weighted median filtering method to filter the video image sequence to optimize the semi-molten label of the coarse label,and solves the problem that the label of individual labels is abnormally zero due to the small semi-molten area bythe label transfermethod of adjacent frames.

Furthermore,based on the label transfer method,the spatio-temporal consistency label of the semi-molten label is optimized by Gaussian filtering,and the semi-molten area label with smooth edge and high accuracy is produced. The more accurate the semi-molten area label is,the more accurate the position of the semi-molten area predicted by the model is. The training of semi-molten prediction model in this paper provides a reliable data set.

# 4 ADAPTIVE DYNAMIC PREDICTION METHOD FOR ABNORMAL CONDITIONS

The smelting system of fused magnesium furnace is a complex practical industrial production system.At present, some scholars have selected process variables such as the working condition image of magnesium furnace [2], [4], [5], [21],graphite electrode current,current fluctuation rate [22], average gray variance of melting zone,and liquid level rise rate of molten pool [23] to study the working condition of magnesium furnace.Among them，graphite electrode current fluctuates frequently with the change of ore particle shape,composition and voltage，which has strong timevarying characteristics and is difficult to be inferred stably and accurately for a long time. Variables such as the rising speed of molten pool page are dificult to obtain,and the data amount is insufficient [24]. There are challenges in establishing coupling relationship between electrode current and image of magnesium furnace in time and space dimensions.

In order to enhance the generalization ability of semimolten condition prediction model, this paper adopts the idea of incremental learning. Incremental learning does not need to save a large number of historical video data,which can reduce the occupation of storage space.However, it can make full use of the training results based on historical data, which can significantly reduce the follow-up training time.

In this paper，the strategy of pretraining-dynamic learning-dynamic inference-model validation is adopted. With the continuous updating of video data, the adaptive learning of all convolution layers and all connection layers in the three-dimensionalU-net network is realized. The adaptive updating strategy of training data based on the sample balance screening mechanism is proposed, and the adaptive correction strategy of multi-prediction model based on the trigger mechanism is designed.Furthermore, the threshold estimation method of semi-molten condition prediction model based on long-term and short-term memorynetwork is proposed to realize the adaptive deep learning of semi-molten condition prediction model of multifurnace magnesium furnace.Combined with the parameters of magnesium furnace video sequence introduced in this paper, the model training objective function is as follows :

$$
\begin{array} { r l } & { L ( Y _ { k } , \hat { Y } _ { m _ { k } } ) = - [ \alpha \cdot Y _ { k } ( 1 - \hat { Y } _ { m _ { k } } ) ^ { \gamma } \log ( \hat { Y } _ { m _ { k } } ) } \\ & { \qquad + ( 1 - \alpha ) \cdot ( 1 - Y _ { k } ) ( \hat { Y } _ { m _ { k } } ) ^ { \gamma } \log ( 1 - \hat { Y } _ { m _ { k } } ) ] . } \end{array}
$$

As for adaptive correction of the model,a validation set updating method based on fixed buffer updating is proposed,that is,after each new buffer data set is added, a validation set updating mechanism is triggered,and a fixed number of tuples are selected from the first tuple of the training set along the time dimension,which is called a fixed buffer updating validation set. The Adaptive Correction Strategy for Multiple Forecasting Models Based on Triggering Mechanism is shown in the following formula, the indexL represents the value of the loss function:

$$
\begin{array} { r } { M _ { t } = \left\{ \begin{array} { l l } { M ^ { p r e } , L _ { t } ^ { p r e } = \operatorname* { m i n } \{ L _ { t } ^ { p r e } , L _ { t } ^ { h i s } , L _ { t } ^ { t r a i n } \} } \\ { M _ { t } ^ { h i s } , L _ { t } ^ { h i s } = \operatorname* { m i n } \{ L _ { t } ^ { p r e } , L _ { t } ^ { h i s } , L _ { t } ^ { t r a i n } \} } \\ { M _ { t } ^ { t r a i n } , L _ { t } ^ { t r a i n } = \operatorname* { m i n } \{ L _ { t } ^ { p r e } , L _ { t } ^ { h i s } , L _ { t } ^ { t r a i n } \} } \end{array} \right. } \end{array}
$$

However,the validation set determined by this method is too far from the new buffer data in the time dimension, andthe datacharacteristics of the validation set and the new buffer data may be quite different. Therefore，this paper further proposes a buffer-by-buffer dynamic updating method of the validation set.

The specific steps are as follows: After adding a new buffer to the training set. Starting from the last tuple of the training set before the new buffer, the historical data are traced along the time dimension to obtain the equal number of data source groups with semi-molten condition labels and normal condition labels,respectively. The validation set is updated buffer by buffer by splicing and sequence disruption.In this paper, the data of the validation set is enhanced to increase the number of images in the validation set.

# 5 EXPERIMENT AND ANALYSIS

According to experience，it usually takes about 20 to 50 seconds to change from normal condition to semi-molten condition in the operation of fused magnesium furnace. Firstly,based on the idea of pretraining-inference-dynamic training-validation,adaptive learning is carried out for each new buffer of image sequence.After learning, the semimolten condition of the next new buffer is predicted.Based on this idea,30o image-label tuples with new buffer number are selected for experimental validation.The model is evaluated mainly from the actual prediction accuracy of the model and the maximum potential of the model prediction accuracy.

Furthermore, this paper expands the adaptive learning data set and further expands the number of tuples in each buffer. Multiple sets of experiments are carried out when the number of tuples takes different values.The prediction indicators,accuracy,missing rate and error rate of the incremental model and the pre-training model trained in this paper are compared under different conditions such as fixed test threshold,dynamic test threshold and optimal test threshold,respectively,which verifies the effectiveness of the adaptive deep learning method for fused magnesium furnace proposed in this paper.

Threshold based classification is a common classification method.The essence of the proposed test threshold is a binary classification threshold,and its value range is -0.01 to 0.99.When the semi-molten condition prediction model is used to predict the working condition of the new buffer image sequence, this paper compares the pixels of the pixellevel semi-molten region segmentation results corresponding to each frame image sequence predicted by the model (the value range is O.0O to 1.00）with the test threshold.If the pixel value is less than the test threshold, the pixel value is set to O, this paper considers that there is no semi-molten condition at the pixel point,and vice versa.

Overall, the prediction ability of the semi-molten conditionprediction model and the value of the test threshold determine whether the model is reasonable or not. The previous research predicts a large-scale data of the same furnace,assuming that the labels of these data were known, so the optimal threshold of large-scale data of the same furnace was taken as the test threshold.However, the key of this study is to predict the small buffer data of different furnaces in buffers.

Combined with industrial practice,the label of the small buffer data of each buffer is unknown,so the test threshold is also unknown. Therefore,we make reasonable assumptions combined with the actual production process,and puts forward the methods based on data law and LSTM long-term and short-termartificial neural network to predict the test threshold for small and large new buffer data. The experimental results show the effectiveness of the two methods.

In this paper, the adaptive deep learning method for under-burning condition prediction of fused magnesium furnace is studied experimentally. The experimental results show that the proposed method can greatly improve the prediction accuracy of the new furnace video.

Table 1 Prediction results by various models proposed in this paper   

<html><body><table><tr><td>Forecast indicators</td><td colspan="3">Inference threshold estimator Gro_size 60o Gro_size 2400</td></tr><tr><td>ACC_Adaptive</td><td>Data Rule or LSTM</td><td>91.23%</td><td>87.20%</td></tr><tr><td>ACC_Adaptive</td><td>Historical Threshold</td><td>88.67%</td><td>76.64%</td></tr><tr><td>ACC_Pretrain</td><td>Fixed Threshold</td><td>72.11%</td><td>71.24%</td></tr><tr><td>ACC_Adaptive_Upper</td><td>Previous Optimal Thre</td><td>95.44%</td><td>92.67%</td></tr><tr><td>MissR_Adaptive</td><td>Data Rule or LSTM</td><td>0.98%</td><td>7.66%</td></tr><tr><td>MissR_Adaptive</td><td>Historical Threshold</td><td>2.75%</td><td>10.68%</td></tr><tr><td>MissR_Pretrain</td><td>Fixed Threshold</td><td>21.46%</td><td>21.98%</td></tr><tr><td>MissR_Adaptive_Upper</td><td>PreviousOptimalThre</td><td>2.51%</td><td>5.38%</td></tr><tr><td>ErrorR_Adaptive</td><td>DataRuleorLSTM</td><td>7.79%</td><td>5.14%</td></tr><tr><td>ErrorR_Adaptive</td><td>Historical Threshold</td><td>8.58%</td><td>12.68%</td></tr><tr><td>ErrorR_Pretrain</td><td>Fixed Threshold</td><td>6.43%</td><td>6.87%</td></tr><tr><td>ErrorR_Adaptive_Upper</td><td>Previous Optimal Thre</td><td>2.05%</td><td>1.95%</td></tr></table></body></html>

According to Table 1, the dynamic prediction model of abnormal conditions proposed in this paper can improve the prediction ability of semi-molten conditions of new videos with changed data characteristics through adaptive deep learning. Taking 6Oo image sequences-tags with new buffer data,i.e. group size is equal to 6oo,as an example,when the test threshold is fixed (i.e.the optimal test threshold obtained by the pretrain model for all the data of new furnaces ),the accuracy of the pretrain model based on historical furnace video data training for the prediction of semi-molten conditions of new furnaces is $7 2 . 1 1 \ \% ,$ ，the missing rate is $2 1 . 4 6 \mathrm { ~ \% } ,$ and the error rate is $6 . 4 3 \ \%$ ，while the accuracy is improved to $9 1 . 2 3 \%$ by the adaptive deep learning method. The miss rate decreased to $0 . 9 \hat { 8 } \ \%$ and the false reporting rate to $7 . 7 9 \%$ .It should be noted that the error rate and miss ratearenegativelycorrelatedandbotharerelatedto thetest threshold,so these two indicators should be studied as a whole.The experiment results verify the effectiveness of the proposed adaptive deep learning method for semi-molten conditions based on dynamic threshold.

At the same time,it is found that if the new buffer data is small, the adaptive learning time and calculation amount will be doubled. There may also be a phenomenon that the change of data characteristics is small, resulting in that the adaptive learning advantage is not obvious,and this phenomenon deviates from the key content of this paper.

The results of the prediction model and the pre-training model are compared and analyzed when the new buffer data is taken into different values.It is verified that compared with the pre-training model, the adaptive deep learning method in this paper can greatly improve the accuracy of prediction and reduce the missing rate and error rate.

Since the prediction of semi-molten condition is essentiallya two-classification problem, the prediction results are related to the test threshold.Therefore,under the premise of ensuring the accuracy of prediction meets the requirements, this paper proposes two methods to predict the semi-molten ratio of new buffer data based on data law and LSTM respectively,anddetermines the test thresholdbasedon the relationship between the semi-molten ratio and the optimal test threshold.

Table 2 Prediction results of abnormal conditions compared with other models   

<html><body><table><tr><td>Model</td><td>ACC</td><td>MissR</td><td>ErrorR</td></tr><tr><td>CRNN</td><td>72.38%</td><td>21.32%</td><td>6.30%</td></tr><tr><td>U-net</td><td>86.00%</td><td>10.48%</td><td>3.52%</td></tr><tr><td>Proposed</td><td>91.23%</td><td>0.98%</td><td>7.79%</td></tr></table></body></html>

As shown in Table 2, compared with the CRNN prediction model and the 2D U-net prediction model,the adaptive learning prediction model in this paper has the highest predictionaccuracy,which verifies that theadaptive deep learning method in this paper can effectively learn the characteristics of new data. Moreover, the missing rate of the model in this paper is the lowest,which verifies that the adaptive learning method can accurately predict semi-molten conditions,and has good prediction ability for semi-molten conditions with small area,low brightness and difficult to identify by human eyes.In addition, we note that the proposed model may predict some normal conditions as semi-molten conditions. Since the purpose of this study is to predict all semi-molten conditions as far as possible,it is acceptable that the missing rate is too high in a certain range,which may be due to inaccurate labels or the model can find semi-molten characteristics that are difficult to observe by the naked eye. According to the experimental results,compared with the CRNN prediction model and the two-dimensional U-net prediction model, the adaptive deep learning method proposed in this paper has stronger prediction ability.

# 6 CONCLUSION

In this paper, an adaptive deep learning method for multifurnace semi-molten conditions is proposed to solve the problem that the video data characteristics of multi-furnace semi-molten conditions change. The experimental results show that compared with the prediction model without adaptive learning, the prediction accuracy of the adaptive learning model in this paper for the new furnace semimolten conditions is significantly improved,and the prediction missing rate and error rate are significantly reduced. Moreover, the adaptive learning model has high prediction ability for small areas and low brightness semi-molten conditions that are difficult to be found by human eyes.

Firstly, this paper investigates the research background of semi-molten condition prediction of fused magnesium furnace with major energy consumption equipment, and introduces theresearch status of conditionidentificationand prediction at home and abroad as well as the research status of adaptive deep learning.

Secondly,we selects the video data of the multi-furnace semi-molten condition of the fused magnesium furnace. In addition,we implement the acquisition and coordinate calibration of the multi-furnace semi-molten area.The labels are optimized by weighted median filtering and Gaussian filtering,which provides a data set containing pixel-level labels of the semi-molten area for model training.

Furthermore,a three-dimensional U-net convolutional neural network containing temporal consistency transformation module is constructed. Through the incremental learning of other furnace video data by pretraining model and the adaptive updating mechanism of model based on trigger mechanism,an adaptive deep learning method for semi-molten condition of fused magnesium furnace is proposed.Based on this method,experimental research is carried out,and the test threshold of new buffer video data is predicted based on data law and LSTM long-term and short-term memory network.

In this paper, a variety of prediction models are designed and continuously improved. An adaptive deep learning model based on three-dimensional U-net convolutional neuralnetwork and a test threshold prediction method based on mathematical laws and LSTM long-term and shortterm memory network are obtained. In this paper, adaptivemodel and test threshold prediction method are called adaptive prediction method.

Further, the experimental results show that compared with CRNN model and two-dimensional U-net convolution model, the adaptive deep learning model trained in this paper has the highest prediction accuracy and the lowest missing rate.The above experimental results prove the effectiveness of the proposed adaptive deep learning method.

In terms of the future work prospect, this paper proposes the end cloud collaborative reasoning framework corresponding to the adaptive learning method.In the future, the problem of weak supervision training of the model can be solved by the weak supervision domain adaptive method in the case of the real-time acquisition of the working condition data of the fused magnesium furnace without labels.

# ACKNOWLEDGMENTS

This paper is the brief version of Zhang Zhe's graduation dissertation for bachelor degree,which aims to share the research results. This work is completed by Zhang Zhe under the guidance of Professor Chai Tianyou and Associate Professor Wu Gaochang. Zhang Zhe is responsible for the academic integrity of the paper. The intellectual property rights of this dissertation belong to Northeastern University. Due to confidentiality reasons,we did not upload the full text yet.We will improve this work and publish articles in the future. Please contact me by email if you have any questions.

# REFERENCES

[1]Z.Guo,"Design and Development of the DetectionSoftware of Semimolten Condition of FusedMagnesium Furnace Based on RobustStochastic Configuration Networks," Northeastern University, [D], 2017.   
[2]S. LU, K. WANG, Z. WU,P.LI, and Z. GUO,"Online detection of semi-molten of fused magnesium furnace based on deep convolutional neural network," Control And Decision,vol. 34,pp.1537- 1544, 2019.   
[3]G.E. Hinton and R. R. Salakhutdinov, “Reducing the dimensionality of data with neural networks," science,vol.313, no.5786, pp. 504-507,2006.   
[4]G.WU,Q. LIU,t. CHAI,and S.QIN,“Abnormal condition diagnosis through deep learning of image sequences for fused magnesium furnaces,"ACTA AUTOMATICA SINICA,vol. 45, no. 8,pp.1475-1485,2019.   
[5]S.Lu and Y.Wen,"Semi-supervised classification of semi-molten working condition of fused magnesium furnace based on image and current features,"ACTA AUTOMATICA SINICA,vol.47,no.4, pp. 891-902,2021.   
[6] M. Wang_and W. Deng, "Deep visual domain adaptation: A survey," Neurocomputing,vol.312, pp.135-153,2018.   
[7] O.Ronneberger,P.Fischer,and T.Brox,"U-net: Convolutional networks for biomedical image segmentation," in International Conference on Medical image computing and computer-assisted intervention．Springer,2015,pp.234-241.   
[8]J.Long, E." Shelhamer, and T. Darrell, “Fully convolutional networksfor semantic segmentation," in Proceedings of the IEEE conference on computer vision and pattern recognition,2015,pp.3431- 3440.   
[9]T. Lin and S. Maji, "Visualizing and understanding deep texture representations,"inProceedings of theIEEE conference on computer visionand patternrecognition,016,pp.2791-2799.   
[10] J.Long,E. Shelhamer,and T. Darrell, "Fully convolutional networks for semantic segmentation," in Proceedings of the IEEE conference on computer vision and pattern recognition,2015,pp.3431- 3440.   
[11] L.-C.Chen, G. Papandreou, I. Kokkinos,K. Murphy,and A.L. Yuille,"Deeplab: Semantic image segmentation with deep convolutional nets,atrous convolution,and fully connected crfs,"IEEE transactions on pattern analysis and machine intelligence,vol.4O,no.4, pp. 834-848,2017.   
[12] H. Zhao,J. Shi, X. Qi, X. Wang,and J. Jia,“Pyramid scene parsing network,"in Proceedingsof the IEEE conference on computer vision and pattern recognition,2017,pp.2881-2890.   
[13]K.He,G. Gkioxari, P.Dollar,and R.Girshick,"Mask $\scriptstyle \mathbf { r } - \mathbf { c n n } , ^ { \prime \prime }$ in Proceedings of the IEEE international conference on computer vision, 2017, pp.2961-2969.   
[14] M.Long, H. Zhu,J.Wang,and M. I. Jordan,“Unsupervised domain adaptation with residual transfer networks," Adoances in neural information processing systems,vol.29,2016.   
[15] S.Motin, Q. Jones, S. Iranmanesh,and G. Doretto,“Few-shot adversarial domain adaptation,"Aduances in neural information processing systems,vol.30,2017.   
[16] P. Tang, J. Zhu, Y. Yu,and S. Tang,“Artificial intelligence under dynamic uncertainty,"China Sience Foundation,vol.32, no.,. 266-270,2018.   
[17] T.G. Dietterich,"Steps toward robust artificial intelligence,"AI Magazine,vol. 38, no.3, pp.3-24,2017.   
[18] C.Geng, S.-j.Huang,and S.Chen,"Recent advances in open set recognition:A survey,"IEEE transactions on pattern analysis and machine intelligence,vol.43,no.10,pp.3614-3631,2020.   
[19] Z. Zhou, J. Shin,L. Zhang, S. Gurudu,M. Gotway,and J. Liang, "Fine-tuning convolutional neural networks for biomedical image analysis:activelyandincrementally,"inProceedingsofthe IEEE conference on computer visionand pattern recognition,20l7,pp.7340- 7351.   
[20]T.Lin,P. Goyal,R.Girshick,K.He,and P.Dollar,"Focal loss fordense object detection,"inProceedings of the IEEE international conference on computer ision,2017,pp.2980-2988.   
[21]G.WU,"Light Field Processing and Its Application:A Mechanism Analysis and Deep Learning Approach," Northeastern University, [D],2020.   
[22] Z.Wu,Y.Wu,T.Chai,and J. Sun,"Data-driven abnormal condition identification and self-healing control system for fused magnesium furnace,"IEEE Transactions on Industrial Electronics, vol. 62,no.3,pp.1703-1715,2014.   
[23]H.LI,F.WANG,and H.LI,"Abnormal condition identiflcation and self-healing control scheme for the electro-fused magnesia smelting process,"ACTA AUTOMATICA SINICA,vol. 45,no.8, pp. 1475-1485,2019.   
[24] S.LU,P. LI,X. ZHENG,and Z.GUO,"A dynamic flame image segmentation method and its application in video monitoring of fused magnesium furnace process,"ACTA AuTOMATICA SINICA,vol. 40,no.8,pp. 1475-1485,2019.

Zhang Zhe received the BE degrees in College of Information Science and Engineering in Northeastern University, Shenyang,China,in 2021.He is currently pursuing the Ph.D.degree with the Northeastern University， Shenyang, China．His current research interests include computer vision,machine learning theory,and working condition recognition in industrial fields. The people he admired were Zhou Enlai and Hsue-shen Tsien.